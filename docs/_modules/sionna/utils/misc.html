<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sionna.utils.misc &mdash; Sionna 0.19.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/sionna.css?v=5c3194bc" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=6f83b549"></script>
        <script src="../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../../_static/copybutton.js?v=f281be69"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Sionna
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../installation.html#installation-using-pip">Installation using pip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../installation.html#docker-based-installation">Docker-based Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../installation.html#installation-from-source">Installation from source</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/Hello_World.html">“Hello, world!”</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/Discover_Sionna.html">Discover Sionna</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/Discover_Sionna.html#Load-Required-Packages">Load Required Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/Discover_Sionna.html#Sionna-Data-flow-and-Design-Paradigms">Sionna Data-flow and Design Paradigms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/Discover_Sionna.html#A-note-on-random-number-generation">A note on random number generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/Discover_Sionna.html#Let's-Get-Started---The-First-Layers-(Eager-Mode)">Let’s Get Started - The First Layers (<em>Eager Mode</em>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/Discover_Sionna.html#Batches-and-Multi-dimensional-Tensors">Batches and Multi-dimensional Tensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/Discover_Sionna.html#First-Link-level-Simulation">First Link-level Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/Discover_Sionna.html#Setting-up-the-End-to-end-Model">Setting up the End-to-end Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/Discover_Sionna.html#Run-some-Throughput-Tests-(Graph-Mode)">Run some Throughput Tests (Graph Mode)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/Discover_Sionna.html#Bit-Error-Rate-(BER)-Monte-Carlo-Simulations">Bit-Error Rate (BER) Monte-Carlo Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/Discover_Sionna.html#Conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials.html#for-beginners">For Beginners</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Sionna_tutorial_part1.html">Part 1: Getting Started with Sionna</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part1.html#Imports-&amp;-Basics">Imports &amp; Basics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part1.html#A-note-on-random-number-generation">A note on random number generation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part1.html#Sionna-Data-flow-and-Design-Paradigms">Sionna Data-flow and Design Paradigms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part1.html#Hello,-Sionna!">Hello, Sionna!</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part1.html#Communication-Systems-as-Keras-Models">Communication Systems as Keras Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part1.html#Forward-Error-Correction-(FEC)">Forward Error Correction (FEC)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part1.html#Eager-vs-Graph-Mode">Eager vs Graph Mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part1.html#Exercise">Exercise</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Sionna_tutorial_part2.html">Part 2: Differentiable Communication Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part2.html#Imports">Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part2.html#Gradient-Computation-Through-End-to-end-Systems">Gradient Computation Through End-to-end Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part2.html#Creating-Custom-Layers">Creating Custom Layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part2.html#Setting-up-Training-Loops">Setting up Training Loops</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Sionna_tutorial_part3.html">Part 3: Advanced Link-level Simulations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part3.html#Imports">Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part3.html#OFDM-Resource-Grid-and-Stream-Management">OFDM Resource Grid and Stream Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part3.html#Antenna-Arrays">Antenna Arrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part3.html#Channel-Model">Channel Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part3.html#Uplink-Transmission-in-the-Frequency-Domain">Uplink Transmission in the Frequency Domain</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Sionna_tutorial_part4.html">Part 4: Toward Learned Receivers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part4.html#Imports">Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part4.html#Simulation-Parameters">Simulation Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part4.html#Implemention-of-an-Advanced-Neural-Receiver">Implemention of an Advanced Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part4.html#Training-the-Neural-Receiver">Training the Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part4.html#Benchmarking-the-Neural-Receiver">Benchmarking the Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part4.html#Conclusion">Conclusion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_tutorial_part4.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Simple_MIMO_Simulation.html">Basic MIMO Simulations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Simple_MIMO_Simulation.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Simple_MIMO_Simulation.html#Simple-uncoded-transmission">Simple uncoded transmission</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Simple_MIMO_Simulation.html#Extension-to-channel-coding">Extension to channel coding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Pulse_shaping_basics.html">Pulse-shaping Basics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Pulse_shaping_basics.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Pulse_shaping_basics.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Pulse_shaping_basics.html#Pulse-shaping-of-a-sequence-of-QAM-symbols">Pulse-shaping of a sequence of QAM symbols</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Pulse_shaping_basics.html#Recovering-the-QAM-symbols-through-matched-filtering-and-downsampling">Recovering the QAM symbols through matched filtering and downsampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Pulse_shaping_basics.html#Investigating-the-ACLR">Investigating the ACLR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Pulse_shaping_basics.html#Windowing">Windowing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Optical_Lumped_Amplification_Channel.html">Optical Channel with Lumped Amplification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Optical_Lumped_Amplification_Channel.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Optical_Lumped_Amplification_Channel.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Optical_Lumped_Amplification_Channel.html#Impulse-Generation">Impulse Generation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Optical_Lumped_Amplification_Channel.html#Attenuation">Attenuation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Optical_Lumped_Amplification_Channel.html#Amplified-Spontaneous-Emission-Noise">Amplified Spontaneous Emission Noise</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Optical_Lumped_Amplification_Channel.html#Chromatic-Dispersion">Chromatic Dispersion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Optical_Lumped_Amplification_Channel.html#Kerr-Nonlinearity">Kerr Nonlinearity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Optical_Lumped_Amplification_Channel.html#Split-Step-Fourier-Method">Split-Step Fourier Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Optical_Lumped_Amplification_Channel.html#References">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials.html#for-experts">For Experts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html">5G Channel Coding and Rate-Matching: Polar vs. LDPC Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#BER-Performance-of-5G-Coding-Schemes">BER Performance of 5G Coding Schemes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#A-Deeper-Look-into-the-Polar-Code-Module">A Deeper Look into the Polar Code Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#Rate-Matching-and-Rate-Recovery">Rate-Matching and Rate-Recovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#Throughput-and-Decoding-Complexity">Throughput and Decoding Complexity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/5G_NR_PUSCH.html">5G NR PUSCH Tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/5G_NR_PUSCH.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/5G_NR_PUSCH.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/5G_NR_PUSCH.html#A-Hello-World-Example">A Hello World Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/5G_NR_PUSCH.html#Carrier-Configuration">Carrier Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/5G_NR_PUSCH.html#Understanding-the-DMRS-Configuration">Understanding the DMRS Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/5G_NR_PUSCH.html#Transport-Blocks-and-MCS">Transport Blocks and MCS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/5G_NR_PUSCH.html#Looking-into-the-PUSCHTransmitter">Looking into the PUSCHTransmitter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/5G_NR_PUSCH.html#Components-of-the-PUSCHReceiver">Components of the PUSCHReceiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/5G_NR_PUSCH.html#End-to-end-PUSCH-Simulations">End-to-end PUSCH Simulations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Bit_Interleaved_Coded_Modulation.html">Bit-Interleaved Coded Modulation (BICM)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Bit_Interleaved_Coded_Modulation.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Bit_Interleaved_Coded_Modulation.html#System-Block-Diagram">System Block Diagram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Bit_Interleaved_Coded_Modulation.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Bit_Interleaved_Coded_Modulation.html#A-Simple-BICM-System">A Simple BICM System</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Bit_Interleaved_Coded_Modulation.html#All-zero-Codeword-Simulations">All-zero Codeword Simulations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Bit_Interleaved_Coded_Modulation.html#EXIT-Charts">EXIT Charts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Bit_Interleaved_Coded_Modulation.html#Mismatched-Demapping-and-the-Advantages-of-Min-sum-Decoding">Mismatched Demapping and the Advantages of Min-sum Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Bit_Interleaved_Coded_Modulation.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/MIMO_OFDM_Transmissions_over_CDL.html">MIMO OFDM Transmissions over the CDL Channel Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/MIMO_OFDM_Transmissions_over_CDL.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/MIMO_OFDM_Transmissions_over_CDL.html#System-Setup">System Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/MIMO_OFDM_Transmissions_over_CDL.html#Simulations">Simulations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Neural_Receiver.html">Neural Receiver for OFDM SIMO Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Neural_Receiver.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Neural_Receiver.html#Simulation-Parameters">Simulation Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Neural_Receiver.html#Neural-Receiver">Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Neural_Receiver.html#End-to-end-System">End-to-end System</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Neural_Receiver.html#End-to-end-System-as-a-Keras-Model">End-to-end System as a Keras Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Neural_Receiver.html#Evaluation-of-the-Baselines">Evaluation of the Baselines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Neural_Receiver.html#Training-the-Neural-Receiver">Training the Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Neural_Receiver.html#Evaluation-of-the-Neural-Receiver">Evaluation of the Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Neural_Receiver.html#Pre-computed-Results">Pre-computed Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Neural_Receiver.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Realistic_Multiuser_MIMO_Simulations.html">Realistic Multiuser MIMO OFDM Simulations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Realistic_Multiuser_MIMO_Simulations.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Realistic_Multiuser_MIMO_Simulations.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Realistic_Multiuser_MIMO_Simulations.html#System-Setup">System Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Realistic_Multiuser_MIMO_Simulations.html#Uplink-Transmissions-in-the-Frequency-Domain">Uplink Transmissions in the Frequency Domain</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/OFDM_MIMO_Detection.html">OFDM MIMO Channel Estimation and Detection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/OFDM_MIMO_Detection.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/OFDM_MIMO_Detection.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/OFDM_MIMO_Detection.html#Simulation-parameters">Simulation parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/OFDM_MIMO_Detection.html#Estimation-of-the-channel-time,-frequency,-and-spatial-covariance-matrices">Estimation of the channel time, frequency, and spatial covariance matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/OFDM_MIMO_Detection.html#Loading-the-channel-covariance-matrices">Loading the channel covariance matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/OFDM_MIMO_Detection.html#Comparison-of-OFDM-estimators">Comparison of OFDM estimators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/OFDM_MIMO_Detection.html#Comparison-of-MIMO-detectors">Comparison of MIMO detectors</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Introduction_to_Iterative_Detection_and_Decoding.html">Introduction to Iterative Detection and Decoding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Introduction_to_Iterative_Detection_and_Decoding.html#Iterative-Detection-and-Decoding">Iterative Detection and Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Introduction_to_Iterative_Detection_and_Decoding.html#Table-of-contents">Table of contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Introduction_to_Iterative_Detection_and_Decoding.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Introduction_to_Iterative_Detection_and_Decoding.html#Simulation-Parameters">Simulation Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Introduction_to_Iterative_Detection_and_Decoding.html#Setting-up-the-Keras-Models">Setting-up the Keras Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Introduction_to_Iterative_Detection_and_Decoding.html#Non-IDD-versus-IDD-Benchmarks">Non-IDD versus IDD Benchmarks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Introduction_to_Iterative_Detection_and_Decoding.html#Discussion-Optimizing-IDD-with-Machine-Learning">Discussion-Optimizing IDD with Machine Learning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Introduction_to_Iterative_Detection_and_Decoding.html#Comments">Comments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Introduction_to_Iterative_Detection_and_Decoding.html#List-of-References">List of References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Autoencoder.html">End-to-end Learning with Autoencoders</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Autoencoder.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Autoencoder.html#Simulation-Parameters">Simulation Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Autoencoder.html#Neural-Demapper">Neural Demapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Autoencoder.html#Trainable-End-to-end-System:-Conventional-Training">Trainable End-to-end System: Conventional Training</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Autoencoder.html#Trainable-End-to-end-System:-RL-based-Training">Trainable End-to-end System: RL-based Training</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Autoencoder.html#Evaluation">Evaluation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Autoencoder.html#Visualizing-the-Learned-Constellations">Visualizing the Learned Constellations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Autoencoder.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Weighted_BP_Algorithm.html">Weighted Belief Propagation Decoding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Weighted_BP_Algorithm.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Weighted_BP_Algorithm.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Weighted_BP_Algorithm.html#Weighted-BP-for-BCH-Codes">Weighted BP for BCH Codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Weighted_BP_Algorithm.html#Further-Experiments">Further Experiments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Weighted_BP_Algorithm.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/CIR_Dataset.html">Channel Models from Datasets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/CIR_Dataset.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/CIR_Dataset.html#Simulation-Parameters">Simulation Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/CIR_Dataset.html#Creating-a-Simple-Dataset">Creating a Simple Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/CIR_Dataset.html#Generators">Generators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/CIR_Dataset.html#Use-the-Channel-Model-for-OFDM-Transmissions">Use the Channel Model for OFDM Transmissions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/DeepMIMO.html">Using the DeepMIMO Dataset with Sionna</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/DeepMIMO.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/DeepMIMO.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/DeepMIMO.html#Configuration-of-DeepMIMO">Configuration of DeepMIMO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/DeepMIMO.html#Using-DeepMIMO-with-Sionna">Using DeepMIMO with Sionna</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/DeepMIMO.html#Link-level-Simulations-using-Sionna-and-DeepMIMO">Link-level Simulations using Sionna and DeepMIMO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/DeepMIMO.html#DeepMIMO-License-and-Citation">DeepMIMO License and Citation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials.html#ray-tracing">Ray Tracing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Introduction.html">Introduction to Sionna RT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Introduction.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Introduction.html#Background-Information">Background Information</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Introduction.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Introduction.html#Loading-Scenes">Loading Scenes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Introduction.html#Ray-Tracing-for-Radio-Propagation">Ray Tracing for Radio Propagation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Introduction.html#From-Paths-to-Channel-Impulse-Responses">From Paths to Channel Impulse Responses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Introduction.html#BER-Evaluation">BER Evaluation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Introduction.html#Runtime-vs-Depth">Runtime vs Depth</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Introduction.html#Coverage-Map">Coverage Map</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Introduction.html#Site-specifc-Link-Level-Simulations">Site-specifc Link-Level Simulations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Introduction.html#Conclusion-and-Outlook">Conclusion and Outlook</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Diffraction.html">Tutorial on Diffraction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Diffraction.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Diffraction.html#Background-Information">Background Information</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Diffraction.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Diffraction.html#Experiments-with-a-Simple-Wedge">Experiments with a Simple Wedge</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Diffraction.html#Coverage-Maps-with-Diffraction">Coverage Maps with Diffraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Diffraction.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Scattering.html">Tutorial on Scattering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Scattering.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Scattering.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Scattering.html#Scattering-Basics">Scattering Basics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Scattering.html#Scattering-Patterns">Scattering Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Scattering.html#Validation-Against-the-%22Far%22-Wall-Approximation">Validation Against the “Far”-Wall Approximation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Scattering.html#Coverage-Maps-With-Scattering">Coverage Maps With Scattering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Scattering.html#Impact-on-Channel-Impulse-Response">Impact on Channel Impulse Response</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Scattering.html#Summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Scattering.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Mobility.html">Mobility in Sionna RT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Mobility.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Mobility.html#Background-Information">Background Information</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Mobility.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Mobility.html#Controlling-Position-and-Orientation-of-Scene-Objects">Controlling Position and Orientation of Scene Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Mobility.html#Time-Evolution-of-Channels-Via-Doppler-Shift">Time Evolution of Channels Via Doppler Shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Mobility.html#Comparison-of-Doppler--vs-Position-based-Time-Evolution">Comparison of Doppler- vs Position-based Time Evolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Mobility.html#Summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_RIS.html">Tutorial on Reconfigurable Intelligent Surfaces (RIS)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_RIS.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_RIS.html#Background-Information">Background Information</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_RIS.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_RIS.html#Reproducing-Results-from-the-Literature">Reproducing Results from the Literature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_RIS.html#RIS-with-Multiple-Reradiation-Modes">RIS with Multiple Reradiation Modes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_RIS.html#Coverage-Enhancement-with-RIS">Coverage Enhancement with RIS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_RIS.html#Gradient-Based-RIS-Optimization">Gradient-Based RIS Optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_RIS.html#Summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_RIS.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Coverage_Map.html">Tutorial on Coverage Maps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Coverage_Map.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Coverage_Map.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Coverage_Map.html#Understanding-coverage-maps">Understanding coverage maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Coverage_Map.html#Coverage-map-for-a-realistic-scene">Coverage map for a realistic scene</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../examples/Sionna_Ray_Tracing_Coverage_Map.html#Conclusions">Conclusions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../made_with_sionna.html">“Made with Sionna”</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../em_primer.html">Primer on Electromagnetics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../em_primer.html#coordinate-system-rotations-and-vector-fields">Coordinate system, rotations, and vector fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../em_primer.html#planar-time-harmonic-waves">Planar Time-Harmonic Waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../em_primer.html#far-field-of-a-transmitting-antenna">Far Field of a Transmitting Antenna</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../em_primer.html#modelling-of-a-receiving-antenna">Modelling of a Receiving Antenna</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../em_primer.html#general-propagation-path">General Propagation Path</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../em_primer.html#frequency-impulse-response">Frequency &amp; Impulse Response</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../em_primer.html#reflection-and-refraction">Reflection and Refraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../em_primer.html#diffraction">Diffraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../em_primer.html#scattering">Scattering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../em_primer.html#reconfigurable-intelligent-surfaces-ris">Reconfigurable Intelligent Surfaces (RIS)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/sionna.html">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/fec.html">Forward Error Correction (FEC)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/fec.linear.html">Linear Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.linear.html#encoder">Encoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.linear.html#decoder">Decoder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/fec.ldpc.html">Low-Density Parity-Check (LDPC)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.ldpc.html#ldpc-encoder">LDPC Encoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.ldpc.html#ldpc-decoder">LDPC Decoder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/fec.polar.html">Polar Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.polar.html#polar-encoding">Polar Encoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.polar.html#polar-decoding">Polar Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.polar.html#polar-utility-functions">Polar Utility Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/fec.conv.html">Convolutional Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.conv.html#convolutional-encoding">Convolutional Encoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.conv.html#viterbi-decoding">Viterbi Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.conv.html#bcjr-decoding">BCJR Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.conv.html#convolutional-code-utility-functions">Convolutional Code Utility Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/fec.turbo.html">Turbo Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.turbo.html#turbo-encoding">Turbo Encoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.turbo.html#turbo-decoding">Turbo Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.turbo.html#turbo-utility-functions">Turbo Utility Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/fec.crc.html">Cyclic Redundancy Check (CRC)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.crc.html#crcencoder">CRCEncoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.crc.html#crcdecoder">CRCDecoder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/fec.interleaving.html">Interleaving</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.interleaving.html#interleaver">Interleaver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.interleaving.html#deinterleaver">Deinterleaver</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/fec.scrambling.html">Scrambling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.scrambling.html#scrambler">Scrambler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.scrambling.html#tb5gscrambler">TB5GScrambler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.scrambling.html#descrambler">Descrambler</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/fec.utils.html">Utility Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.utils.html#binary-linear-codes">(Binary) Linear Codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.utils.html#exit-analysis">EXIT Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/fec.utils.html#miscellaneous">Miscellaneous</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mapping.html">Mapping</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/mapping.html#constellations">Constellations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mapping.html#constellation">Constellation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mapping.html#qam">qam</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mapping.html#pam">pam</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mapping.html#pam-gray">pam_gray</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/mapping.html#mapper">Mapper</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mapping.html#sionna.mapping.Mapper"><code class="docutils literal notranslate"><span class="pre">Mapper</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/mapping.html#demapping">Demapping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mapping.html#demapper">Demapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mapping.html#demapperwithprior">DemapperWithPrior</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mapping.html#symboldemapper">SymbolDemapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mapping.html#symboldemapperwithprior">SymbolDemapperWithPrior</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/mapping.html#utility-functions">Utility Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mapping.html#symbollogits2llrs">SymbolLogits2LLRs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mapping.html#llrs2symbollogits">LLRs2SymbolLogits</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mapping.html#symbollogits2llrswithprior">SymbolLogits2LLRsWithPrior</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mapping.html#symbollogits2moments">SymbolLogits2Moments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mapping.html#symbolinds2bits">SymbolInds2Bits</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mapping.html#pam2qam">PAM2QAM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mapping.html#qam2pam">QAM2PAM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/channel.html">Channel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/channel.wireless.html">Wireless</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel.wireless.html#awgn">AWGN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel.wireless.html#flat-fading-channel">Flat-fading channel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel.wireless.html#channel-model-interface">Channel model interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel.wireless.html#time-domain-channel">Time domain channel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel.wireless.html#channel-with-ofdm-waveform">Channel with OFDM waveform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel.wireless.html#rayleigh-block-fading">Rayleigh block fading</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel.wireless.html#gpp-38-901-channel-models">3GPP 38.901 channel models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel.wireless.html#external-datasets">External datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel.wireless.html#utility-functions">Utility functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/channel.optical.html">Optical</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel.optical.html#split-step-fourier-method">Split-step Fourier method</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel.optical.html#erbium-doped-fiber-amplifier">Erbium-doped fiber amplifier</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel.optical.html#utility-functions">Utility functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/channel.discrete.html">Discrete</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel.discrete.html#binarymemorylesschannel">BinaryMemorylessChannel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel.discrete.html#binarysymmetricchannel">BinarySymmetricChannel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel.discrete.html#binaryerasurechannel">BinaryErasureChannel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/channel.discrete.html#binaryzchannel">BinaryZChannel</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/ofdm.html">Orthogonal Frequency-Division Multiplexing (OFDM)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ofdm.html#resource-grid">Resource Grid</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#resourcegrid">ResourceGrid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#resourcegridmapper">ResourceGridMapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#resourcegriddemapper">ResourceGridDemapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#removenulledsubcarriers">RemoveNulledSubcarriers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ofdm.html#modulation-demodulation">Modulation &amp; Demodulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#ofdmmodulator">OFDMModulator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#ofdmdemodulator">OFDMDemodulator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ofdm.html#pilot-pattern">Pilot Pattern</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#pilotpattern">PilotPattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#emptypilotpattern">EmptyPilotPattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#kroneckerpilotpattern">KroneckerPilotPattern</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ofdm.html#channel-estimation">Channel Estimation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#basechannelestimator">BaseChannelEstimator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#basechannelinterpolator">BaseChannelInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#lschannelestimator">LSChannelEstimator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#linearinterpolator">LinearInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#lmmseinterpolator">LMMSEInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#nearestneighborinterpolator">NearestNeighborInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#tdl-time-cov-mat">tdl_time_cov_mat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#tdl-freq-cov-mat">tdl_freq_cov_mat</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ofdm.html#precoding">Precoding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#zfprecoder">ZFPrecoder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ofdm.html#equalization">Equalization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#ofdmequalizer">OFDMEqualizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#lmmseequalizer">LMMSEEqualizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#mfequalizer">MFEqualizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#zfequalizer">ZFEqualizer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/ofdm.html#detection">Detection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#ofdmdetector">OFDMDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#ofdmdetectorwithprior">OFDMDetectorWithPrior</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#epdetector">EPDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#kbestdetector">KBestDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#lineardetector">LinearDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#maximumlikelihooddetector">MaximumLikelihoodDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#maximumlikelihooddetectorwithprior">MaximumLikelihoodDetectorWithPrior</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/ofdm.html#mmsepicdetector">MMSEPICDetector</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mimo.html">Multiple-Input Multiple-Output (MIMO)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/mimo.html#stream-management">Stream Management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#sionna.mimo.StreamManagement"><code class="docutils literal notranslate"><span class="pre">StreamManagement</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/mimo.html#precoding">Precoding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#zero-forcing-precoder">zero_forcing_precoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#grid-of-beams-dft-ula">grid_of_beams_dft_ula</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#grid-of-beams-dft">grid_of_beams_dft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#flatten-precoding-mat">flatten_precoding_mat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#normalize-precoding-power">normalize_precoding_power</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/mimo.html#equalization">Equalization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#lmmse-equalizer">lmmse_equalizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#mf-equalizer">mf_equalizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#zf-equalizer">zf_equalizer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/mimo.html#detection">Detection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#epdetector">EPDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#kbestdetector">KBestDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#lineardetector">LinearDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#maximumlikelihooddetector">MaximumLikelihoodDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#maximumlikelihooddetectorwithprior">MaximumLikelihoodDetectorWithPrior</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#mmse-pic">MMSE-PIC</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/mimo.html#utility-functions">Utility Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#list2llr">List2LLR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#list2llrsimple">List2LLRSimple</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#complex2real-vector">complex2real_vector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#real2complex-vector">real2complex_vector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#complex2real-matrix">complex2real_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#real2complex-matrix">real2complex_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#complex2real-covariance">complex2real_covariance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#real2complex-covariance">real2complex_covariance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#complex2real-channel">complex2real_channel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#real2complex-channel">real2complex_channel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/mimo.html#whiten-channel">whiten_channel</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/nr.html">5G NR</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/nr.html#carrier">Carrier</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/nr.html#carrierconfig">CarrierConfig</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/nr.html#layer-mapping">Layer Mapping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/nr.html#layermapper">LayerMapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/nr.html#layerdemapper">LayerDemapper</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/nr.html#pusch">PUSCH</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/nr.html#puschconfig">PUSCHConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/nr.html#puschdmrsconfig">PUSCHDMRSConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/nr.html#puschlschannelestimator">PUSCHLSChannelEstimator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/nr.html#puschpilotpattern">PUSCHPilotPattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/nr.html#puschprecoder">PUSCHPrecoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/nr.html#puschreceiver">PUSCHReceiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/nr.html#puschtransmitter">PUSCHTransmitter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/nr.html#transport-block">Transport Block</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/nr.html#tbconfig">TBConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/nr.html#tbencoder">TBEncoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/nr.html#tbdecoder">TBDecoder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/nr.html#utils">Utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/nr.html#calculate-tb-size">calculate_tb_size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/nr.html#generate-prng-seq">generate_prng_seq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/nr.html#select-mcs">select_mcs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/rt.html">Ray Tracing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/rt.html#scene">Scene</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#id1">Scene</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#compute-paths">compute_paths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#trace-paths">trace_paths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#compute-fields">compute_fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#coverage-map">coverage_map</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#preview">preview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#render">render</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#render-to-file">render_to_file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#load-scene">load_scene</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/rt.html#example-scenes">Example Scenes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#floor-wall">floor_wall</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#simple-street-canyon">simple_street_canyon</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#simple-street-canyon-with-cars">simple_street_canyon_with_cars</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#etoile">etoile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#munich">munich</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#simple-wedge">simple_wedge</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#simple-reflector">simple_reflector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#double-reflector">double_reflector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#triple-reflector">triple_reflector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#box">Box</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/rt.html#paths">Paths</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#id13">Paths</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/rt.html#coverage-maps">Coverage Maps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#coveragemap">CoverageMap</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/rt.html#cameras">Cameras</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#camera">Camera</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/rt.html#scene-objects">Scene Objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#sceneobject">SceneObject</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/rt.html#radio-materials">Radio Materials</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#radiomaterial">RadioMaterial</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#scatteringpattern">ScatteringPattern</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/rt.html#radio-devices">Radio Devices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#transmitter">Transmitter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#receiver">Receiver</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/rt.html#antenna-arrays">Antenna Arrays</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#antennaarray">AntennaArray</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#planararray">PlanarArray</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/rt.html#antennas">Antennas</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#antenna">Antenna</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#compute-gain">compute_gain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#visualize">visualize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#dipole-pattern">dipole_pattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#hw-dipole-pattern">hw_dipole_pattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#iso-pattern">iso_pattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#tr38901-pattern">tr38901_pattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#polarization-model-1">polarization_model_1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#polarization-model-2">polarization_model_2</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/rt.html#reconfigurable-intelligent-surfaces-ris">Reconfigurable Intelligent Surfaces (RIS)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#ris">RIS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#phaseprofile">PhaseProfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#discretephaseprofile">DiscretePhaseProfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#amplitudeprofile">AmplitudeProfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#discreteamplitudeprofile">DiscreteAmplitudeProfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#profileinterpolator">ProfileInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#lagrangeprofileinterpolator">LagrangeProfileInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#cellgrid">CellGrid</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/rt.html#utility-functions">Utility Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#cross">cross</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#dot">dot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#outer">outer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#normalize">normalize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#phi-hat">phi_hat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#rotate">rotate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#rotation-matrix">rotation_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#rot-mat-from-unit-vecs">rot_mat_from_unit_vecs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#r-hat">r_hat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#sample-points-on-hemisphere">sample_points_on_hemisphere</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#theta-hat">theta_hat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#theta-phi-from-unit-vec">theta_phi_from_unit_vec</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#watt-to-dbm">watt_to_dbm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/rt.html#dbm-to-watt">dbm_to_watt</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/signal.html">Signal</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/signal.html#filters">Filters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/signal.html#sincfilter">SincFilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/signal.html#raisedcosinefilter">RaisedCosineFilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/signal.html#rootraisedcosinefilter">RootRaisedCosineFilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/signal.html#customfilter">CustomFilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/signal.html#id1">Filter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/signal.html#window-functions">Window functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/signal.html#hannwindow">HannWindow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/signal.html#hammingwindow">HammingWindow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/signal.html#blackmanwindow">BlackmanWindow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/signal.html#customwindow">CustomWindow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/signal.html#id2">Window</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/signal.html#utility-functions">Utility Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/signal.html#convolve">convolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/signal.html#fft">fft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/signal.html#ifft">ifft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/signal.html#upsampling">Upsampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/signal.html#downsampling">Downsampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/signal.html#empirical-psd">empirical_psd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/signal.html#empirical-aclr">empirical_aclr</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/utils.html">Utility Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/utils.html#metrics">Metrics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#biterrorrate">BitErrorRate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#bitwisemutualinformation">BitwiseMutualInformation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#compute-ber">compute_ber</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#compute-bler">compute_bler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#compute-ser">compute_ser</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#count-errors">count_errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#count-block-errors">count_block_errors</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/utils.html#tensors">Tensors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#expand-to-rank">expand_to_rank</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#flatten-dims">flatten_dims</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#flatten-last-dims">flatten_last_dims</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#insert-dims">insert_dims</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#split-dims">split_dims</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#matrix-sqrt">matrix_sqrt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#matrix-sqrt-inv">matrix_sqrt_inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#matrix-inv">matrix_inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#matrix-pinv">matrix_pinv</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/utils.html#miscellaneous">Miscellaneous</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#binarysource">BinarySource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#symbolsource">SymbolSource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#qamsource">QAMSource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#pamsource">PAMSource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#plotber">PlotBER</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#sim-ber">sim_ber</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#ebnodb2no">ebnodb2no</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#hard-decisions">hard_decisions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#plot-ber">plot_ber</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#complex-normal">complex_normal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#log2">log2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/utils.html#log10">log10</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/config.html">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/config.html#sionna.config.Config"><code class="docutils literal notranslate"><span class="pre">Config</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#sionna.config.Config.np_rng"><code class="docutils literal notranslate"><span class="pre">Config.np_rng</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#sionna.config.Config.py_rng"><code class="docutils literal notranslate"><span class="pre">Config.py_rng</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#sionna.config.Config.seed"><code class="docutils literal notranslate"><span class="pre">Config.seed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#sionna.config.Config.tf_rng"><code class="docutils literal notranslate"><span class="pre">Config.tf_rng</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#sionna.config.Config.xla_compat"><code class="docutils literal notranslate"><span class="pre">Config.xla_compat</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/NVlabs/sionna/discussions">Discussions</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/NVlabs/sionna/issues">Report an Issue</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Sionna</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">sionna.utils.misc</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for sionna.utils.misc</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># SPDX-FileCopyrightText: Copyright (c) 2021-2024 NVIDIA CORPORATION &amp; AFFILIATES. All rights reserved.</span>
<span class="c1"># SPDX-License-Identifier: Apache-2.0</span>
<span class="c1">#</span>
<span class="sd">&quot;&quot;&quot;Miscellaneous utility functions of the Sionna package.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Layer</span>
<span class="kn">from</span> <span class="nn">tensorflow.experimental.numpy</span> <span class="kn">import</span> <span class="n">log10</span> <span class="k">as</span> <span class="n">_log10</span>
<span class="kn">from</span> <span class="nn">tensorflow.experimental.numpy</span> <span class="kn">import</span> <span class="n">log2</span> <span class="k">as</span> <span class="n">_log2</span>
<span class="kn">import</span> <span class="nn">sionna</span>
<span class="kn">from</span> <span class="nn">sionna.utils.metrics</span> <span class="kn">import</span> <span class="n">count_errors</span><span class="p">,</span> <span class="n">count_block_errors</span>
<span class="kn">from</span> <span class="nn">sionna.mapping</span> <span class="kn">import</span> <span class="n">Mapper</span><span class="p">,</span> <span class="n">Constellation</span>
<span class="kn">from</span> <span class="nn">sionna</span> <span class="kn">import</span> <span class="n">signal</span>

<div class="viewcode-block" id="ebnodb2no">
<a class="viewcode-back" href="../../../api/utils.html#sionna.utils.ebnodb2no">[docs]</a>
<span class="k">def</span> <span class="nf">ebnodb2no</span><span class="p">(</span><span class="n">ebno_db</span><span class="p">,</span> <span class="n">num_bits_per_symbol</span><span class="p">,</span> <span class="n">coderate</span><span class="p">,</span> <span class="n">resource_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Compute the noise variance `No` for a given `Eb/No` in dB.</span>

<span class="sd">    The function takes into account the number of coded bits per constellation</span>
<span class="sd">    symbol, the coderate, as well as possible additional overheads related to</span>
<span class="sd">    OFDM transmissions, such as the cyclic prefix and pilots.</span>

<span class="sd">    The value of `No` is computed according to the following expression</span>

<span class="sd">    .. math::</span>
<span class="sd">        N_o = \left(\frac{E_b}{N_o} \frac{r M}{E_s}\right)^{-1}</span>

<span class="sd">    where :math:`2^M` is the constellation size, i.e., :math:`M` is the</span>
<span class="sd">    average number of coded bits per constellation symbol,</span>
<span class="sd">    :math:`E_s=1` is the average energy per constellation per symbol,</span>
<span class="sd">    :math:`r\in(0,1]` is the coderate,</span>
<span class="sd">    :math:`E_b` is the energy per information bit,</span>
<span class="sd">    and :math:`N_o` is the noise power spectral density.</span>
<span class="sd">    For OFDM transmissions, :math:`E_s` is scaled</span>
<span class="sd">    according to the ratio between the total number of resource elements in</span>
<span class="sd">    a resource grid with non-zero energy and the number</span>
<span class="sd">    of resource elements used for data transmission. Also the additionally</span>
<span class="sd">    transmitted energy during the cyclic prefix is taken into account, as</span>
<span class="sd">    well as the number of transmitted streams per transmitter.</span>

<span class="sd">    Input</span>
<span class="sd">    -----</span>
<span class="sd">    ebno_db : float</span>
<span class="sd">        The `Eb/No` value in dB.</span>

<span class="sd">    num_bits_per_symbol : int</span>
<span class="sd">        The number of bits per symbol.</span>

<span class="sd">    coderate : float</span>
<span class="sd">        The coderate used.</span>

<span class="sd">    resource_grid : ResourceGrid</span>
<span class="sd">        An (optional) instance of :class:`~sionna.ofdm.ResourceGrid`</span>
<span class="sd">        for OFDM transmissions.</span>

<span class="sd">    Output</span>
<span class="sd">    ------</span>
<span class="sd">    : float</span>
<span class="sd">        The value of :math:`N_o` in linear scale.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">tf</span><span class="o">.</span><span class="n">is_tensor</span><span class="p">(</span><span class="n">ebno_db</span><span class="p">):</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="n">ebno_db</span><span class="o">.</span><span class="n">dtype</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span>

    <span class="n">ebno</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="mf">10.</span><span class="p">,</span> <span class="n">dtype</span><span class="p">),</span> <span class="n">ebno_db</span><span class="o">/</span><span class="mf">10.</span><span class="p">)</span>

    <span class="n">energy_per_symbol</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">resource_grid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Divide energy per symbol by the number of transmitted streams</span>
        <span class="n">energy_per_symbol</span> <span class="o">/=</span> <span class="n">resource_grid</span><span class="o">.</span><span class="n">num_streams_per_tx</span>

        <span class="c1"># Number of nonzero energy symbols.</span>
        <span class="c1"># We do not account for the nulled DC and guard carriers.</span>
        <span class="n">cp_overhead</span> <span class="o">=</span> <span class="n">resource_grid</span><span class="o">.</span><span class="n">cyclic_prefix_length</span> \
                      <span class="o">/</span> <span class="n">resource_grid</span><span class="o">.</span><span class="n">fft_size</span>
        <span class="n">num_syms</span> <span class="o">=</span> <span class="n">resource_grid</span><span class="o">.</span><span class="n">num_ofdm_symbols</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">cp_overhead</span><span class="p">)</span> \
                    <span class="o">*</span> <span class="n">resource_grid</span><span class="o">.</span><span class="n">num_effective_subcarriers</span>
        <span class="n">energy_per_symbol</span> <span class="o">*=</span> <span class="n">num_syms</span> <span class="o">/</span> <span class="n">resource_grid</span><span class="o">.</span><span class="n">num_data_symbols</span>

    <span class="n">no</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">ebno</span> <span class="o">*</span> <span class="n">coderate</span> <span class="o">*</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">num_bits_per_symbol</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span> \
          <span class="o">/</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">energy_per_symbol</span><span class="p">,</span> <span class="n">dtype</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">no</span></div>


<div class="viewcode-block" id="hard_decisions">
<a class="viewcode-back" href="../../../api/utils.html#sionna.utils.hard_decisions">[docs]</a>
<span class="k">def</span> <span class="nf">hard_decisions</span><span class="p">(</span><span class="n">llr</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transforms LLRs into hard decisions.</span>

<span class="sd">    Positive values are mapped to :math:`1`.</span>
<span class="sd">    Nonpositive values are mapped to :math:`0`.</span>

<span class="sd">    Input</span>
<span class="sd">    -----</span>
<span class="sd">    llr : any non-complex tf.DType</span>
<span class="sd">        Tensor of LLRs.</span>

<span class="sd">    Output</span>
<span class="sd">    ------</span>
<span class="sd">    : Same shape and dtype as ``llr``</span>
<span class="sd">        The hard decisions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">zero</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">llr</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">greater</span><span class="p">(</span><span class="n">llr</span><span class="p">,</span> <span class="n">zero</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">llr</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span></div>


<div class="viewcode-block" id="log10">
<a class="viewcode-back" href="../../../api/utils.html#sionna.utils.log10">[docs]</a>
<span class="k">def</span> <span class="nf">log10</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># pylint: disable=C0301</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;TensorFlow implementation of NumPy&#39;s `log10` function.</span>

<span class="sd">    Simple extension to `tf.experimental.numpy.log10`</span>
<span class="sd">    which casts the result to the `dtype` of the input.</span>
<span class="sd">    For more details see the `TensorFlow &lt;https://www.tensorflow.org/api_docs/python/tf/experimental/numpy/log10&gt;`__ and `NumPy &lt;https://numpy.org/doc/1.16/reference/generated/numpy.log10.html&gt;`__ documentation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">_log10</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span></div>


<div class="viewcode-block" id="log2">
<a class="viewcode-back" href="../../../api/utils.html#sionna.utils.log2">[docs]</a>
<span class="k">def</span> <span class="nf">log2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># pylint: disable=C0301</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;TensorFlow implementation of NumPy&#39;s `log2` function.</span>

<span class="sd">    Simple extension to `tf.experimental.numpy.log2`</span>
<span class="sd">    which casts the result to the `dtype` of the input.</span>
<span class="sd">    For more details see the `TensorFlow &lt;https://www.tensorflow.org/api_docs/python/tf/experimental/numpy/log2&gt;`_ and `NumPy &lt;https://numpy.org/doc/1.16/reference/generated/numpy.log2.html&gt;`_ documentation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">_log2</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span></div>


<div class="viewcode-block" id="BinarySource">
<a class="viewcode-back" href="../../../api/utils.html#sionna.utils.BinarySource">[docs]</a>
<span class="k">class</span> <span class="nc">BinarySource</span><span class="p">(</span><span class="n">Layer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;BinarySource(dtype=tf.float32, seed=None, **kwargs)</span>

<span class="sd">    Layer generating random binary tensors.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dtype : tf.DType</span>
<span class="sd">        Defines the output datatype of the layer.</span>
<span class="sd">        Defaults to `tf.float32`.</span>

<span class="sd">    seed : int or None</span>
<span class="sd">        Set the seed for the random generator used to generate the bits.</span>
<span class="sd">        Set to `None` for random initialization of the RNG.</span>

<span class="sd">    Input</span>
<span class="sd">    -----</span>
<span class="sd">    shape : 1D tensor/array/list, int</span>
<span class="sd">        The desired shape of the output tensor.</span>

<span class="sd">    Output</span>
<span class="sd">    ------</span>
<span class="sd">    : ``shape``, ``dtype``</span>
<span class="sd">        Tensor filled with random binary values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span><span class="o">.</span><span class="n">from_seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_seed</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span> <span class="o">=</span> <span class="n">sionna</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">tf_rng</span>

    <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">int32</span><span class="p">),</span>
                       <span class="n">dtype</span><span class="o">=</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span></div>


<div class="viewcode-block" id="SymbolSource">
<a class="viewcode-back" href="../../../api/utils.html#sionna.utils.SymbolSource">[docs]</a>
<span class="k">class</span> <span class="nc">SymbolSource</span><span class="p">(</span><span class="n">Layer</span><span class="p">):</span>
    <span class="c1"># pylint: disable=line-too-long</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;SymbolSource(constellation_type=None, num_bits_per_symbol=None, constellation=None, return_indices=False, return_bits=False, seed=None, dtype=tf.complex64, **kwargs)</span>

<span class="sd">    Layer generating a tensor of arbitrary shape filled with random constellation symbols.</span>
<span class="sd">    Optionally, the symbol indices and/or binary representations of the</span>
<span class="sd">    constellation symbols can be returned.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    constellation_type : One of [&quot;qam&quot;, &quot;pam&quot;, &quot;custom&quot;], str</span>
<span class="sd">        For &quot;custom&quot;, an instance of :class:`~sionna.mapping.Constellation`</span>
<span class="sd">        must be provided.</span>

<span class="sd">    num_bits_per_symbol : int</span>
<span class="sd">        The number of bits per constellation symbol.</span>
<span class="sd">        Only required for ``constellation_type`` in [&quot;qam&quot;, &quot;pam&quot;].</span>

<span class="sd">    constellation :  Constellation</span>
<span class="sd">        An instance of :class:`~sionna.mapping.Constellation` or</span>
<span class="sd">        `None`. In the latter case, ``constellation_type``</span>
<span class="sd">        and ``num_bits_per_symbol`` must be provided.</span>

<span class="sd">    return_indices : bool</span>
<span class="sd">        If enabled, the function also returns the symbol indices.</span>
<span class="sd">        Defaults to `False`.</span>

<span class="sd">    return_bits : bool</span>
<span class="sd">        If enabled, the function also returns the binary symbol</span>
<span class="sd">        representations (i.e., bit labels).</span>
<span class="sd">        Defaults to `False`.</span>

<span class="sd">    seed : int or None</span>
<span class="sd">        The seed for the random generator.</span>
<span class="sd">        `None` leads to a random initialization of the RNG.</span>
<span class="sd">        Defaults to `None`.</span>

<span class="sd">    dtype : One of [tf.complex64, tf.complex128], tf.DType</span>
<span class="sd">        The output dtype. Defaults to tf.complex64.</span>

<span class="sd">    Input</span>
<span class="sd">    -----</span>
<span class="sd">    shape : 1D tensor/array/list, int</span>
<span class="sd">        The desired shape of the output tensor.</span>

<span class="sd">    Output</span>
<span class="sd">    ------</span>
<span class="sd">    symbols : ``shape``, ``dtype``</span>
<span class="sd">        Tensor filled with random symbols of the chosen ``constellation_type``.</span>

<span class="sd">    symbol_indices : ``shape``, tf.int32</span>
<span class="sd">        Tensor filled with the symbol indices.</span>
<span class="sd">        Only returned if ``return_indices`` is `True`.</span>

<span class="sd">    bits : [``shape``, ``num_bits_per_symbol``], tf.int32</span>
<span class="sd">        Tensor filled with the binary symbol representations (i.e., bit labels).</span>
<span class="sd">        Only returned if ``return_bits`` is `True`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">constellation_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">num_bits_per_symbol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">constellation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">return_indices</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">return_bits</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">complex64</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">constellation</span> <span class="o">=</span> <span class="n">Constellation</span><span class="o">.</span><span class="n">create_or_check_constellation</span><span class="p">(</span>
            <span class="n">constellation_type</span><span class="p">,</span>
            <span class="n">num_bits_per_symbol</span><span class="p">,</span>
            <span class="n">constellation</span><span class="p">,</span>
            <span class="n">dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_bits_per_symbol</span> <span class="o">=</span> <span class="n">constellation</span><span class="o">.</span><span class="n">num_bits_per_symbol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_return_indices</span> <span class="o">=</span> <span class="n">return_indices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_return_bits</span> <span class="o">=</span> <span class="n">return_bits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_binary_source</span> <span class="o">=</span> <span class="n">BinarySource</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="o">.</span><span class="n">real_dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mapper</span> <span class="o">=</span> <span class="n">Mapper</span><span class="p">(</span><span class="n">constellation</span><span class="o">=</span><span class="n">constellation</span><span class="p">,</span>
                              <span class="n">return_indices</span><span class="o">=</span><span class="n">return_indices</span><span class="p">,</span>
                              <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">inputs</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_bits_per_symbol</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_source</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">int32</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_return_indices</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mapper</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mapper</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_return_indices</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_return_bits</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_return_indices</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_return_bits</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="QAMSource">
<a class="viewcode-back" href="../../../api/utils.html#sionna.utils.QAMSource">[docs]</a>
<span class="k">class</span> <span class="nc">QAMSource</span><span class="p">(</span><span class="n">SymbolSource</span><span class="p">):</span>
    <span class="c1"># pylint: disable=line-too-long</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;QAMSource(num_bits_per_symbol=None, return_indices=False, return_bits=False, seed=None, dtype=tf.complex64, **kwargs)</span>

<span class="sd">    Layer generating a tensor of arbitrary shape filled with random QAM symbols.</span>
<span class="sd">    Optionally, the symbol indices and/or binary representations of the</span>
<span class="sd">    constellation symbols can be returned.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    num_bits_per_symbol : int</span>
<span class="sd">        The number of bits per constellation symbol, e.g., 4 for QAM16.</span>

<span class="sd">    return_indices : bool</span>
<span class="sd">        If enabled, the function also returns the symbol indices.</span>
<span class="sd">        Defaults to `False`.</span>

<span class="sd">    return_bits : bool</span>
<span class="sd">        If enabled, the function also returns the binary symbol</span>
<span class="sd">        representations (i.e., bit labels).</span>
<span class="sd">        Defaults to `False`.</span>

<span class="sd">    seed : int or None</span>
<span class="sd">        The seed for the random generator.</span>
<span class="sd">        `None` leads to a random initialization of the RNG.</span>
<span class="sd">        Defaults to `None`.</span>

<span class="sd">    dtype : One of [tf.complex64, tf.complex128], tf.DType</span>
<span class="sd">        The output dtype. Defaults to tf.complex64.</span>

<span class="sd">    Input</span>
<span class="sd">    -----</span>
<span class="sd">    shape : 1D tensor/array/list, int</span>
<span class="sd">        The desired shape of the output tensor.</span>

<span class="sd">    Output</span>
<span class="sd">    ------</span>
<span class="sd">    symbols : ``shape``, ``dtype``</span>
<span class="sd">        Tensor filled with random QAM symbols.</span>

<span class="sd">    symbol_indices : ``shape``, tf.int32</span>
<span class="sd">        Tensor filled with the symbol indices.</span>
<span class="sd">        Only returned if ``return_indices`` is `True`.</span>

<span class="sd">    bits : [``shape``, ``num_bits_per_symbol``], tf.int32</span>
<span class="sd">        Tensor filled with the binary symbol representations (i.e., bit labels).</span>
<span class="sd">        Only returned if ``return_bits`` is `True`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">num_bits_per_symbol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">return_indices</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">return_bits</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">complex64</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">constellation_type</span><span class="o">=</span><span class="s2">&quot;qam&quot;</span><span class="p">,</span>
                         <span class="n">num_bits_per_symbol</span><span class="o">=</span><span class="n">num_bits_per_symbol</span><span class="p">,</span>
                         <span class="n">return_indices</span><span class="o">=</span><span class="n">return_indices</span><span class="p">,</span>
                         <span class="n">return_bits</span><span class="o">=</span><span class="n">return_bits</span><span class="p">,</span>
                         <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
                         <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
                         <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="PAMSource">
<a class="viewcode-back" href="../../../api/utils.html#sionna.utils.PAMSource">[docs]</a>
<span class="k">class</span> <span class="nc">PAMSource</span><span class="p">(</span><span class="n">SymbolSource</span><span class="p">):</span>
    <span class="c1"># pylint: disable=line-too-long</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;PAMSource(num_bits_per_symbol=None, return_indices=False, return_bits=False, seed=None, dtype=tf.complex64, **kwargs)</span>

<span class="sd">    Layer generating a tensor of arbitrary shape filled with random PAM symbols.</span>
<span class="sd">    Optionally, the symbol indices and/or binary representations of the</span>
<span class="sd">    constellation symbols can be returned.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    num_bits_per_symbol : int</span>
<span class="sd">        The number of bits per constellation symbol, e.g., 1 for BPSK.</span>

<span class="sd">    return_indices : bool</span>
<span class="sd">        If enabled, the function also returns the symbol indices.</span>
<span class="sd">        Defaults to `False`.</span>

<span class="sd">    return_bits : bool</span>
<span class="sd">        If enabled, the function also returns the binary symbol</span>
<span class="sd">        representations (i.e., bit labels).</span>
<span class="sd">        Defaults to `False`.</span>

<span class="sd">    seed : int or None</span>
<span class="sd">        The seed for the random generator.</span>
<span class="sd">        `None` leads to a random initialization of the RNG.</span>
<span class="sd">        Defaults to `None`.</span>

<span class="sd">    dtype : One of [tf.complex64, tf.complex128], tf.DType</span>
<span class="sd">        The output dtype. Defaults to tf.complex64.</span>

<span class="sd">    Input</span>
<span class="sd">    -----</span>
<span class="sd">    shape : 1D tensor/array/list, int</span>
<span class="sd">        The desired shape of the output tensor.</span>

<span class="sd">    Output</span>
<span class="sd">    ------</span>
<span class="sd">    symbols : ``shape``, ``dtype``</span>
<span class="sd">        Tensor filled with random PAM symbols.</span>

<span class="sd">    symbol_indices : ``shape``, tf.int32</span>
<span class="sd">        Tensor filled with the symbol indices.</span>
<span class="sd">        Only returned if ``return_indices`` is `True`.</span>

<span class="sd">    bits : [``shape``, ``num_bits_per_symbol``], tf.int32</span>
<span class="sd">        Tensor filled with the binary symbol representations (i.e., bit labels).</span>
<span class="sd">        Only returned if ``return_bits`` is `True`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">num_bits_per_symbol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">return_indices</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">return_bits</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">complex64</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">constellation_type</span><span class="o">=</span><span class="s2">&quot;pam&quot;</span><span class="p">,</span>
                         <span class="n">num_bits_per_symbol</span><span class="o">=</span><span class="n">num_bits_per_symbol</span><span class="p">,</span>
                         <span class="n">return_indices</span><span class="o">=</span><span class="n">return_indices</span><span class="p">,</span>
                         <span class="n">return_bits</span><span class="o">=</span><span class="n">return_bits</span><span class="p">,</span>
                         <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
                         <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
                         <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="sim_ber">
<a class="viewcode-back" href="../../../api/utils.html#sionna.utils.sim_ber">[docs]</a>
<span class="k">def</span> <span class="nf">sim_ber</span><span class="p">(</span><span class="n">mc_fun</span><span class="p">,</span>
            <span class="n">ebno_dbs</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="p">,</span>
            <span class="n">max_mc_iter</span><span class="p">,</span>
            <span class="n">soft_estimates</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">num_target_bit_errors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">num_target_block_errors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">target_ber</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">target_bler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">early_stop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">graph_mode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">distribute</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">forward_keyboard_interrupt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">complex64</span><span class="p">):</span>
    <span class="c1"># pylint: disable=line-too-long</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simulates until target number of errors is reached and returns BER/BLER.</span>

<span class="sd">    The simulation continues with the next SNR point if either</span>
<span class="sd">    ``num_target_bit_errors`` bit errors or ``num_target_block_errors`` block</span>
<span class="sd">    errors is achieved. Further, it continues with the next SNR point after</span>
<span class="sd">    ``max_mc_iter`` batches of size ``batch_size`` have been simulated.</span>
<span class="sd">    Early stopping allows to stop the simulation after the first error-free SNR</span>
<span class="sd">    point or after reaching a certain ``target_ber`` or ``target_bler``.</span>

<span class="sd">    Input</span>
<span class="sd">    -----</span>
<span class="sd">    mc_fun: callable</span>
<span class="sd">        Callable that yields the transmitted bits `b` and the</span>
<span class="sd">        receiver&#39;s estimate `b_hat` for a given ``batch_size`` and</span>
<span class="sd">        ``ebno_db``. If ``soft_estimates`` is True, `b_hat` is interpreted as</span>
<span class="sd">        logit.</span>

<span class="sd">    ebno_dbs: tf.float32</span>
<span class="sd">        A tensor containing SNR points to be evaluated.</span>

<span class="sd">    batch_size: tf.int32</span>
<span class="sd">        Batch-size for evaluation.</span>

<span class="sd">    max_mc_iter: tf.int32</span>
<span class="sd">        Maximum number of Monte-Carlo iterations per SNR point.</span>

<span class="sd">    soft_estimates: bool</span>
<span class="sd">        A boolean, defaults to `False`. If `True`, `b_hat`</span>
<span class="sd">        is interpreted as logit and an additional hard-decision is applied</span>
<span class="sd">        internally.</span>

<span class="sd">    num_target_bit_errors: tf.int32</span>
<span class="sd">        Defaults to `None`. Target number of bit errors per SNR point until</span>
<span class="sd">        the simulation continues to next SNR point.</span>

<span class="sd">    num_target_block_errors: tf.int32</span>
<span class="sd">        Defaults to `None`. Target number of block errors per SNR point</span>
<span class="sd">        until the simulation continues</span>

<span class="sd">    target_ber: tf.float32</span>
<span class="sd">        Defaults to `None`. The simulation stops after the first SNR point</span>
<span class="sd">        which achieves a lower bit error rate as specified by ``target_ber``.</span>
<span class="sd">        This requires ``early_stop`` to be `True`.</span>

<span class="sd">    target_bler: tf.float32</span>
<span class="sd">        Defaults to `None`. The simulation stops after the first SNR point</span>
<span class="sd">        which achieves a lower block error rate as specified by ``target_bler``.</span>
<span class="sd">        This requires ``early_stop`` to be `True`.</span>

<span class="sd">    early_stop: bool</span>
<span class="sd">        A boolean defaults to `True`. If `True`, the simulation stops after the</span>
<span class="sd">        first error-free SNR point (i.e., no error occurred after</span>
<span class="sd">        ``max_mc_iter`` Monte-Carlo iterations).</span>

<span class="sd">    graph_mode: One of [&quot;graph&quot;, &quot;xla&quot;], str</span>
<span class="sd">        A string describing the execution mode of ``mc_fun``.</span>
<span class="sd">        Defaults to `None`. In this case, ``mc_fun`` is executed as is.</span>

<span class="sd">    distribute: `None` (default) | &quot;all&quot; | list of indices | `tf.distribute.strategy`</span>
<span class="sd">        Distributes simulation on multiple parallel devices. If `None`,</span>
<span class="sd">        multi-device simulations are deactivated. If &quot;all&quot;, the workload will</span>
<span class="sd">        be automatically distributed across all available GPUs via the</span>
<span class="sd">        `tf.distribute.MirroredStrategy`.</span>
<span class="sd">        If an explicit list of indices is provided, only the GPUs with the given</span>
<span class="sd">        indices will be used. Alternatively, a custom `tf.distribute.strategy`</span>
<span class="sd">        can be provided. Note that the same `batch_size` will be</span>
<span class="sd">        used for all GPUs in parallel, but the number of Monte-Carlo iterations</span>
<span class="sd">        ``max_mc_iter`` will be scaled by the number of devices such that the</span>
<span class="sd">        same number of total samples is simulated. However, all stopping</span>
<span class="sd">        conditions are still in-place which can cause slight differences in the</span>
<span class="sd">        total number of simulated samples.</span>

<span class="sd">    verbose: bool</span>
<span class="sd">        A boolean defaults to `True`. If `True`, the current progress will be</span>
<span class="sd">        printed.</span>

<span class="sd">    forward_keyboard_interrupt: bool</span>
<span class="sd">        A boolean defaults to `True`. If `False`, KeyboardInterrupts will be</span>
<span class="sd">        catched internally and not forwarded (e.g., will not stop outer loops).</span>
<span class="sd">        If `False`, the simulation ends and returns the intermediate simulation</span>
<span class="sd">        results.</span>

<span class="sd">    callback: `None` (default) | callable</span>
<span class="sd">        If specified, ``callback`` will be called after each Monte-Carlo step.</span>
<span class="sd">        Can be used for logging or advanced early stopping. Input signature of</span>
<span class="sd">        ``callback`` must match `callback(mc_iter, snr_idx, ebno_dbs,</span>
<span class="sd">        bit_errors, block_errors, nb_bits, nb_blocks)` where ``mc_iter``</span>
<span class="sd">        denotes the number of processed batches for the current SNR point,</span>
<span class="sd">        ``snr_idx`` is the index of the current SNR point, ``ebno_dbs`` is the</span>
<span class="sd">        vector of all SNR points to be evaluated, ``bit_errors`` the vector of</span>
<span class="sd">        number of bit errors for each SNR point, ``block_errors`` the vector of</span>
<span class="sd">        number of block errors, ``nb_bits`` the vector of number of simulated</span>
<span class="sd">        bits, ``nb_blocks`` the vector of number of simulated blocks,</span>
<span class="sd">        respectively. If ``callable`` returns `sim_ber.CALLBACK_NEXT_SNR`, early</span>
<span class="sd">        stopping is detected and the simulation will continue with the</span>
<span class="sd">        next SNR point. If ``callable`` returns</span>
<span class="sd">        `sim_ber.CALLBACK_STOP`, the simulation is stopped</span>
<span class="sd">        immediately. For `sim_ber.CALLBACK_CONTINUE` continues with</span>
<span class="sd">        the simulation.</span>

<span class="sd">    dtype: tf.complex64</span>
<span class="sd">        Datatype of the callable ``mc_fun`` to be used as input/output.</span>

<span class="sd">    Output</span>
<span class="sd">    ------</span>
<span class="sd">    (ber, bler) :</span>
<span class="sd">        Tuple:</span>

<span class="sd">    ber: tf.float32</span>
<span class="sd">        The bit-error rate.</span>

<span class="sd">    bler: tf.float32</span>
<span class="sd">        The block-error rate.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    AssertionError</span>
<span class="sd">        If ``soft_estimates`` is not bool.</span>

<span class="sd">    AssertionError</span>
<span class="sd">        If ``dtype`` is not `tf.complex`.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    This function is implemented based on tensors to allow</span>
<span class="sd">    full compatibility with tf.function(). However, to run simulations</span>
<span class="sd">    in graph mode, the provided ``mc_fun`` must use the `@tf.function()`</span>
<span class="sd">    decorator.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># utility function to print progress</span>
    <span class="k">def</span> <span class="nf">_print_progress</span><span class="p">(</span><span class="n">is_final</span><span class="p">,</span> <span class="n">rt</span><span class="p">,</span> <span class="n">idx_snr</span><span class="p">,</span> <span class="n">idx_it</span><span class="p">,</span> <span class="n">header_text</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print summary of current simulation progress.</span>

<span class="sd">        Input</span>
<span class="sd">        -----</span>
<span class="sd">        is_final: bool</span>
<span class="sd">            A boolean. If True, the progress is printed into a new line.</span>
<span class="sd">        rt: float</span>
<span class="sd">            The runtime of the current SNR point in seconds.</span>
<span class="sd">        idx_snr: int</span>
<span class="sd">            Index of current SNR point.</span>
<span class="sd">        idx_it: int</span>
<span class="sd">            Current iteration index.</span>
<span class="sd">        header_text: list of str</span>
<span class="sd">            Elements will be printed instead of current progress, iff not None.</span>
<span class="sd">            Can be used to generate table header.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># set carriage return if not final step</span>
        <span class="k">if</span> <span class="n">is_final</span><span class="p">:</span>
            <span class="n">end_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">end_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span>

        <span class="c1"># prepare to print table header</span>
        <span class="k">if</span> <span class="n">header_text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">row_text</span> <span class="o">=</span> <span class="n">header_text</span>
            <span class="n">end_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># calculate intermediate ber / bler</span>
            <span class="n">ber_np</span> <span class="o">=</span> <span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">bit_errors</span><span class="p">[</span><span class="n">idx_snr</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
                        <span class="o">/</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">nb_bits</span><span class="p">[</span><span class="n">idx_snr</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
            <span class="n">ber_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">ber_np</span><span class="p">)</span> <span class="c1"># avoid nan for first point</span>
            <span class="n">bler_np</span> <span class="o">=</span> <span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">block_errors</span><span class="p">[</span><span class="n">idx_snr</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
                        <span class="o">/</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">nb_blocks</span><span class="p">[</span><span class="n">idx_snr</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
            <span class="n">bler_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">bler_np</span><span class="p">)</span> <span class="c1"># avoid nan for first point</span>

            <span class="c1"># load statuslevel</span>
            <span class="c1"># print current iter if simulation is still running</span>
            <span class="k">if</span> <span class="n">status</span><span class="p">[</span><span class="n">idx_snr</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">status_txt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;iter: </span><span class="si">{</span><span class="n">idx_it</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">max_mc_iter</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">status_txt</span> <span class="o">=</span> <span class="n">status_levels</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">status</span><span class="p">[</span><span class="n">idx_snr</span><span class="p">])]</span>

            <span class="c1"># generate list with all elements to be printed</span>
            <span class="n">row_text</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ebno_dbs</span><span class="p">[</span><span class="n">idx_snr</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)),</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ber_np</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bler_np</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">bit_errors</span><span class="p">[</span><span class="n">idx_snr</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="mi">0</span><span class="p">),</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">nb_bits</span><span class="p">[</span><span class="n">idx_snr</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="mi">0</span><span class="p">),</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">block_errors</span><span class="p">[</span><span class="n">idx_snr</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="mi">0</span><span class="p">),</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">nb_blocks</span><span class="p">[</span><span class="n">idx_snr</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="mi">0</span><span class="p">),</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">rt</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="n">status_txt</span><span class="p">]</span>

        <span class="c1"># pylint: disable=line-too-long, consider-using-f-string</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{: &gt;9}</span><span class="s2"> |</span><span class="si">{: &gt;11}</span><span class="s2"> |</span><span class="si">{: &gt;11}</span><span class="s2"> |</span><span class="si">{: &gt;12}</span><span class="s2"> |</span><span class="si">{: &gt;12}</span><span class="s2"> |</span><span class="si">{: &gt;13}</span><span class="s2"> |</span><span class="si">{: &gt;12}</span><span class="s2"> |</span><span class="si">{: &gt;12}</span><span class="s2"> |</span><span class="si">{: &gt;10}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">row_text</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="n">end_str</span><span class="p">)</span>

    <span class="c1"># distributed execution should not be done in Eager mode</span>
    <span class="c1"># XLA mode seems to have difficulties with TF2.13</span>
    <span class="nd">@tf</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">jit_compile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_run_distributed</span><span class="p">(</span><span class="n">strategy</span><span class="p">,</span> <span class="n">mc_fun</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">ebno_db</span><span class="p">):</span>
        <span class="c1"># use tf.distribute to execute on parallel devices (=replicas)</span>
        <span class="n">outputs_rep</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">mc_fun</span><span class="p">,</span>
                                   <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">ebno_db</span><span class="p">))</span>
        <span class="c1"># copy replicas back to single device</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">outputs_rep</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">b_hat</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">outputs_rep</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">b</span><span class="p">,</span> <span class="n">b_hat</span>

     <span class="c1"># init table headers</span>
    <span class="n">header_text</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;EbNo [dB]&quot;</span><span class="p">,</span> <span class="s2">&quot;BER&quot;</span><span class="p">,</span> <span class="s2">&quot;BLER&quot;</span><span class="p">,</span> <span class="s2">&quot;bit errors&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;num bits&quot;</span><span class="p">,</span> <span class="s2">&quot;block errors&quot;</span><span class="p">,</span> <span class="s2">&quot;num blocks&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;runtime [s]&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">]</span>

    <span class="c1"># replace status by text</span>
    <span class="n">status_levels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;not simulated&quot;</span><span class="p">,</span> <span class="c1"># status=0</span>
            <span class="s2">&quot;reached max iter       &quot;</span><span class="p">,</span> <span class="c1"># status=1; spacing for impr. layout</span>
            <span class="s2">&quot;no errors - early stop&quot;</span><span class="p">,</span> <span class="c1"># status=2</span>
            <span class="s2">&quot;reached target bit errors&quot;</span><span class="p">,</span> <span class="c1"># status=3</span>
            <span class="s2">&quot;reached target block errors&quot;</span><span class="p">,</span> <span class="c1"># status=4</span>
            <span class="s2">&quot;reached target BER - early stop&quot;</span><span class="p">,</span> <span class="c1"># status=5</span>
            <span class="s2">&quot;reached target BLER - early stop&quot;</span><span class="p">,</span> <span class="c1"># status=6</span>
            <span class="s2">&quot;callback triggered stopping&quot;</span><span class="p">]</span> <span class="c1"># status=7</span>


    <span class="c1"># check inputs for consistency</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">early_stop</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span> <span class="s2">&quot;early_stop must be bool.&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">soft_estimates</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span> <span class="s2">&quot;soft_estimates must be bool.&quot;</span>
    <span class="k">assert</span> <span class="n">dtype</span><span class="o">.</span><span class="n">is_complex</span><span class="p">,</span> <span class="s2">&quot;dtype must be a complex type.&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span> <span class="s2">&quot;verbose must be bool.&quot;</span>

    <span class="c1"># target_ber / target_bler only works if early stop is activated</span>
    <span class="k">if</span> <span class="n">target_ber</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">early_stop</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: early stop is deactivated. Thus, target_ber &quot;</span> \
                  <span class="s2">&quot;is ignored.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">target_ber</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span> <span class="c1"># deactivate early stopping condition</span>
    <span class="k">if</span> <span class="n">target_bler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">early_stop</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: early stop is deactivated. Thus, target_bler &quot;</span> \
                  <span class="s2">&quot;is ignored.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">target_bler</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span> <span class="c1"># deactivate early stopping condition</span>

    <span class="k">if</span> <span class="n">graph_mode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">graph_mode</span><span class="o">=</span><span class="s2">&quot;default&quot;</span> <span class="c1"># applies default graph mode</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">graph_mode</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s2">&quot;graph_mode must be str.&quot;</span>

    <span class="k">if</span> <span class="n">graph_mode</span><span class="o">==</span><span class="s2">&quot;default&quot;</span><span class="p">:</span>
        <span class="k">pass</span> <span class="c1"># nothing to do</span>
    <span class="k">elif</span> <span class="n">graph_mode</span><span class="o">==</span><span class="s2">&quot;graph&quot;</span><span class="p">:</span>
        <span class="c1"># avoid retracing -&gt; check if mc_fun is already a function</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mc_fun</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">GenericFunction</span><span class="p">):</span>
            <span class="n">mc_fun</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">mc_fun</span><span class="p">,</span>
                                 <span class="n">jit_compile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">experimental_follow_type_hints</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">graph_mode</span><span class="o">==</span><span class="s2">&quot;xla&quot;</span><span class="p">:</span>
        <span class="c1"># avoid retracing -&gt; check if mc_fun is already a function</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mc_fun</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">GenericFunction</span><span class="p">)</span> <span class="ow">or</span> \
           <span class="ow">not</span> <span class="n">mc_fun</span><span class="o">.</span><span class="n">function_spec</span><span class="o">.</span><span class="n">jit_compile</span><span class="p">:</span>
            <span class="n">mc_fun</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">mc_fun</span><span class="p">,</span>
                                 <span class="n">jit_compile</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="n">experimental_follow_type_hints</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unknown graph_mode selected.&quot;</span><span class="p">)</span>

    <span class="c1"># support multi-device simulations by using the tf.distribute package</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">list_logical_devices</span><span class="p">(</span><span class="s1">&#39;GPU&#39;</span><span class="p">))</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">run_multigpu</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">distribute</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">distribute</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># disabled per default</span>
        <span class="n">run_multigpu</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># use strategy if explicitly provided</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">distribute</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">distribute</span><span class="o">.</span><span class="n">Strategy</span><span class="p">):</span>
        <span class="n">run_multigpu</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">strategy</span> <span class="o">=</span> <span class="n">distribute</span> <span class="c1"># distribute is already a tf.distribute.strategy</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">run_multigpu</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># use all available gpus</span>
        <span class="k">if</span> <span class="n">distribute</span><span class="o">==</span><span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="n">gpus</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">list_logical_devices</span><span class="p">(</span><span class="s1">&#39;GPU&#39;</span><span class="p">)</span>
        <span class="c1"># mask active GPUs if indices are provided</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">distribute</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="n">gpus_avail</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">list_logical_devices</span><span class="p">(</span><span class="s1">&#39;GPU&#39;</span><span class="p">)</span>
            <span class="n">gpus</span> <span class="o">=</span> <span class="p">[</span><span class="n">gpus_avail</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">distribute</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">gpus_avail</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unknown value for distribute.&quot;</span><span class="p">)</span>

        <span class="c1"># deactivate logging of tf.device placement</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Setting tf.debugging.set_log_device_placement to False.&quot;</span><span class="p">)</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">debugging</span><span class="o">.</span><span class="n">set_log_device_placement</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># we reduce to the first device by default</span>
        <span class="n">strategy</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">distribute</span><span class="o">.</span><span class="n">MirroredStrategy</span><span class="p">(</span><span class="n">gpus</span><span class="p">,</span>
                            <span class="n">cross_device_ops</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">distribute</span><span class="o">.</span><span class="n">ReductionToOneDevice</span><span class="p">(</span>
                                                <span class="n">reduce_to_device</span><span class="o">=</span><span class="n">gpus</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

    <span class="c1"># reduce max_mc_iter if multi_gpu simulations are activated</span>
    <span class="k">if</span> <span class="n">run_multigpu</span><span class="p">:</span>
        <span class="n">num_replicas</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">num_replicas_in_sync</span> <span class="c1"># pylint: disable=possibly-used-before-assignment</span>
        <span class="n">max_mc_iter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">max_mc_iter</span><span class="o">/</span><span class="n">num_replicas</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Distributing simulation across </span><span class="si">{</span><span class="n">num_replicas</span><span class="si">}</span><span class="s2"> devices.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reducing max_mc_iter to </span><span class="si">{</span><span class="n">max_mc_iter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">ebno_dbs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">ebno_dbs</span><span class="p">,</span> <span class="n">dtype</span><span class="o">.</span><span class="n">real_dtype</span><span class="p">)</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
    <span class="n">num_points</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">ebno_dbs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">bit_errors</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span>   <span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">num_points</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
                                <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
    <span class="n">block_errors</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span> <span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">num_points</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
                                <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
    <span class="n">nb_bits</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span>  <span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">num_points</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
                            <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
    <span class="n">nb_blocks</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">num_points</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
                            <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

    <span class="c1"># track status of simulation (early termination etc.)</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_points</span><span class="p">)</span>

    <span class="c1"># measure runtime per SNR point</span>
    <span class="n">runtime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_points</span><span class="p">)</span>

    <span class="c1"># ensure num_target_errors is a tensor</span>
    <span class="k">if</span> <span class="n">num_target_bit_errors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">num_target_bit_errors</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">num_target_bit_errors</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">num_target_block_errors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">num_target_block_errors</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">num_target_block_errors</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># simulate until a target number of errors is reached</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tf</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="n">num_points</span><span class="p">):</span>
            <span class="n">runtime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="c1"># save start time</span>
            <span class="n">iter_count</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c1"># for print in verbose mode</span>
            <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">tf</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="n">max_mc_iter</span><span class="p">):</span>

                <span class="n">iter_count</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="k">if</span> <span class="n">run_multigpu</span><span class="p">:</span> <span class="c1"># distributed execution</span>
                    <span class="n">b</span><span class="p">,</span> <span class="n">b_hat</span> <span class="o">=</span> <span class="n">_run_distributed</span><span class="p">(</span><span class="n">strategy</span><span class="p">,</span>
                                                <span class="n">mc_fun</span><span class="p">,</span>
                                                <span class="n">batch_size</span><span class="p">,</span>
                                                <span class="n">ebno_dbs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">outputs</span> <span class="o">=</span> <span class="n">mc_fun</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">ebno_db</span><span class="o">=</span><span class="n">ebno_dbs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="c1"># assume first and second return value is b and b_hat</span>
                    <span class="c1"># other returns are ignored</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">b_hat</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">soft_estimates</span><span class="p">:</span>
                    <span class="n">b_hat</span> <span class="o">=</span> <span class="n">hard_decisions</span><span class="p">(</span><span class="n">b_hat</span><span class="p">)</span>

                <span class="c1"># count errors</span>
                <span class="n">bit_e</span> <span class="o">=</span> <span class="n">count_errors</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b_hat</span><span class="p">)</span>
                <span class="n">block_e</span> <span class="o">=</span> <span class="n">count_block_errors</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b_hat</span><span class="p">)</span>

                <span class="c1"># count total number of bits</span>
                <span class="n">bit_n</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
                <span class="n">block_n</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

                <span class="c1"># update variables</span>
                <span class="n">bit_errors</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">tensor_scatter_nd_add</span><span class="p">(</span>  <span class="n">bit_errors</span><span class="p">,</span> <span class="p">[[</span><span class="n">i</span><span class="p">]],</span>
                                                    <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">([</span><span class="n">bit_e</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">))</span>
                <span class="n">block_errors</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">tensor_scatter_nd_add</span><span class="p">(</span>  <span class="n">block_errors</span><span class="p">,</span> <span class="p">[[</span><span class="n">i</span><span class="p">]],</span>
                                                <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">([</span><span class="n">block_e</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">))</span>
                <span class="n">nb_bits</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">tensor_scatter_nd_add</span><span class="p">(</span> <span class="n">nb_bits</span><span class="p">,</span> <span class="p">[[</span><span class="n">i</span><span class="p">]],</span>
                                                    <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">([</span><span class="n">bit_n</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">))</span>
                <span class="n">nb_blocks</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">tensor_scatter_nd_add</span><span class="p">(</span> <span class="n">nb_blocks</span><span class="p">,</span> <span class="p">[[</span><span class="n">i</span><span class="p">]],</span>
                                                <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">([</span><span class="n">block_n</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">))</span>

                <span class="n">cb_state</span> <span class="o">=</span> <span class="n">sim_ber</span><span class="o">.</span><span class="n">CALLBACK_CONTINUE</span>
                <span class="k">if</span> <span class="n">callback</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">cb_state</span> <span class="o">=</span> <span class="n">callback</span> <span class="p">(</span><span class="n">ii</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">ebno_dbs</span><span class="p">,</span> <span class="n">bit_errors</span><span class="p">,</span>
                                       <span class="n">block_errors</span><span class="p">,</span> <span class="n">nb_bits</span><span class="p">,</span>
                                       <span class="n">nb_blocks</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">cb_state</span> <span class="ow">in</span> <span class="p">(</span><span class="n">sim_ber</span><span class="o">.</span><span class="n">CALLBACK_STOP</span><span class="p">,</span>
                                    <span class="n">sim_ber</span><span class="o">.</span><span class="n">CALLBACK_NEXT_SNR</span><span class="p">):</span>
                        <span class="c1"># stop runtime timer</span>
                        <span class="n">runtime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">runtime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span> <span class="c1"># change internal status for summary</span>
                        <span class="k">break</span> <span class="c1"># stop for this SNR point have been simulated</span>

                <span class="c1"># print progress summary</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="c1"># print summary header during first iteration</span>
                    <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">iter_count</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="n">_print_progress</span><span class="p">(</span><span class="n">is_final</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                        <span class="n">rt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                        <span class="n">idx_snr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                        <span class="n">idx_it</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                        <span class="n">header_text</span><span class="o">=</span><span class="n">header_text</span><span class="p">)</span>
                        <span class="c1"># print seperator after headline</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">135</span><span class="p">)</span>

                    <span class="c1"># evaluate current runtime</span>
                    <span class="n">rt</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">runtime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="c1"># print current progress</span>
                    <span class="n">_print_progress</span><span class="p">(</span><span class="n">is_final</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">idx_snr</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">idx_it</span><span class="o">=</span><span class="n">ii</span><span class="p">,</span> <span class="n">rt</span><span class="o">=</span><span class="n">rt</span><span class="p">)</span>

                <span class="c1"># bit-error based stopping cond.</span>
                <span class="k">if</span> <span class="n">num_target_bit_errors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">tf</span><span class="o">.</span><span class="n">greater_equal</span><span class="p">(</span><span class="n">bit_errors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">num_target_bit_errors</span><span class="p">):</span>
                        <span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># change internal status for summary</span>
                        <span class="c1"># stop runtime timer</span>
                        <span class="n">runtime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">runtime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="k">break</span> <span class="c1"># enough errors for SNR point have been simulated</span>

                <span class="c1"># block-error based stopping cond.</span>
                <span class="k">if</span> <span class="n">num_target_block_errors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">tf</span><span class="o">.</span><span class="n">greater_equal</span><span class="p">(</span><span class="n">block_errors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                        <span class="n">num_target_block_errors</span><span class="p">):</span>
                        <span class="c1"># stop runtime timer</span>
                        <span class="n">runtime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">runtime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># change internal status for summary</span>
                        <span class="k">break</span> <span class="c1"># enough errors for SNR point have been simulated</span>

                <span class="c1"># max iter have been reached -&gt; continue with next SNR point</span>
                <span class="k">if</span> <span class="n">iter_count</span><span class="o">==</span><span class="n">max_mc_iter</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="c1"># all iterations are done</span>
                    <span class="c1"># stop runtime timer</span>
                    <span class="n">runtime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">runtime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># change internal status for summary</span>

            <span class="c1"># print results again AFTER last iteration / early stop (new status)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="n">_print_progress</span><span class="p">(</span><span class="n">is_final</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">idx_snr</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                                <span class="n">idx_it</span><span class="o">=</span><span class="n">iter_count</span><span class="p">,</span>
                                <span class="n">rt</span><span class="o">=</span><span class="n">runtime</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="c1"># early stop if no error occurred or target_ber/target_bler reached</span>
            <span class="k">if</span> <span class="n">early_stop</span><span class="p">:</span> <span class="c1"># only if early stop is active</span>
                <span class="k">if</span> <span class="n">block_errors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># change internal status for summary</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Simulation stopped as no error occurred &quot;</span> \
                              <span class="sa">f</span><span class="s2">&quot;@ EbNo = </span><span class="si">{</span><span class="n">ebno_dbs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> dB.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">break</span>

                <span class="c1"># check for target_ber / target_bler</span>
                <span class="n">ber_true</span> <span class="o">=</span>  <span class="n">bit_errors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">nb_bits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">bler_true</span> <span class="o">=</span> <span class="n">block_errors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">nb_blocks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">ber_true</span> <span class="o">&lt;</span><span class="n">target_ber</span><span class="p">:</span>
                    <span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># change internal status for summary</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Simulation stopped as target BER is reached&quot;</span> \
                              <span class="sa">f</span><span class="s2">&quot;@ EbNo = </span><span class="si">{</span><span class="n">ebno_dbs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> dB.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="k">if</span> <span class="n">bler_true</span> <span class="o">&lt;</span><span class="n">target_bler</span><span class="p">:</span>
                    <span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span> <span class="c1"># change internal status for summary</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Simulation stopped as target BLER is &quot;</span> \
                              <span class="sa">f</span><span class="s2">&quot;reached @ EbNo = </span><span class="si">{</span><span class="n">ebno_dbs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> &quot;</span> \
                              <span class="s2">&quot;dB.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">break</span>

            <span class="c1"># allow callback to end the entire simulation</span>
            <span class="k">if</span> <span class="n">cb_state</span> <span class="ow">is</span> <span class="n">sim_ber</span><span class="o">.</span><span class="n">CALLBACK_STOP</span><span class="p">:</span>
                <span class="c1"># stop runtime timer</span>
                <span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span> <span class="c1"># change internal status for summary</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Simulation stopped by callback function &quot;</span> \
                          <span class="sa">f</span><span class="s2">&quot;@ EbNo = </span><span class="si">{</span><span class="n">ebno_dbs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> dB.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">break</span>

    <span class="c1"># Stop if KeyboardInterrupt is detected and set remaining SNR points to -1</span>
    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

        <span class="c1"># Raise Interrupt again to stop outer loops</span>
        <span class="k">if</span> <span class="n">forward_keyboard_interrupt</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">e</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Simulation stopped by the user &quot;</span> \
              <span class="sa">f</span><span class="s2">&quot;@ EbNo = </span><span class="si">{</span><span class="n">ebno_dbs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="si">}</span><span class="s2"> dB.&quot;</span><span class="p">)</span>
        <span class="c1"># overwrite remaining BER / BLER positions with -1</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_points</span><span class="p">):</span>
            <span class="n">bit_errors</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">tensor_scatter_nd_update</span><span class="p">(</span> <span class="n">bit_errors</span><span class="p">,</span> <span class="p">[[</span><span class="n">idx</span><span class="p">]],</span>
                                                    <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">))</span>
            <span class="n">block_errors</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">tensor_scatter_nd_update</span><span class="p">(</span> <span class="n">block_errors</span><span class="p">,</span> <span class="p">[[</span><span class="n">idx</span><span class="p">]],</span>
                                                    <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">))</span>
            <span class="n">nb_bits</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">tensor_scatter_nd_update</span><span class="p">(</span> <span class="n">nb_bits</span><span class="p">,</span> <span class="p">[[</span><span class="n">idx</span><span class="p">]],</span>
                                                    <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">))</span>
            <span class="n">nb_blocks</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">tensor_scatter_nd_update</span><span class="p">(</span> <span class="n">nb_blocks</span><span class="p">,</span> <span class="p">[[</span><span class="n">idx</span><span class="p">]],</span>
                                                    <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">))</span>

    <span class="c1"># calculate BER / BLER</span>
    <span class="n">ber</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">bit_errors</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">/</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">nb_bits</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">bler</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">block_errors</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">/</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">nb_blocks</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

    <span class="c1"># replace nans (from early stop)</span>
    <span class="n">ber</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">is_nan</span><span class="p">(</span><span class="n">ber</span><span class="p">),</span> <span class="n">tf</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">ber</span><span class="p">),</span> <span class="n">ber</span><span class="p">)</span>
    <span class="n">bler</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">is_nan</span><span class="p">(</span><span class="n">bler</span><span class="p">),</span> <span class="n">tf</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">bler</span><span class="p">),</span> <span class="n">bler</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ber</span><span class="p">,</span> <span class="n">bler</span></div>


<span class="n">sim_ber</span><span class="o">.</span><span class="n">CALLBACK_CONTINUE</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">sim_ber</span><span class="o">.</span><span class="n">CALLBACK_STOP</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">sim_ber</span><span class="o">.</span><span class="n">CALLBACK_NEXT_SNR</span> <span class="o">=</span> <span class="mi">1</span>

<div class="viewcode-block" id="complex_normal">
<a class="viewcode-back" href="../../../api/utils.html#sionna.utils.complex_normal">[docs]</a>
<span class="k">def</span> <span class="nf">complex_normal</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">complex64</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Generates a tensor of complex normal random variables.</span>

<span class="sd">    Input</span>
<span class="sd">    -----</span>
<span class="sd">    shape : tf.shape, or list</span>
<span class="sd">        The desired shape.</span>

<span class="sd">    var : float</span>
<span class="sd">        The total variance., i.e., each complex dimension has</span>
<span class="sd">        variance ``var/2``.</span>

<span class="sd">    dtype: tf.complex</span>
<span class="sd">        The desired dtype. Defaults to `tf.complex64`.</span>

<span class="sd">    Output</span>
<span class="sd">    ------</span>
<span class="sd">    : ``shape``, ``dtype``</span>
<span class="sd">        Tensor of complex normal random variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Half the variance for each dimension</span>
    <span class="n">var_dim</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">dtype</span><span class="o">.</span><span class="n">real_dtype</span><span class="p">)</span><span class="o">/</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">.</span><span class="n">real_dtype</span><span class="p">)</span>
    <span class="n">stddev</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var_dim</span><span class="p">)</span>

    <span class="c1"># Generate complex Gaussian noise with the right variance</span>
    <span class="n">xr</span> <span class="o">=</span> <span class="n">sionna</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">tf_rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">stddev</span><span class="o">=</span><span class="n">stddev</span><span class="p">,</span>
                                     <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="o">.</span><span class="n">real_dtype</span><span class="p">)</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="n">sionna</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">tf_rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">stddev</span><span class="o">=</span><span class="n">stddev</span><span class="p">,</span>
                                     <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="o">.</span><span class="n">real_dtype</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">complex</span><span class="p">(</span><span class="n">xr</span><span class="p">,</span> <span class="n">xi</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span></div>


<span class="c1">###########################################################</span>
<span class="c1"># Deprecated aliases that will not be included in the next</span>
<span class="c1"># major release</span>
<span class="c1">###########################################################</span>

<span class="k">def</span> <span class="nf">fft</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span>  <span class="s2">&quot;Warning: The alias utils.fft will not be included in Sionna 1.0.&quot;</span>
            <span class="s2">&quot; Please use signal.fft instead.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">signal</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">ifft</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span>  <span class="s2">&quot;Warning: The alias utils.ifft will not be included in Sionna 1.0.&quot;</span>
            <span class="s2">&quot; Please use signal.ifft instead.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">signal</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">empirical_psd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">oversampling</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="mi">3</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span>  <span class="s2">&quot;Warning: The alias utils.empirical_psd will not be included in&quot;</span>
            <span class="s2">&quot; Sionna 1.0. Please use signal.empirical_psd instead.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">signal</span><span class="o">.</span><span class="n">empirical_psd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">show</span><span class="p">,</span> <span class="n">oversampling</span><span class="p">,</span> <span class="n">ylim</span><span class="p">)</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2024 NVIDIA CORPORATION.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>