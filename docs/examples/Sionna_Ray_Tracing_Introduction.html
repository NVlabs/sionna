<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Introduction to Sionna RT &mdash; Sionna 0.19.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
      <link rel="stylesheet" type="text/css" href="../_static/css/sionna.css?v=5c3194bc" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=6f83b549"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tutorial on Diffraction" href="Sionna_Ray_Tracing_Diffraction.html" />
    <link rel="prev" title="Using the DeepMIMO Dataset with Sionna" href="DeepMIMO.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Sionna
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#installation-using-pip">Installation using pip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#docker-based-installation">Docker-based Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#installation-from-source">Installation from source</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Hello_World.html">“Hello, world!”</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Discover_Sionna.html">Discover Sionna</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Discover_Sionna.html#Load-Required-Packages">Load Required Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="Discover_Sionna.html#Sionna-Data-flow-and-Design-Paradigms">Sionna Data-flow and Design Paradigms</a></li>
<li class="toctree-l2"><a class="reference internal" href="Discover_Sionna.html#A-note-on-random-number-generation">A note on random number generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Discover_Sionna.html#Let's-Get-Started---The-First-Layers-(Eager-Mode)">Let’s Get Started - The First Layers (<em>Eager Mode</em>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Discover_Sionna.html#Batches-and-Multi-dimensional-Tensors">Batches and Multi-dimensional Tensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="Discover_Sionna.html#First-Link-level-Simulation">First Link-level Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Discover_Sionna.html#Setting-up-the-End-to-end-Model">Setting up the End-to-end Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="Discover_Sionna.html#Run-some-Throughput-Tests-(Graph-Mode)">Run some Throughput Tests (Graph Mode)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Discover_Sionna.html#Bit-Error-Rate-(BER)-Monte-Carlo-Simulations">Bit-Error Rate (BER) Monte-Carlo Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Discover_Sionna.html#Conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#for-beginners">For Beginners</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Sionna_tutorial_part1.html">Part 1: Getting Started with Sionna</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part1.html#Imports-&amp;-Basics">Imports &amp; Basics</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part1.html#A-note-on-random-number-generation">A note on random number generation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part1.html#Sionna-Data-flow-and-Design-Paradigms">Sionna Data-flow and Design Paradigms</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part1.html#Hello,-Sionna!">Hello, Sionna!</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part1.html#Communication-Systems-as-Keras-Models">Communication Systems as Keras Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part1.html#Forward-Error-Correction-(FEC)">Forward Error Correction (FEC)</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part1.html#Eager-vs-Graph-Mode">Eager vs Graph Mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part1.html#Exercise">Exercise</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Sionna_tutorial_part2.html">Part 2: Differentiable Communication Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part2.html#Imports">Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part2.html#Gradient-Computation-Through-End-to-end-Systems">Gradient Computation Through End-to-end Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part2.html#Creating-Custom-Layers">Creating Custom Layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part2.html#Setting-up-Training-Loops">Setting up Training Loops</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Sionna_tutorial_part3.html">Part 3: Advanced Link-level Simulations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part3.html#Imports">Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part3.html#OFDM-Resource-Grid-and-Stream-Management">OFDM Resource Grid and Stream Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part3.html#Antenna-Arrays">Antenna Arrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part3.html#Channel-Model">Channel Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part3.html#Uplink-Transmission-in-the-Frequency-Domain">Uplink Transmission in the Frequency Domain</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Sionna_tutorial_part4.html">Part 4: Toward Learned Receivers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part4.html#Imports">Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part4.html#Simulation-Parameters">Simulation Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part4.html#Implemention-of-an-Advanced-Neural-Receiver">Implemention of an Advanced Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part4.html#Training-the-Neural-Receiver">Training the Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part4.html#Benchmarking-the-Neural-Receiver">Benchmarking the Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part4.html#Conclusion">Conclusion</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_tutorial_part4.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Simple_MIMO_Simulation.html">Basic MIMO Simulations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Simple_MIMO_Simulation.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="Simple_MIMO_Simulation.html#Simple-uncoded-transmission">Simple uncoded transmission</a></li>
<li class="toctree-l4"><a class="reference internal" href="Simple_MIMO_Simulation.html#Extension-to-channel-coding">Extension to channel coding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Pulse_shaping_basics.html">Pulse-shaping Basics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Pulse_shaping_basics.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="Pulse_shaping_basics.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="Pulse_shaping_basics.html#Pulse-shaping-of-a-sequence-of-QAM-symbols">Pulse-shaping of a sequence of QAM symbols</a></li>
<li class="toctree-l4"><a class="reference internal" href="Pulse_shaping_basics.html#Recovering-the-QAM-symbols-through-matched-filtering-and-downsampling">Recovering the QAM symbols through matched filtering and downsampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="Pulse_shaping_basics.html#Investigating-the-ACLR">Investigating the ACLR</a></li>
<li class="toctree-l4"><a class="reference internal" href="Pulse_shaping_basics.html#Windowing">Windowing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Optical_Lumped_Amplification_Channel.html">Optical Channel with Lumped Amplification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Optical_Lumped_Amplification_Channel.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="Optical_Lumped_Amplification_Channel.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="Optical_Lumped_Amplification_Channel.html#Impulse-Generation">Impulse Generation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Optical_Lumped_Amplification_Channel.html#Attenuation">Attenuation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Optical_Lumped_Amplification_Channel.html#Amplified-Spontaneous-Emission-Noise">Amplified Spontaneous Emission Noise</a></li>
<li class="toctree-l4"><a class="reference internal" href="Optical_Lumped_Amplification_Channel.html#Chromatic-Dispersion">Chromatic Dispersion</a></li>
<li class="toctree-l4"><a class="reference internal" href="Optical_Lumped_Amplification_Channel.html#Kerr-Nonlinearity">Kerr Nonlinearity</a></li>
<li class="toctree-l4"><a class="reference internal" href="Optical_Lumped_Amplification_Channel.html#Split-Step-Fourier-Method">Split-Step Fourier Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="Optical_Lumped_Amplification_Channel.html#References">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#for-experts">For Experts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="5G_Channel_Coding_Polar_vs_LDPC_Codes.html">5G Channel Coding and Rate-Matching: Polar vs. LDPC Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="5G_Channel_Coding_Polar_vs_LDPC_Codes.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="5G_Channel_Coding_Polar_vs_LDPC_Codes.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="5G_Channel_Coding_Polar_vs_LDPC_Codes.html#BER-Performance-of-5G-Coding-Schemes">BER Performance of 5G Coding Schemes</a></li>
<li class="toctree-l4"><a class="reference internal" href="5G_Channel_Coding_Polar_vs_LDPC_Codes.html#A-Deeper-Look-into-the-Polar-Code-Module">A Deeper Look into the Polar Code Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="5G_Channel_Coding_Polar_vs_LDPC_Codes.html#Rate-Matching-and-Rate-Recovery">Rate-Matching and Rate-Recovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="5G_Channel_Coding_Polar_vs_LDPC_Codes.html#Throughput-and-Decoding-Complexity">Throughput and Decoding Complexity</a></li>
<li class="toctree-l4"><a class="reference internal" href="5G_Channel_Coding_Polar_vs_LDPC_Codes.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="5G_NR_PUSCH.html">5G NR PUSCH Tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="5G_NR_PUSCH.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="5G_NR_PUSCH.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="5G_NR_PUSCH.html#A-Hello-World-Example">A Hello World Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="5G_NR_PUSCH.html#Carrier-Configuration">Carrier Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="5G_NR_PUSCH.html#Understanding-the-DMRS-Configuration">Understanding the DMRS Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="5G_NR_PUSCH.html#Transport-Blocks-and-MCS">Transport Blocks and MCS</a></li>
<li class="toctree-l4"><a class="reference internal" href="5G_NR_PUSCH.html#Looking-into-the-PUSCHTransmitter">Looking into the PUSCHTransmitter</a></li>
<li class="toctree-l4"><a class="reference internal" href="5G_NR_PUSCH.html#Components-of-the-PUSCHReceiver">Components of the PUSCHReceiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="5G_NR_PUSCH.html#End-to-end-PUSCH-Simulations">End-to-end PUSCH Simulations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Bit_Interleaved_Coded_Modulation.html">Bit-Interleaved Coded Modulation (BICM)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Bit_Interleaved_Coded_Modulation.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="Bit_Interleaved_Coded_Modulation.html#System-Block-Diagram">System Block Diagram</a></li>
<li class="toctree-l4"><a class="reference internal" href="Bit_Interleaved_Coded_Modulation.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="Bit_Interleaved_Coded_Modulation.html#A-Simple-BICM-System">A Simple BICM System</a></li>
<li class="toctree-l4"><a class="reference internal" href="Bit_Interleaved_Coded_Modulation.html#All-zero-Codeword-Simulations">All-zero Codeword Simulations</a></li>
<li class="toctree-l4"><a class="reference internal" href="Bit_Interleaved_Coded_Modulation.html#EXIT-Charts">EXIT Charts</a></li>
<li class="toctree-l4"><a class="reference internal" href="Bit_Interleaved_Coded_Modulation.html#Mismatched-Demapping-and-the-Advantages-of-Min-sum-Decoding">Mismatched Demapping and the Advantages of Min-sum Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="Bit_Interleaved_Coded_Modulation.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="MIMO_OFDM_Transmissions_over_CDL.html">MIMO OFDM Transmissions over the CDL Channel Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="MIMO_OFDM_Transmissions_over_CDL.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="MIMO_OFDM_Transmissions_over_CDL.html#System-Setup">System Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="MIMO_OFDM_Transmissions_over_CDL.html#Simulations">Simulations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Neural_Receiver.html">Neural Receiver for OFDM SIMO Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Neural_Receiver.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="Neural_Receiver.html#Simulation-Parameters">Simulation Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="Neural_Receiver.html#Neural-Receiver">Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="Neural_Receiver.html#End-to-end-System">End-to-end System</a></li>
<li class="toctree-l4"><a class="reference internal" href="Neural_Receiver.html#End-to-end-System-as-a-Keras-Model">End-to-end System as a Keras Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="Neural_Receiver.html#Evaluation-of-the-Baselines">Evaluation of the Baselines</a></li>
<li class="toctree-l4"><a class="reference internal" href="Neural_Receiver.html#Training-the-Neural-Receiver">Training the Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="Neural_Receiver.html#Evaluation-of-the-Neural-Receiver">Evaluation of the Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="Neural_Receiver.html#Pre-computed-Results">Pre-computed Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="Neural_Receiver.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Realistic_Multiuser_MIMO_Simulations.html">Realistic Multiuser MIMO OFDM Simulations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Realistic_Multiuser_MIMO_Simulations.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="Realistic_Multiuser_MIMO_Simulations.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="Realistic_Multiuser_MIMO_Simulations.html#System-Setup">System Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="Realistic_Multiuser_MIMO_Simulations.html#Uplink-Transmissions-in-the-Frequency-Domain">Uplink Transmissions in the Frequency Domain</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="OFDM_MIMO_Detection.html">OFDM MIMO Channel Estimation and Detection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="OFDM_MIMO_Detection.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="OFDM_MIMO_Detection.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="OFDM_MIMO_Detection.html#Simulation-parameters">Simulation parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="OFDM_MIMO_Detection.html#Estimation-of-the-channel-time,-frequency,-and-spatial-covariance-matrices">Estimation of the channel time, frequency, and spatial covariance matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="OFDM_MIMO_Detection.html#Loading-the-channel-covariance-matrices">Loading the channel covariance matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="OFDM_MIMO_Detection.html#Comparison-of-OFDM-estimators">Comparison of OFDM estimators</a></li>
<li class="toctree-l4"><a class="reference internal" href="OFDM_MIMO_Detection.html#Comparison-of-MIMO-detectors">Comparison of MIMO detectors</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Introduction_to_Iterative_Detection_and_Decoding.html">Introduction to Iterative Detection and Decoding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Introduction_to_Iterative_Detection_and_Decoding.html#Iterative-Detection-and-Decoding">Iterative Detection and Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="Introduction_to_Iterative_Detection_and_Decoding.html#Table-of-contents">Table of contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="Introduction_to_Iterative_Detection_and_Decoding.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="Introduction_to_Iterative_Detection_and_Decoding.html#Simulation-Parameters">Simulation Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="Introduction_to_Iterative_Detection_and_Decoding.html#Setting-up-the-Keras-Models">Setting-up the Keras Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="Introduction_to_Iterative_Detection_and_Decoding.html#Non-IDD-versus-IDD-Benchmarks">Non-IDD versus IDD Benchmarks</a></li>
<li class="toctree-l4"><a class="reference internal" href="Introduction_to_Iterative_Detection_and_Decoding.html#Discussion-Optimizing-IDD-with-Machine-Learning">Discussion-Optimizing IDD with Machine Learning</a></li>
<li class="toctree-l4"><a class="reference internal" href="Introduction_to_Iterative_Detection_and_Decoding.html#Comments">Comments</a></li>
<li class="toctree-l4"><a class="reference internal" href="Introduction_to_Iterative_Detection_and_Decoding.html#List-of-References">List of References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Autoencoder.html">End-to-end Learning with Autoencoders</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Autoencoder.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="Autoencoder.html#Simulation-Parameters">Simulation Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="Autoencoder.html#Neural-Demapper">Neural Demapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="Autoencoder.html#Trainable-End-to-end-System:-Conventional-Training">Trainable End-to-end System: Conventional Training</a></li>
<li class="toctree-l4"><a class="reference internal" href="Autoencoder.html#Trainable-End-to-end-System:-RL-based-Training">Trainable End-to-end System: RL-based Training</a></li>
<li class="toctree-l4"><a class="reference internal" href="Autoencoder.html#Evaluation">Evaluation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Autoencoder.html#Visualizing-the-Learned-Constellations">Visualizing the Learned Constellations</a></li>
<li class="toctree-l4"><a class="reference internal" href="Autoencoder.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Weighted_BP_Algorithm.html">Weighted Belief Propagation Decoding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Weighted_BP_Algorithm.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="Weighted_BP_Algorithm.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="Weighted_BP_Algorithm.html#Weighted-BP-for-BCH-Codes">Weighted BP for BCH Codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="Weighted_BP_Algorithm.html#Further-Experiments">Further Experiments</a></li>
<li class="toctree-l4"><a class="reference internal" href="Weighted_BP_Algorithm.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="CIR_Dataset.html">Channel Models from Datasets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="CIR_Dataset.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="CIR_Dataset.html#Simulation-Parameters">Simulation Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="CIR_Dataset.html#Creating-a-Simple-Dataset">Creating a Simple Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="CIR_Dataset.html#Generators">Generators</a></li>
<li class="toctree-l4"><a class="reference internal" href="CIR_Dataset.html#Use-the-Channel-Model-for-OFDM-Transmissions">Use the Channel Model for OFDM Transmissions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="DeepMIMO.html">Using the DeepMIMO Dataset with Sionna</a><ul>
<li class="toctree-l4"><a class="reference internal" href="DeepMIMO.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="DeepMIMO.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="DeepMIMO.html#Configuration-of-DeepMIMO">Configuration of DeepMIMO</a></li>
<li class="toctree-l4"><a class="reference internal" href="DeepMIMO.html#Using-DeepMIMO-with-Sionna">Using DeepMIMO with Sionna</a></li>
<li class="toctree-l4"><a class="reference internal" href="DeepMIMO.html#Link-level-Simulations-using-Sionna-and-DeepMIMO">Link-level Simulations using Sionna and DeepMIMO</a></li>
<li class="toctree-l4"><a class="reference internal" href="DeepMIMO.html#DeepMIMO-License-and-Citation">DeepMIMO License and Citation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../tutorials.html#ray-tracing">Ray Tracing</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Introduction to Sionna RT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Background-Information">Background Information</a></li>
<li class="toctree-l4"><a class="reference internal" href="#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Loading-Scenes">Loading Scenes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Ray-Tracing-for-Radio-Propagation">Ray Tracing for Radio Propagation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#From-Paths-to-Channel-Impulse-Responses">From Paths to Channel Impulse Responses</a></li>
<li class="toctree-l4"><a class="reference internal" href="#BER-Evaluation">BER Evaluation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Runtime-vs-Depth">Runtime vs Depth</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Coverage-Map">Coverage Map</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Site-specifc-Link-Level-Simulations">Site-specifc Link-Level Simulations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Conclusion-and-Outlook">Conclusion and Outlook</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Sionna_Ray_Tracing_Diffraction.html">Tutorial on Diffraction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Diffraction.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Diffraction.html#Background-Information">Background Information</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Diffraction.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Diffraction.html#Experiments-with-a-Simple-Wedge">Experiments with a Simple Wedge</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Diffraction.html#Coverage-Maps-with-Diffraction">Coverage Maps with Diffraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Diffraction.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Sionna_Ray_Tracing_Scattering.html">Tutorial on Scattering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Scattering.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Scattering.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Scattering.html#Scattering-Basics">Scattering Basics</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Scattering.html#Scattering-Patterns">Scattering Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Scattering.html#Validation-Against-the-%22Far%22-Wall-Approximation">Validation Against the “Far”-Wall Approximation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Scattering.html#Coverage-Maps-With-Scattering">Coverage Maps With Scattering</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Scattering.html#Impact-on-Channel-Impulse-Response">Impact on Channel Impulse Response</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Scattering.html#Summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Scattering.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Sionna_Ray_Tracing_Mobility.html">Mobility in Sionna RT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Mobility.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Mobility.html#Background-Information">Background Information</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Mobility.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Mobility.html#Controlling-Position-and-Orientation-of-Scene-Objects">Controlling Position and Orientation of Scene Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Mobility.html#Time-Evolution-of-Channels-Via-Doppler-Shift">Time Evolution of Channels Via Doppler Shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Mobility.html#Comparison-of-Doppler--vs-Position-based-Time-Evolution">Comparison of Doppler- vs Position-based Time Evolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Mobility.html#Summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Sionna_Ray_Tracing_RIS.html">Tutorial on Reconfigurable Intelligent Surfaces (RIS)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_RIS.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_RIS.html#Background-Information">Background Information</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_RIS.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_RIS.html#Reproducing-Results-from-the-Literature">Reproducing Results from the Literature</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_RIS.html#RIS-with-Multiple-Reradiation-Modes">RIS with Multiple Reradiation Modes</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_RIS.html#Coverage-Enhancement-with-RIS">Coverage Enhancement with RIS</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_RIS.html#Gradient-Based-RIS-Optimization">Gradient-Based RIS Optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_RIS.html#Summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_RIS.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Sionna_Ray_Tracing_Coverage_Map.html">Tutorial on Coverage Maps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Coverage_Map.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Coverage_Map.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Coverage_Map.html#Understanding-coverage-maps">Understanding coverage maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Coverage_Map.html#Coverage-map-for-a-realistic-scene">Coverage map for a realistic scene</a></li>
<li class="toctree-l4"><a class="reference internal" href="Sionna_Ray_Tracing_Coverage_Map.html#Conclusions">Conclusions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../made_with_sionna.html">“Made with Sionna”</a></li>
<li class="toctree-l1"><a class="reference internal" href="../em_primer.html">Primer on Electromagnetics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../em_primer.html#coordinate-system-rotations-and-vector-fields">Coordinate system, rotations, and vector fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../em_primer.html#planar-time-harmonic-waves">Planar Time-Harmonic Waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../em_primer.html#far-field-of-a-transmitting-antenna">Far Field of a Transmitting Antenna</a></li>
<li class="toctree-l2"><a class="reference internal" href="../em_primer.html#modelling-of-a-receiving-antenna">Modelling of a Receiving Antenna</a></li>
<li class="toctree-l2"><a class="reference internal" href="../em_primer.html#general-propagation-path">General Propagation Path</a></li>
<li class="toctree-l2"><a class="reference internal" href="../em_primer.html#frequency-impulse-response">Frequency &amp; Impulse Response</a></li>
<li class="toctree-l2"><a class="reference internal" href="../em_primer.html#reflection-and-refraction">Reflection and Refraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../em_primer.html#diffraction">Diffraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../em_primer.html#scattering">Scattering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../em_primer.html#reconfigurable-intelligent-surfaces-ris">Reconfigurable Intelligent Surfaces (RIS)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/sionna.html">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/fec.html">Forward Error Correction (FEC)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/fec.linear.html">Linear Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.linear.html#encoder">Encoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.linear.html#decoder">Decoder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/fec.ldpc.html">Low-Density Parity-Check (LDPC)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.ldpc.html#ldpc-encoder">LDPC Encoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.ldpc.html#ldpc-decoder">LDPC Decoder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/fec.polar.html">Polar Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.polar.html#polar-encoding">Polar Encoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.polar.html#polar-decoding">Polar Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.polar.html#polar-utility-functions">Polar Utility Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/fec.conv.html">Convolutional Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.conv.html#convolutional-encoding">Convolutional Encoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.conv.html#viterbi-decoding">Viterbi Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.conv.html#bcjr-decoding">BCJR Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.conv.html#convolutional-code-utility-functions">Convolutional Code Utility Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/fec.turbo.html">Turbo Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.turbo.html#turbo-encoding">Turbo Encoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.turbo.html#turbo-decoding">Turbo Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.turbo.html#turbo-utility-functions">Turbo Utility Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/fec.crc.html">Cyclic Redundancy Check (CRC)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.crc.html#crcencoder">CRCEncoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.crc.html#crcdecoder">CRCDecoder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/fec.interleaving.html">Interleaving</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.interleaving.html#interleaver">Interleaver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.interleaving.html#deinterleaver">Deinterleaver</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/fec.scrambling.html">Scrambling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.scrambling.html#scrambler">Scrambler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.scrambling.html#tb5gscrambler">TB5GScrambler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.scrambling.html#descrambler">Descrambler</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/fec.utils.html">Utility Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.utils.html#binary-linear-codes">(Binary) Linear Codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.utils.html#exit-analysis">EXIT Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/fec.utils.html#miscellaneous">Miscellaneous</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/mapping.html">Mapping</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/mapping.html#constellations">Constellations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/mapping.html#constellation">Constellation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mapping.html#qam">qam</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mapping.html#pam">pam</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mapping.html#pam-gray">pam_gray</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/mapping.html#mapper">Mapper</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/mapping.html#sionna.mapping.Mapper"><code class="docutils literal notranslate"><span class="pre">Mapper</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/mapping.html#demapping">Demapping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/mapping.html#demapper">Demapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mapping.html#demapperwithprior">DemapperWithPrior</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mapping.html#symboldemapper">SymbolDemapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mapping.html#symboldemapperwithprior">SymbolDemapperWithPrior</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/mapping.html#utility-functions">Utility Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/mapping.html#symbollogits2llrs">SymbolLogits2LLRs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mapping.html#llrs2symbollogits">LLRs2SymbolLogits</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mapping.html#symbollogits2llrswithprior">SymbolLogits2LLRsWithPrior</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mapping.html#symbollogits2moments">SymbolLogits2Moments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mapping.html#symbolinds2bits">SymbolInds2Bits</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mapping.html#pam2qam">PAM2QAM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mapping.html#qam2pam">QAM2PAM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/channel.html">Channel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/channel.wireless.html">Wireless</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/channel.wireless.html#awgn">AWGN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/channel.wireless.html#flat-fading-channel">Flat-fading channel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/channel.wireless.html#channel-model-interface">Channel model interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/channel.wireless.html#time-domain-channel">Time domain channel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/channel.wireless.html#channel-with-ofdm-waveform">Channel with OFDM waveform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/channel.wireless.html#rayleigh-block-fading">Rayleigh block fading</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/channel.wireless.html#gpp-38-901-channel-models">3GPP 38.901 channel models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/channel.wireless.html#external-datasets">External datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/channel.wireless.html#utility-functions">Utility functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/channel.optical.html">Optical</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/channel.optical.html#split-step-fourier-method">Split-step Fourier method</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/channel.optical.html#erbium-doped-fiber-amplifier">Erbium-doped fiber amplifier</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/channel.optical.html#utility-functions">Utility functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/channel.discrete.html">Discrete</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/channel.discrete.html#binarymemorylesschannel">BinaryMemorylessChannel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/channel.discrete.html#binarysymmetricchannel">BinarySymmetricChannel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/channel.discrete.html#binaryerasurechannel">BinaryErasureChannel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/channel.discrete.html#binaryzchannel">BinaryZChannel</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/ofdm.html">Orthogonal Frequency-Division Multiplexing (OFDM)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/ofdm.html#resource-grid">Resource Grid</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#resourcegrid">ResourceGrid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#resourcegridmapper">ResourceGridMapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#resourcegriddemapper">ResourceGridDemapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#removenulledsubcarriers">RemoveNulledSubcarriers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/ofdm.html#modulation-demodulation">Modulation &amp; Demodulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#ofdmmodulator">OFDMModulator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#ofdmdemodulator">OFDMDemodulator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/ofdm.html#pilot-pattern">Pilot Pattern</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#pilotpattern">PilotPattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#emptypilotpattern">EmptyPilotPattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#kroneckerpilotpattern">KroneckerPilotPattern</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/ofdm.html#channel-estimation">Channel Estimation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#basechannelestimator">BaseChannelEstimator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#basechannelinterpolator">BaseChannelInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#lschannelestimator">LSChannelEstimator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#linearinterpolator">LinearInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#lmmseinterpolator">LMMSEInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#nearestneighborinterpolator">NearestNeighborInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#tdl-time-cov-mat">tdl_time_cov_mat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#tdl-freq-cov-mat">tdl_freq_cov_mat</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/ofdm.html#precoding">Precoding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#zfprecoder">ZFPrecoder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/ofdm.html#equalization">Equalization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#ofdmequalizer">OFDMEqualizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#lmmseequalizer">LMMSEEqualizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#mfequalizer">MFEqualizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#zfequalizer">ZFEqualizer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/ofdm.html#detection">Detection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#ofdmdetector">OFDMDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#ofdmdetectorwithprior">OFDMDetectorWithPrior</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#epdetector">EPDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#kbestdetector">KBestDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#lineardetector">LinearDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#maximumlikelihooddetector">MaximumLikelihoodDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#maximumlikelihooddetectorwithprior">MaximumLikelihoodDetectorWithPrior</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/ofdm.html#mmsepicdetector">MMSEPICDetector</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/mimo.html">Multiple-Input Multiple-Output (MIMO)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/mimo.html#stream-management">Stream Management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#sionna.mimo.StreamManagement"><code class="docutils literal notranslate"><span class="pre">StreamManagement</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/mimo.html#precoding">Precoding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#zero-forcing-precoder">zero_forcing_precoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#grid-of-beams-dft-ula">grid_of_beams_dft_ula</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#grid-of-beams-dft">grid_of_beams_dft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#flatten-precoding-mat">flatten_precoding_mat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#normalize-precoding-power">normalize_precoding_power</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/mimo.html#equalization">Equalization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#lmmse-equalizer">lmmse_equalizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#mf-equalizer">mf_equalizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#zf-equalizer">zf_equalizer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/mimo.html#detection">Detection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#epdetector">EPDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#kbestdetector">KBestDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#lineardetector">LinearDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#maximumlikelihooddetector">MaximumLikelihoodDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#maximumlikelihooddetectorwithprior">MaximumLikelihoodDetectorWithPrior</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#mmse-pic">MMSE-PIC</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/mimo.html#utility-functions">Utility Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#list2llr">List2LLR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#list2llrsimple">List2LLRSimple</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#complex2real-vector">complex2real_vector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#real2complex-vector">real2complex_vector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#complex2real-matrix">complex2real_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#real2complex-matrix">real2complex_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#complex2real-covariance">complex2real_covariance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#real2complex-covariance">real2complex_covariance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#complex2real-channel">complex2real_channel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#real2complex-channel">real2complex_channel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/mimo.html#whiten-channel">whiten_channel</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/nr.html">5G NR</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/nr.html#carrier">Carrier</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/nr.html#carrierconfig">CarrierConfig</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/nr.html#layer-mapping">Layer Mapping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/nr.html#layermapper">LayerMapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/nr.html#layerdemapper">LayerDemapper</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/nr.html#pusch">PUSCH</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/nr.html#puschconfig">PUSCHConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/nr.html#puschdmrsconfig">PUSCHDMRSConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/nr.html#puschlschannelestimator">PUSCHLSChannelEstimator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/nr.html#puschpilotpattern">PUSCHPilotPattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/nr.html#puschprecoder">PUSCHPrecoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/nr.html#puschreceiver">PUSCHReceiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/nr.html#puschtransmitter">PUSCHTransmitter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/nr.html#transport-block">Transport Block</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/nr.html#tbconfig">TBConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/nr.html#tbencoder">TBEncoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/nr.html#tbdecoder">TBDecoder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/nr.html#utils">Utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/nr.html#calculate-tb-size">calculate_tb_size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/nr.html#generate-prng-seq">generate_prng_seq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/nr.html#select-mcs">select_mcs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/rt.html">Ray Tracing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/rt.html#scene">Scene</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#id1">Scene</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#compute-paths">compute_paths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#trace-paths">trace_paths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#compute-fields">compute_fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#coverage-map">coverage_map</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#preview">preview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#render">render</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#render-to-file">render_to_file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#load-scene">load_scene</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/rt.html#example-scenes">Example Scenes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#floor-wall">floor_wall</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#simple-street-canyon">simple_street_canyon</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#simple-street-canyon-with-cars">simple_street_canyon_with_cars</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#etoile">etoile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#munich">munich</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#simple-wedge">simple_wedge</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#simple-reflector">simple_reflector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#double-reflector">double_reflector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#triple-reflector">triple_reflector</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#box">Box</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/rt.html#paths">Paths</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#id13">Paths</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/rt.html#coverage-maps">Coverage Maps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#coveragemap">CoverageMap</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/rt.html#cameras">Cameras</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#camera">Camera</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/rt.html#scene-objects">Scene Objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#sceneobject">SceneObject</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/rt.html#radio-materials">Radio Materials</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#radiomaterial">RadioMaterial</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#scatteringpattern">ScatteringPattern</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/rt.html#radio-devices">Radio Devices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#transmitter">Transmitter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#receiver">Receiver</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/rt.html#antenna-arrays">Antenna Arrays</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#antennaarray">AntennaArray</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#planararray">PlanarArray</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/rt.html#antennas">Antennas</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#antenna">Antenna</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#compute-gain">compute_gain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#visualize">visualize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#dipole-pattern">dipole_pattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#hw-dipole-pattern">hw_dipole_pattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#iso-pattern">iso_pattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#tr38901-pattern">tr38901_pattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#polarization-model-1">polarization_model_1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#polarization-model-2">polarization_model_2</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/rt.html#reconfigurable-intelligent-surfaces-ris">Reconfigurable Intelligent Surfaces (RIS)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#ris">RIS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#phaseprofile">PhaseProfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#discretephaseprofile">DiscretePhaseProfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#amplitudeprofile">AmplitudeProfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#discreteamplitudeprofile">DiscreteAmplitudeProfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#profileinterpolator">ProfileInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#lagrangeprofileinterpolator">LagrangeProfileInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#cellgrid">CellGrid</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/rt.html#utility-functions">Utility Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#cross">cross</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#dot">dot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#outer">outer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#normalize">normalize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#phi-hat">phi_hat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#rotate">rotate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#rotation-matrix">rotation_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#rot-mat-from-unit-vecs">rot_mat_from_unit_vecs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#r-hat">r_hat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#sample-points-on-hemisphere">sample_points_on_hemisphere</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#theta-hat">theta_hat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#theta-phi-from-unit-vec">theta_phi_from_unit_vec</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#watt-to-dbm">watt_to_dbm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/rt.html#dbm-to-watt">dbm_to_watt</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/signal.html">Signal</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/signal.html#filters">Filters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/signal.html#sincfilter">SincFilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signal.html#raisedcosinefilter">RaisedCosineFilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signal.html#rootraisedcosinefilter">RootRaisedCosineFilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signal.html#customfilter">CustomFilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signal.html#id1">Filter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/signal.html#window-functions">Window functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/signal.html#hannwindow">HannWindow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signal.html#hammingwindow">HammingWindow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signal.html#blackmanwindow">BlackmanWindow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signal.html#customwindow">CustomWindow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signal.html#id2">Window</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/signal.html#utility-functions">Utility Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/signal.html#convolve">convolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signal.html#fft">fft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signal.html#ifft">ifft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signal.html#upsampling">Upsampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signal.html#downsampling">Downsampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signal.html#empirical-psd">empirical_psd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/signal.html#empirical-aclr">empirical_aclr</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/utils.html">Utility Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#metrics">Metrics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#biterrorrate">BitErrorRate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#bitwisemutualinformation">BitwiseMutualInformation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#compute-ber">compute_ber</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#compute-bler">compute_bler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#compute-ser">compute_ser</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#count-errors">count_errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#count-block-errors">count_block_errors</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#tensors">Tensors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#expand-to-rank">expand_to_rank</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#flatten-dims">flatten_dims</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#flatten-last-dims">flatten_last_dims</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#insert-dims">insert_dims</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#split-dims">split_dims</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#matrix-sqrt">matrix_sqrt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#matrix-sqrt-inv">matrix_sqrt_inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#matrix-inv">matrix_inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#matrix-pinv">matrix_pinv</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#miscellaneous">Miscellaneous</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#binarysource">BinarySource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#symbolsource">SymbolSource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#qamsource">QAMSource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#pamsource">PAMSource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#plotber">PlotBER</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#sim-ber">sim_ber</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#ebnodb2no">ebnodb2no</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#hard-decisions">hard_decisions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#plot-ber">plot_ber</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#complex-normal">complex_normal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#log2">log2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#log10">log10</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/config.html">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/config.html#sionna.config.Config"><code class="docutils literal notranslate"><span class="pre">Config</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/config.html#sionna.config.Config.np_rng"><code class="docutils literal notranslate"><span class="pre">Config.np_rng</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/config.html#sionna.config.Config.py_rng"><code class="docutils literal notranslate"><span class="pre">Config.py_rng</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/config.html#sionna.config.Config.seed"><code class="docutils literal notranslate"><span class="pre">Config.seed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/config.html#sionna.config.Config.tf_rng"><code class="docutils literal notranslate"><span class="pre">Config.tf_rng</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/config.html#sionna.config.Config.xla_compat"><code class="docutils literal notranslate"><span class="pre">Config.xla_compat</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/NVlabs/sionna/discussions">Discussions</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/NVlabs/sionna/issues">Report an Issue</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Sionna</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../tutorials.html">Tutorials</a></li>
      <li class="breadcrumb-item active">Introduction to Sionna RT</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <style>h3 {display: block !important}</style>
<div style="margin-bottom:15px;">
    <table>
        <td style="padding: 0px 0px;">
            <a href=" https://colab.research.google.com/github/NVlabs/sionna/blob/main/examples/Sionna_Ray_Tracing_Introduction.ipynb" style="vertical-align:text-bottom">
                <img alt="Colab logo" src="../_static/colab_logo.svg" style="width: 40px; min-width: 40px">
            </a>
        </td>
        <td style="padding: 4px 0px;">
            <a href=" https://colab.research.google.com/github/nvlabs/sionna/blob/main/examples/Sionna_Ray_Tracing_Introduction.ipynb" style="vertical-align:text-bottom">
                Run in Google Colab
            </a>
        </td>

        <td style="padding: 0px 15px;">
        </td>

        <td class="wy-breadcrumbs-aside" style="padding: 0 30px;">
            <a href="https://github.com/nvlabs/sionna/blob/main/examples/Sionna_Ray_Tracing_Introduction.ipynb" style="vertical-align:text-bottom">
                <i class="fa fa-github" style="font-size:24px;"></i>
                View on GitHub
            </a>
        </td>

        <td class="wy-breadcrumbs-aside" style="padding: 0 35px;">
            <a href="../examples/Sionna_Ray_Tracing_Introduction.ipynb" download target="_blank" style="vertical-align:text-bottom">
                <i class="fa fa-download" style="font-size:24px;"></i>
                Download notebook
            </a>

        </td>
    </table>

</div><section id="Introduction-to-Sionna-RT">
<h1>Introduction to Sionna RT<a class="headerlink" href="#Introduction-to-Sionna-RT" title="Link to this heading"></a></h1>
<p>In this notebook, you will</p>
<ul class="simple">
<li><p>Discover the basic functionalities of Sionna’s <a class="reference external" href="https://nvlabs.github.io/sionna/api/rt.html">ray tracing (RT) module</a></p></li>
<li><p>Learn how to compute coverage maps</p></li>
<li><p>Use ray-traced channels for link-level simulations instead of stochastic channel models</p></li>
</ul>
<section id="Table-of-Contents">
<h2>Table of Contents<a class="headerlink" href="#Table-of-Contents" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#Background-Information"><span class="std std-ref">Background Information</span></a></p></li>
<li><p><a class="reference internal" href="#GPU-Configuration-and-Imports"><span class="std std-ref">GPU Configuration and Imports</span></a></p></li>
<li><p><a class="reference internal" href="#Loading-Scenes"><span class="std std-ref">Loading Scenes</span></a></p></li>
<li><p><a class="reference internal" href="#Ray-Tracing-for-Radio-Propagation"><span class="std std-ref">Ray Tracing for Radio Propagation</span></a></p></li>
<li><p><a class="reference internal" href="#From-Paths-to-Channel-Impulse-Responses"><span class="std std-ref">From Paths to Channel Impulse Responses</span></a></p></li>
<li><p><a class="reference internal" href="#BER-Evaluation"><span class="std std-ref">BER Evaluation</span></a></p></li>
<li><p><a class="reference internal" href="#Runtime-vs-Depth"><span class="std std-ref">Runtime vs Depth</span></a></p></li>
<li><p><a class="reference internal" href="#Coverage-Map"><span class="std std-ref">Coverage Map</span></a></p></li>
<li><p><a class="reference internal" href="#Site-specifc-Link-Level-Simulations"><span class="std std-ref">Site-specifc Link-Level Simulations</span></a></p></li>
<li><p><a class="reference internal" href="#Conclusion-and-Outlook"><span class="std std-ref">Conclusion and Outlook</span></a></p></li>
</ul>
</section>
<section id="Background-Information">
<h2>Background Information<a class="headerlink" href="#Background-Information" title="Link to this heading"></a></h2>
<p>Ray tracing is a technique to simulate environment-specific and physically accurate channel realizations for a given scene and user position. Please see the <a class="reference external" href="https://nvlabs.github.io/sionna/em_primer.html">EM Primer</a> for further details on the theoretical background of ray tracing of wireless channels.</p>
<p>Sionna RT is a ray tracing extension for radio propagation modeling which is built on top of <a class="reference external" href="https://www.mitsuba-renderer.org/">Mitsuba 3</a> and <a class="reference external" href="https://www.tensorflow.org/">TensorFlow</a>. Like all of Sionna’s components, it is differentiable.</p>
<p>Mitsuba 3 is a rendering system for forward and inverse light-transport simulation that makes use of the differentiable just-in-time compiler <a class="reference external" href="https://drjit.readthedocs.io/en/latest/">Dr.Jit</a>. Sionna RT relies on Mitsuba 3 for the rendering and handling of scenes, e.g., its XML-file format, as well as the computation of ray intersections with scene primitives, i.e., triangles forming a mesh. The transformations of the polarized field components at each point of interaction between a ray and a
scene object, e.g., reflection, are computed in TensorFlow, which is also used to combine the retained paths into (optionally) time-varying channel impulse responses. Thanks to TensorFlow’s automatic gradient computation, channel impulse responses and functions thereof are differentiable with respect to most parameters of the ray tracing process, including material properties (conductivity, permittivity), antenna patterns, orientations, and positions.</p>
<p>Scene files for Mitsuba 3 can be created, edited, and exported with the popular open-source 3D creation suite <a class="reference external" href="https://www.blender.org/">Blender</a> and the <a class="reference external" href="https://github.com/mitsuba-renderer/mitsuba-blender">Mitsuba-Blender add-on</a>. One can rapdily create scenes from almost any place in the world using <a class="reference external" href="https://www.openstreetmap.org/">OpenStreetMap</a> and the <a class="reference external" href="https://prochitecture.gumroad.com/l/blender-osm">Blender-OSM add-on</a>. In Sionna, scenes and radio propagation paths can be
either rendered through the lens of configurable cameras via ray tracing or displayed with an integrated 3D viewer. For more detail on scene creation and rendering, we refer to <a class="reference external" href="https://nvlabs.github.io/sionna/api/rt.html">Sionna’s API documentation</a> and the available <a class="reference external" href="https://youtu.be/7xHLDxUaQ7c">video tutorial</a>.</p>
</section>
<section id="GPU-Configuration-and-Imports">
<h2>GPU Configuration and Imports<a class="headerlink" href="#GPU-Configuration-and-Imports" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span> <span class="c1"># Configure which GPU</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CUDA_VISIBLE_DEVICES&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">gpu_num</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># Use &quot;&quot; to use the CPU</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_VISIBLE_DEVICES&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gpu_num</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;TF_CPP_MIN_LOG_LEVEL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;3&#39;</span>

<span class="c1"># Import Sionna</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">sionna</span>
<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="c1"># Install Sionna if package is not already installed</span>
    <span class="kn">import</span> <span class="nn">os</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;pip install sionna&quot;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">sionna</span>

<span class="c1"># Configure the notebook to use only a single GPU and allocate only as much memory as needed</span>
<span class="c1"># For more details, see https://www.tensorflow.org/guide/gpu</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="n">gpus</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">list_physical_devices</span><span class="p">(</span><span class="s1">&#39;GPU&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">gpus</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">set_memory_growth</span><span class="p">(</span><span class="n">gpus</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<span class="c1"># Avoid warnings from TensorFlow</span>
<span class="n">tf</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="s1">&#39;ERROR&#39;</span><span class="p">)</span>

<span class="c1"># Colab does currently not support the latest version of ipython.</span>
<span class="c1"># Thus, the preview does not work in Colab. However, whenever possible we</span>
<span class="c1"># strongly recommend to use the scene preview mode.</span>
<span class="k">try</span><span class="p">:</span> <span class="c1"># detect if the notebook runs in Colab</span>
    <span class="kn">import</span> <span class="nn">google.colab</span>
    <span class="n">no_preview</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># deactivate preview</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;SIONNA_NO_PREVIEW&quot;</span><span class="p">):</span>
        <span class="n">no_preview</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">no_preview</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">resolution</span> <span class="o">=</span> <span class="p">[</span><span class="mi">480</span><span class="p">,</span><span class="mi">320</span><span class="p">]</span> <span class="c1"># increase for higher quality of renderings</span>

<span class="c1"># Define magic cell command to skip a cell if needed</span>
<span class="kn">from</span> <span class="nn">IPython.core.magic</span> <span class="kn">import</span> <span class="n">register_cell_magic</span>
<span class="kn">from</span> <span class="nn">IPython</span> <span class="kn">import</span> <span class="n">get_ipython</span>

<span class="nd">@register_cell_magic</span>
<span class="k">def</span> <span class="nf">skip_if</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">eval</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
        <span class="k">return</span>
    <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>

<span class="c1"># Set random seed for reproducibility</span>
<span class="n">sionna</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># Import Sionna RT components</span>
<span class="kn">from</span> <span class="nn">sionna.rt</span> <span class="kn">import</span> <span class="n">load_scene</span><span class="p">,</span> <span class="n">Transmitter</span><span class="p">,</span> <span class="n">Receiver</span><span class="p">,</span> <span class="n">PlanarArray</span><span class="p">,</span> <span class="n">Camera</span>

<span class="c1"># For link-level simulations</span>
<span class="kn">from</span> <span class="nn">sionna.channel</span> <span class="kn">import</span> <span class="n">cir_to_ofdm_channel</span><span class="p">,</span> <span class="n">subcarrier_frequencies</span><span class="p">,</span> <span class="n">OFDMChannel</span><span class="p">,</span> <span class="n">ApplyOFDMChannel</span><span class="p">,</span> <span class="n">CIRDataset</span>
<span class="kn">from</span> <span class="nn">sionna.nr</span> <span class="kn">import</span> <span class="n">PUSCHConfig</span><span class="p">,</span> <span class="n">PUSCHTransmitter</span><span class="p">,</span> <span class="n">PUSCHReceiver</span>
<span class="kn">from</span> <span class="nn">sionna.utils</span> <span class="kn">import</span> <span class="n">compute_ber</span><span class="p">,</span> <span class="n">ebnodb2no</span><span class="p">,</span> <span class="n">PlotBER</span>
<span class="kn">from</span> <span class="nn">sionna.ofdm</span> <span class="kn">import</span> <span class="n">KBestDetector</span><span class="p">,</span> <span class="n">LinearDetector</span>
<span class="kn">from</span> <span class="nn">sionna.mimo</span> <span class="kn">import</span> <span class="n">StreamManagement</span>
</pre></div>
</div>
</div>
</section>
<section id="Loading-Scenes">
<h2>Loading Scenes<a class="headerlink" href="#Loading-Scenes" title="Link to this heading"></a></h2>
<p>The Sionna RT module can either load external scene files (in Mitsuba’s XML file format) or it can load one of the <a class="reference external" href="https://nvlabs.github.io/sionna/api/rt.html#example-scenes">integrated scenes</a>.</p>
<p>In this example, we load an example scene containing the area around the Frauenkirche in Munich, Germany.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load integrated scene</span>
<span class="n">scene</span> <span class="o">=</span> <span class="n">load_scene</span><span class="p">(</span><span class="n">sionna</span><span class="o">.</span><span class="n">rt</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">munich</span><span class="p">)</span> <span class="c1"># Try also sionna.rt.scene.etoile</span>
</pre></div>
</div>
</div>
<p>To visualize the scene, we can use the <code class="docutils literal notranslate"><span class="pre">preview</span></code> function which opens an interactive preview of the scene. This only works in Jupyter notebooks.</p>
<p>You can use the following controls:</p>
<ul class="simple">
<li><p>Mouse left: Rotate</p></li>
<li><p>Scroll wheel: Zoom</p></li>
<li><p>Mouse right: Move</p></li>
</ul>
<p>Please note that the preview does not work in Colab and is therefore deactivated when <code class="docutils literal notranslate"><span class="pre">colab_compat</span></code> is set to True. Further, only one preview instance can be open at the same time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Render scene</span>
<span class="k">if</span> <span class="n">no_preview</span><span class="p">:</span>
    <span class="n">scene</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">camera</span><span class="o">=</span><span class="s2">&quot;scene-cam-0&quot;</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">512</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Sionna_Ray_Tracing_Introduction_10_0.png" src="../_images/examples_Sionna_Ray_Tracing_Introduction_10_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">skip_if</span> no_preview
# Open 3D preview (only works in Jupyter notebook)
scene.preview()
</pre></div>
</div>
</div>
<p>It is often convenient to choose a viewpoint in the 3D preview prior to rendering it as a high-quality image. The next cell uses the “preview” camera which corresponds to the viewpoint of the current preview image.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The preview camera can be directly rendered as high-quality image</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">no_preview</span><span class="p">:</span>
    <span class="n">scene</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">camera</span><span class="o">=</span><span class="s2">&quot;preview&quot;</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">512</span><span class="p">);</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Function not available in Colab mode.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Function not available in Colab mode.
</pre></div></div>
</div>
<p>One can also render the image to a file as shown below:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">render_to_file</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># Set to True to render image to file</span>

<span class="c1"># Render scene to file from preview viewpoint</span>
<span class="k">if</span> <span class="n">render_to_file</span><span class="p">:</span>
    <span class="n">scene</span><span class="o">.</span><span class="n">render_to_file</span><span class="p">(</span><span class="n">camera</span><span class="o">=</span><span class="s2">&quot;scene-cam-0&quot;</span><span class="p">,</span> <span class="c1"># Also try camera=&quot;preview&quot;</span>
                         <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;scene.png&quot;</span><span class="p">,</span>
                         <span class="n">resolution</span><span class="o">=</span><span class="p">[</span><span class="mi">650</span><span class="p">,</span><span class="mi">500</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Instead of the preview camera, one can also specify dedicated cameras with different positions and <code class="docutils literal notranslate"><span class="pre">look_at</span></code> directions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create new camera with different configuration</span>
<span class="n">my_cam</span> <span class="o">=</span> <span class="n">Camera</span><span class="p">(</span><span class="s2">&quot;my_cam&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span><span class="mi">250</span><span class="p">,</span><span class="mi">150</span><span class="p">],</span> <span class="n">look_at</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">28</span><span class="p">])</span>
<span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">my_cam</span><span class="p">)</span>

<span class="c1"># Render scene with new camera*</span>
<span class="n">scene</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;my_cam&quot;</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">512</span><span class="p">);</span> <span class="c1"># Increase num_samples to increase image quality</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Sionna_Ray_Tracing_Introduction_17_0.png" src="../_images/examples_Sionna_Ray_Tracing_Introduction_17_0.png" />
</div>
</div>
<p>Note that each <a class="reference external" href="https://nvlabs.github.io/sionna/api/rt.html#scene-objects">SceneObject</a> (camera, transmitter,…) needs a unique name. Thus, running the cells above multiple times will lead to an error if the object name is not changed or the object is not removed from the scene.</p>
</section>
<section id="Ray-Tracing-for-Radio-Propagation">
<h2>Ray Tracing for Radio Propagation<a class="headerlink" href="#Ray-Tracing-for-Radio-Propagation" title="Link to this heading"></a></h2>
<p>We need to configure transmitters and receivers prior to computing propagation paths between them. All transmitters and all receivers are equipped with the same antenna arrays which are defined by the <code class="docutils literal notranslate"><span class="pre">scene</span></code> properties <code class="docutils literal notranslate"><span class="pre">scene.tx_array</span></code> and <code class="docutils literal notranslate"><span class="pre">scene.rx_array</span></code>, respectively. Antenna arrays are composed of multiple identical antennas. Antennas can have custom or pre-defined patterns and are either single- or dual-polarized. One can add multiple transmitters and receivers to a scene which need
to have unique names, a position, and orientation which is defined by yaw, pitch, and roll angles.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configure antenna array for all transmitters</span>
<span class="n">scene</span><span class="o">.</span><span class="n">tx_array</span> <span class="o">=</span> <span class="n">PlanarArray</span><span class="p">(</span><span class="n">num_rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                             <span class="n">num_cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                             <span class="n">vertical_spacing</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">horizontal_spacing</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;tr38901&quot;</span><span class="p">,</span>
                             <span class="n">polarization</span><span class="o">=</span><span class="s2">&quot;V&quot;</span><span class="p">)</span>

<span class="c1"># Configure antenna array for all receivers</span>
<span class="n">scene</span><span class="o">.</span><span class="n">rx_array</span> <span class="o">=</span> <span class="n">PlanarArray</span><span class="p">(</span><span class="n">num_rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                             <span class="n">num_cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                             <span class="n">vertical_spacing</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">horizontal_spacing</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;dipole&quot;</span><span class="p">,</span>
                             <span class="n">polarization</span><span class="o">=</span><span class="s2">&quot;cross&quot;</span><span class="p">)</span>

<span class="c1"># Create transmitter</span>
<span class="n">tx</span> <span class="o">=</span> <span class="n">Transmitter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;tx&quot;</span><span class="p">,</span>
                 <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">8.5</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">27</span><span class="p">])</span>

<span class="c1"># Add transmitter instance to scene</span>
<span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>

<span class="c1"># Create a receiver</span>
<span class="n">rx</span> <span class="o">=</span> <span class="n">Receiver</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;rx&quot;</span><span class="p">,</span>
              <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mi">45</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mf">1.5</span><span class="p">],</span>
              <span class="n">orientation</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Add receiver instance to scene</span>
<span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rx</span><span class="p">)</span>

<span class="n">tx</span><span class="o">.</span><span class="n">look_at</span><span class="p">(</span><span class="n">rx</span><span class="p">)</span> <span class="c1"># Transmitter points towards receiver</span>
</pre></div>
</div>
</div>
<p>Each <a class="reference external" href="https://nvlabs.github.io/sionna/api/rt.html#scene-objects">SceneObject</a> has an assigned <a class="reference external" href="https://nvlabs.github.io/sionna/api/rt.html#radio-materials">RadioMaterial</a> that describes the electromagnetic properties of the object whenever it interacts with a ray. This behavior can be frequency-dependent and the ray tracing is done for a specific frequency.</p>
<p>We now set the carrier frequency of the scene and implicitly update all RadioMaterials.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scene</span><span class="o">.</span><span class="n">frequency</span> <span class="o">=</span> <span class="mf">2.14e9</span> <span class="c1"># in Hz; implicitly updates RadioMaterials</span>

<span class="n">scene</span><span class="o">.</span><span class="n">synthetic_array</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># If set to False, ray tracing will be done per antenna element (slower for large arrays)</span>
</pre></div>
</div>
</div>
<p>The default scenes have RadioMaterials assigned to each scene object. However, the RadioMaterial of a specific object can be modified and customized by the user.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select an example object from the scene</span>
<span class="n">so</span> <span class="o">=</span> <span class="n">scene</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Altes_Rathaus-itu_marble&quot;</span><span class="p">)</span>

<span class="c1"># Print name of assigned radio material for different frequenies</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">3.5e9</span><span class="p">,</span> <span class="mf">2.14e9</span><span class="p">]:</span> <span class="c1"># Print for differrent frequencies</span>
    <span class="n">scene</span><span class="o">.</span><span class="n">frequency</span> <span class="o">=</span> <span class="n">f</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">RadioMaterial: </span><span class="si">{</span><span class="n">so</span><span class="o">.</span><span class="n">radio_material</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> @ </span><span class="si">{</span><span class="n">scene</span><span class="o">.</span><span class="n">frequency</span><span class="o">/</span><span class="mf">1e9</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">GHz&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Conductivity:&quot;</span><span class="p">,</span> <span class="n">so</span><span class="o">.</span><span class="n">radio_material</span><span class="o">.</span><span class="n">conductivity</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Relative permittivity:&quot;</span><span class="p">,</span> <span class="n">so</span><span class="o">.</span><span class="n">radio_material</span><span class="o">.</span><span class="n">relative_permittivity</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Complex relative permittivity:&quot;</span><span class="p">,</span> <span class="n">so</span><span class="o">.</span><span class="n">radio_material</span><span class="o">.</span><span class="n">complex_relative_permittivity</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Relative permeability:&quot;</span><span class="p">,</span> <span class="n">so</span><span class="o">.</span><span class="n">radio_material</span><span class="o">.</span><span class="n">relative_permeability</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Scattering coefficient:&quot;</span><span class="p">,</span> <span class="n">so</span><span class="o">.</span><span class="n">radio_material</span><span class="o">.</span><span class="n">scattering_coefficient</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;XPD coefficient:&quot;</span><span class="p">,</span> <span class="n">so</span><span class="o">.</span><span class="n">radio_material</span><span class="o">.</span><span class="n">xpd_coefficient</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

RadioMaterial: itu_marble @ 3.50GHz
Conductivity: 0.017550057
Relative permittivity: 7.074
Complex relative permittivity: (7.074-0.090132594j)
Relative permeability: 1.0
Scattering coefficient: 0.0
XPD coefficient: 0.0

RadioMaterial: itu_marble @ 2.14GHz
Conductivity: 0.0111273555
Relative permittivity: 7.074
Complex relative permittivity: (7.074-0.09346512j)
Relative permeability: 1.0
Scattering coefficient: 0.0
XPD coefficient: 0.0
</pre></div></div>
</div>
<p>Let us run the ray tracing process and compute propagation paths between all transmitters and receivers. The parameter <code class="docutils literal notranslate"><span class="pre">max_depth</span></code> determines the maximum number of interactions between a ray and a scene objects. For example, with a <code class="docutils literal notranslate"><span class="pre">max_depth</span></code> of one, only LoS paths are considered. When the property <code class="docutils literal notranslate"><span class="pre">scene.synthetic_array</span></code> is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, antenna arrays are explicitly modeled by finding paths between any pair of transmitting and receiving antennas in the scene. Otherwise, arrays are
represented by a single antenna located in the center of the array. Phase shifts related to the relative antenna positions will then be applied based on a plane-wave assumption when the channel impulse responses are computed.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute propagation paths</span>
<span class="n">paths</span> <span class="o">=</span> <span class="n">scene</span><span class="o">.</span><span class="n">compute_paths</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                            <span class="n">num_samples</span><span class="o">=</span><span class="mf">1e6</span><span class="p">)</span>  <span class="c1"># Number of rays shot into directions defined</span>
                                              <span class="c1"># by a Fibonacci sphere , too few rays can</span>
                                              <span class="c1"># lead to missing paths</span>

<span class="c1"># Visualize paths in the scene</span>
<span class="k">if</span> <span class="n">no_preview</span><span class="p">:</span>
    <span class="n">scene</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;my_cam&quot;</span><span class="p">,</span> <span class="n">paths</span><span class="o">=</span><span class="n">paths</span><span class="p">,</span> <span class="n">show_devices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_paths</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Sionna_Ray_Tracing_Introduction_26_0.png" src="../_images/examples_Sionna_Ray_Tracing_Introduction_26_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">skip_if</span> no_preview
scene.preview(paths, show_devices=True, show_paths=True) # Use the mouse to focus on the visualized paths
</pre></div>
</div>
</div>
<p><em>Remark</em>: only one preview instance can be opened at the same time. Please check the previous preview if no output appears.</p>
<p>The <a class="reference external" href="https://nvlabs.github.io/sionna/api/rt.html#paths">Paths</a> object contains all paths that have been found between transmitters and receivers. In principle, the existence of each path is determininistic for a given position and environment. Please note that due to the stochastic nature of the <em>shoot-and-bounce</em> algorithm, different runs of the <code class="docutils literal notranslate"><span class="pre">compute_paths</span></code> function can lead to different paths that are found. Most importantly, diffusely reflected or scattered paths are obtained through
random sampling of directions after each interaction with a scene object. You can seet TensorFlow’s random seed to a specific value before executing <code class="docutils literal notranslate"><span class="pre">compute_paths</span></code> to ensure reproducibility.</p>
<p>The Paths object contains detailed information about every found path and allows us to generated channel impulse responses and apply Doppler shifts for the simulation of time evolution.</p>
<p>Let us now inspect some of the available properties:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the coordinates of the starting points of all rays.</span>
<span class="c1"># These coincide with the location of the transmitters.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Source coordinates: &quot;</span><span class="p">,</span> <span class="n">paths</span><span class="o">.</span><span class="n">sources</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Transmitter coordinates: &quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">scene</span><span class="o">.</span><span class="n">transmitters</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>

<span class="c1"># Show the coordinates of the endpoints of all rays.</span>
<span class="c1"># These coincide with the location of the receivers.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Target coordinates: &quot;</span><span class="p">,</span><span class="n">paths</span><span class="o">.</span><span class="n">targets</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Receiver coordinates: &quot;</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">scene</span><span class="o">.</span><span class="n">receivers</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>

<span class="c1"># Show the types of all paths:</span>
<span class="c1"># 0 - LoS, 1 - Reflected, 2 - Diffracted, 3 - Scattered</span>
<span class="c1"># Note that Diffraction and scattering are turned off by default.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Path types: &quot;</span><span class="p">,</span> <span class="n">paths</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Source coordinates:  [[ 8.5 21.  27. ]]
Transmitter coordinates:  [ 8.5 21.  27. ]
Target coordinates:  [[45.  90.   1.5]]
Receiver coordinates:  [45.  90.   1.5]
Path types:  [[0 1 1 1 1 1 1 1 1 1 1 1 1]]
</pre></div></div>
</div>
<p>We can see from the list of path types, that there are 14 paths in total. One LoS and 13 reflected paths.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can now access for every path the channel coefficient, the propagation delay,</span>
<span class="c1"># as well as the angles of departure and arrival, respectively (zenith and azimuth).</span>

<span class="c1"># Let us inspect a specific path in detail</span>
<span class="n">path_idx</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># Try out other values in the range [0, 13]</span>

<span class="c1"># For a detailed overview of the dimensions of all properties, have a look at the API documentation</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Detailed results for path </span><span class="si">{</span><span class="n">path_idx</span><span class="si">}</span><span class="s2"> ---&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Channel coefficient: </span><span class="si">{</span><span class="n">paths</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">path_idx</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Propagation delay: </span><span class="si">{</span><span class="n">paths</span><span class="o">.</span><span class="n">tau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">path_idx</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">*</span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> us&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Zenith angle of departure: </span><span class="si">{</span><span class="n">paths</span><span class="o">.</span><span class="n">theta_t</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">path_idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> rad&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Azimuth angle of departure: </span><span class="si">{</span><span class="n">paths</span><span class="o">.</span><span class="n">phi_t</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">path_idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> rad&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Zenith angle of arrival: </span><span class="si">{</span><span class="n">paths</span><span class="o">.</span><span class="n">theta_r</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">path_idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> rad&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Azimuth angle of arrival: </span><span class="si">{</span><span class="n">paths</span><span class="o">.</span><span class="n">phi_r</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">path_idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> rad&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

--- Detailed results for path 4 ---
Channel coefficient: (-1.1461009307822678e-05-3.821776886070438e-07j)
Propagation delay: 0.46001 us
Zenith angle of departure: 1.7007 rad
Azimuth angle of departure: 0.5157 rad
Zenith angle of arrival: 1.7007 rad
Azimuth angle of arrival: 0.5368 rad
</pre></div></div>
</div>
</section>
<section id="From-Paths-to-Channel-Impulse-Responses">
<h2>From Paths to Channel Impulse Responses<a class="headerlink" href="#From-Paths-to-Channel-Impulse-Responses" title="Link to this heading"></a></h2>
<p>Once paths are computed, they can be transformed into channel impulse responses (CIRs). The class method <a class="reference external" href="https://nvlabs.github.io/sionna/api/rt.html#Paths.apply_doppler">apply_doppler</a> can simulate time evolution of the CIR based on arbitrary velocity vectors of all transmitters and receivers for a desired sampling frequency and number of time steps. The class method <a class="reference external" href="https://nvlabs.github.io/sionna/api/rt.html#Paths.cir">cir</a> generates the channel impulse responses which can be used by
other components for link-level simulations in either time or frequency domains. The method also allows you to only consider certain types of paths, e.g., line-of-sight, reflections, etc.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Default parameters in the PUSCHConfig</span>
<span class="n">subcarrier_spacing</span> <span class="o">=</span> <span class="mf">15e3</span>
<span class="n">fft_size</span> <span class="o">=</span> <span class="mi">48</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print shape of channel coefficients before the application of Doppler shifts</span>
<span class="c1"># The last dimension corresponds to the number of time steps which defaults to one</span>
<span class="c1"># as there is no mobility</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape of `a` before applying Doppler shifts: &quot;</span><span class="p">,</span> <span class="n">paths</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># Apply Doppler shifts</span>
<span class="n">paths</span><span class="o">.</span><span class="n">apply_doppler</span><span class="p">(</span><span class="n">sampling_frequency</span><span class="o">=</span><span class="n">subcarrier_spacing</span><span class="p">,</span> <span class="c1"># Set to 15e3 Hz</span>
                    <span class="n">num_time_steps</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="c1"># Number of OFDM symbols</span>
                    <span class="n">tx_velocities</span><span class="o">=</span><span class="p">[</span><span class="mf">3.</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="c1"># We can set additional tx speeds</span>
                    <span class="n">rx_velocities</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">7.</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># Or rx speeds</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape of `a` after applying Doppler shifts: &quot;</span><span class="p">,</span> <span class="n">paths</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">a</span><span class="p">,</span> <span class="n">tau</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">cir</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape of tau: &quot;</span><span class="p">,</span> <span class="n">tau</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Shape of `a` before applying Doppler shifts:  (1, 1, 2, 1, 1, 13, 1)
Shape of `a` after applying Doppler shifts:  (1, 1, 2, 1, 1, 13, 14)
Shape of tau:  (1, 1, 1, 13)
</pre></div></div>
</div>
<p>Let us have a look at the channel impulse response for the 14 incoming paths from the simulation above.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">tau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span><span class="o">/</span><span class="mf">1e-9</span> <span class="c1"># Scale to ns</span>
<span class="n">a_abs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">a_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a_abs</span><span class="p">)</span>
<span class="c1"># Add dummy entry at start/end for nicer figure</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([(</span><span class="mf">0.</span><span class="p">,),</span> <span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="mf">1.1</span><span class="p">,)])</span>
<span class="n">a_abs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,),</span> <span class="n">a_abs</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,)])</span>

<span class="c1"># And plot the CIR</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Channel impulse response realization&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a_abs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">t</span><span class="p">)])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">2e-6</span><span class="p">,</span> <span class="n">a_max</span><span class="o">*</span><span class="mf">1.1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\tau$ [ns]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$|a|$&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Sionna_Ray_Tracing_Introduction_39_0.png" src="../_images/examples_Sionna_Ray_Tracing_Introduction_39_0.png" />
</div>
</div>
<p>Note that the delay of the first arriving path is normalized to zero. This behavior can be changed using the Paths’ call property <code class="docutils literal notranslate"><span class="pre">normalize_delays</span></code>. For link-level simulations, it is recommended to work with normalized delays, unless perfect synchronization is explicitly desired.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Disable normalization of delays</span>
<span class="n">paths</span><span class="o">.</span><span class="n">normalize_delays</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># Get only the LoS path</span>
<span class="n">_</span><span class="p">,</span> <span class="n">tau</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">cir</span><span class="p">(</span><span class="n">los</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reflection</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Delay of first path without normalization: &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">tau</span><span class="p">))</span>

<span class="n">paths</span><span class="o">.</span><span class="n">normalize_delays</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">_</span><span class="p">,</span> <span class="n">tau</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">cir</span><span class="p">(</span><span class="n">los</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reflection</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Delay of first path with normalization: &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">tau</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Delay of first path without normalization:  2.739189e-07
Delay of first path with normalization:  0.0
</pre></div></div>
</div>
<p>The CIRs can now be loaded either in the time-domain or frequency-domain channel models, respectively. Please see <a class="reference external" href="https://nvlabs.github.io/sionna/api/channel.wireless.html#sionna.channel.cir_to_ofdm_channel">cir_to_ofdm_channel</a> and <a class="reference external" href="https://nvlabs.github.io/sionna/api/channel.wireless.html#sionna.channel.cir_to_time_channel">cir_to_time_channel</a> for further details.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute frequencies of subcarriers and center around carrier frequency</span>
<span class="n">frequencies</span> <span class="o">=</span> <span class="n">subcarrier_frequencies</span><span class="p">(</span><span class="n">fft_size</span><span class="p">,</span> <span class="n">subcarrier_spacing</span><span class="p">)</span>

<span class="c1"># Compute the frequency response of the channel at frequencies.</span>
<span class="n">h_freq</span> <span class="o">=</span> <span class="n">cir_to_ofdm_channel</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span>
                             <span class="n">a</span><span class="p">,</span>
                             <span class="n">tau</span><span class="p">,</span>
                             <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Non-normalized includes path-loss</span>

<span class="c1"># Verify that the channel power is normalized</span>
<span class="n">h_avg_power</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h_freq</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape of h_freq: &quot;</span><span class="p">,</span> <span class="n">h_freq</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Average power h_freq: &quot;</span><span class="p">,</span> <span class="n">h_avg_power</span><span class="p">)</span> <span class="c1"># Channel is normalized</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Shape of h_freq:  (1, 1, 2, 1, 1, 14, 48)
Average power h_freq:  1.0
</pre></div></div>
</div>
<p>The frequency responses <code class="docutils literal notranslate"><span class="pre">h_freq</span></code> are now ready to be processed by the <a class="reference external" href="https://nvlabs.github.io/sionna/api/channel.wireless.html#sionna.channel.ApplyOFDMChannel">ApplyOFDMChannel</a> Layer.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Placeholder for tx signal of shape</span>
<span class="c1"># [batch size, num_tx, num_tx_ant, num_ofdm_symbols, fft_size]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">h_freq</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">as_list</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span> <span class="n">tf</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>

<span class="n">no</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># noise variance</span>

<span class="c1"># Init channel layer</span>
<span class="n">channel</span> <span class="o">=</span> <span class="n">ApplyOFDMChannel</span><span class="p">(</span><span class="n">add_awgn</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Apply channel</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">channel</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">h_freq</span><span class="p">,</span> <span class="n">no</span><span class="p">])</span>

<span class="c1"># [batch size, num_rx, num_rx_ant, num_ofdm_symbols, fft_size]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 1, 2, 14, 48)
</pre></div></div>
</div>
</section>
<section id="BER-Evaluation">
<h2>BER Evaluation<a class="headerlink" href="#BER-Evaluation" title="Link to this heading"></a></h2>
<p>We now initialize a transmitter and receiver from the <a class="reference external" href="https://nvlabs.github.io/sionna/examples/5G_NR_PUSCH.html">5G NR PUSCH Tutorial</a> notebook. These components could be replaced by your own transceiver implementations. Then we simulate PUSCH transmissions over the ray-traced CIRs that we generated in the previous cells.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Init pusch_transmitter</span>
<span class="n">pusch_config</span> <span class="o">=</span> <span class="n">PUSCHConfig</span><span class="p">()</span>

<span class="c1"># Instantiate a PUSCHTransmitter from the PUSCHConfig</span>
<span class="n">pusch_transmitter</span> <span class="o">=</span> <span class="n">PUSCHTransmitter</span><span class="p">(</span><span class="n">pusch_config</span><span class="p">)</span>

<span class="c1"># Create a PUSCHReceiver using the PUSCHTransmitter</span>
<span class="n">pusch_receiver</span> <span class="o">=</span> <span class="n">PUSCHReceiver</span><span class="p">(</span><span class="n">pusch_transmitter</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate transmissions over the</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># h_freq is broadcast, i.e., same CIR for all samples but different AWGN realizations</span>
<span class="n">ebno_db</span> <span class="o">=</span> <span class="mf">2.</span> <span class="c1"># SNR in dB</span>

<span class="n">no</span> <span class="o">=</span> <span class="n">ebnodb2no</span><span class="p">(</span><span class="n">ebno_db</span><span class="p">,</span>
               <span class="n">pusch_transmitter</span><span class="o">.</span><span class="n">_num_bits_per_symbol</span><span class="p">,</span>
               <span class="n">pusch_transmitter</span><span class="o">.</span><span class="n">_target_coderate</span><span class="p">,</span>
               <span class="n">pusch_transmitter</span><span class="o">.</span><span class="n">resource_grid</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">pusch_transmitter</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span> <span class="c1"># Generate transmit signal and info bits</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">channel</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">h_freq</span><span class="p">,</span> <span class="n">no</span><span class="p">])</span> <span class="c1"># Simulate channel output</span>

<span class="n">b_hat</span> <span class="o">=</span> <span class="n">pusch_receiver</span><span class="p">([</span><span class="n">y</span><span class="p">,</span> <span class="n">no</span><span class="p">])</span> <span class="c1"># Recover the info bits</span>

<span class="c1"># Compute BER</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BER: </span><span class="si">{</span><span class="n">compute_ber</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">b_hat</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
BER: 0.07568
</pre></div></div>
</div>
<p><strong>Remark</strong> Contrary to other Sionna components, ray tracing does not have a dedicated batch dimension. However, multiple transmitter and receivers can be simulated in parallel, which effectively equals a batch-dimension.</p>
<p>Note that simulating multiple receivers in the ray tracer comes at little additional overhead. However, the complexity increases significantly for multiple transmitters as an individual ray tracing step is required for each transmitter. As the total number of rays is fixed, an increased number of transmitter requires also an increased number of rays in the <code class="docutils literal notranslate"><span class="pre">compute_paths</span></code> step for the same overall precision.</p>
</section>
<section id="Runtime-vs-Depth">
<h2>Runtime vs Depth<a class="headerlink" href="#Runtime-vs-Depth" title="Link to this heading"></a></h2>
<p>We will now investigate the complexity of the ray tracing algorithm for different values of <code class="docutils literal notranslate"><span class="pre">max_depth</span></code>, i.e., for a different number of bounces of the rays.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">max_depths</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># evaluate performance up to 10 reflections</span>
<span class="n">depths</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">max_depths</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">pl_avg</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">depths</span><span class="p">:</span>
    <span class="c1"># save start time</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="c1"># run the ray tracer</span>
    <span class="n">paths</span> <span class="o">=</span> <span class="n">scene</span><span class="o">.</span><span class="n">compute_paths</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
    <span class="c1"># and measure the required time interval</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># and plot results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">depths</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Max. depth&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Runtime (s)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_depths</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Sionna_Ray_Tracing_Introduction_52_0.png" src="../_images/examples_Sionna_Ray_Tracing_Introduction_52_0.png" />
</div>
</div>
<p>As can be seen, the computational complexity increases significantly with the number of ray interactions. Note that the code above does not account for scattering or diffraction. Adding these phenomea adds additional complexity as can be seen below:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">paths</span> <span class="o">=</span> <span class="n">scene</span><span class="o">.</span><span class="n">compute_paths</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">diffraction</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Time without diffraction and scattering:&quot;</span> <span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">paths</span> <span class="o">=</span> <span class="n">scene</span><span class="o">.</span><span class="n">compute_paths</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">diffraction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Time with diffraction:&quot;</span> <span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">paths</span> <span class="o">=</span> <span class="n">scene</span><span class="o">.</span><span class="n">compute_paths</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">scattering</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Time with scattering:&quot;</span> <span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Time without diffraction and scattering: 3.022740602493286
Time with diffraction: 4.306113243103027
Time with scattering: 3.667450189590454
</pre></div></div>
</div>
<p>Although we have simulated scattering in the last example above, the scattered paths do not carry any energy as none of the materials in the scene has a positive scattering coefficient. You can learn more about scattering and diffraction in the dedicated <a class="reference external" href="https://nvlabs.github.io/sionna/tutorials.html#ray-tracing">tutorial notebooks</a>.</p>
</section>
<section id="Coverage-Map">
<h2>Coverage Map<a class="headerlink" href="#Coverage-Map" title="Link to this heading"></a></h2>
<p>Sionna RT can be also used to simulate coverage maps for a given environment. We now put a new transmitter on top of the Frauenkirche and simulate a large-scale coverage map.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remove old transmitter and add new one</span>
<span class="n">scene</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;tx&quot;</span><span class="p">)</span>

<span class="n">tx</span> <span class="o">=</span> <span class="n">Transmitter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;tx&quot;</span><span class="p">,</span>
                 <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">210</span><span class="p">,</span><span class="mi">73</span><span class="p">,</span><span class="mi">105</span><span class="p">],</span> <span class="c1"># top of Frauenkirche</span>
                 <span class="n">orientation</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>

<span class="c1"># We could have alternatively modified the properties position and orientation of the existing transmitter</span>
<span class="c1">#scene.get(&quot;tx&quot;).position = [-210,73,105]</span>
<span class="c1">#scene.get(&quot;tx&quot;).orientation = [0,0,0]</span>
</pre></div>
</div>
</div>
<p>Let’s have a look at the new setup. The receiver can be ignored for the coverage map simulation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span> <span class="c1"># Open 3D preview (only works in Jupyter notebook)</span>
<span class="k">if</span> <span class="n">no_preview</span><span class="p">:</span>
    <span class="n">scene</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">camera</span><span class="o">=</span><span class="s2">&quot;scene-cam-0&quot;</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Sionna_Ray_Tracing_Introduction_59_0.png" src="../_images/examples_Sionna_Ray_Tracing_Introduction_59_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">skip_if</span> no_preview
scene.preview()
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cm</span> <span class="o">=</span> <span class="n">scene</span><span class="o">.</span><span class="n">coverage_map</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                        <span class="n">diffraction</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># Disable to see the effects of diffraction</span>
                        <span class="n">cm_cell_size</span><span class="o">=</span><span class="p">(</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">),</span> <span class="c1"># Grid size of coverage map cells in m</span>
                        <span class="n">combining_vec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">precoding_vec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">num_samples</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">20e6</span><span class="p">))</span> <span class="c1"># Reduce if your hardware does not have enough memory</span>
</pre></div>
</div>
</div>
<p>Once simulated, the coverage map object can be directly visualized with the <code class="docutils literal notranslate"><span class="pre">preview</span></code> or <code class="docutils literal notranslate"><span class="pre">render</span></code> function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create new camera</span>
<span class="n">tx_pos</span> <span class="o">=</span> <span class="n">scene</span><span class="o">.</span><span class="n">transmitters</span><span class="p">[</span><span class="s2">&quot;tx&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">bird_pos</span> <span class="o">=</span> <span class="n">tx_pos</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">bird_pos</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># Set height of coverage map to 1000m above tx</span>
<span class="n">bird_pos</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">-=</span> <span class="mf">0.01</span> <span class="c1"># Slightly move the camera for correct orientation</span>

<span class="c1"># Create new camera</span>
<span class="n">bird_cam</span> <span class="o">=</span> <span class="n">Camera</span><span class="p">(</span><span class="s2">&quot;birds_view&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">bird_pos</span><span class="p">,</span> <span class="n">look_at</span><span class="o">=</span><span class="n">tx_pos</span><span class="p">)</span>

<span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">bird_cam</span><span class="p">)</span>

<span class="k">if</span> <span class="n">no_preview</span><span class="p">:</span>
    <span class="n">scene</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">camera</span><span class="o">=</span><span class="s2">&quot;birds_view&quot;</span><span class="p">,</span> <span class="n">coverage_map</span><span class="o">=</span><span class="n">cm</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Sionna_Ray_Tracing_Introduction_63_0.png" src="../_images/examples_Sionna_Ray_Tracing_Introduction_63_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">skip_if</span> no_preview
scene.preview(coverage_map=cm)
</pre></div>
</div>
</div>
<p>Alternatively, a 2D visualization of the coverage map can be shown.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cm</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">tx</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span> <span class="c1"># If multiple transmitters exist, tx selects for which transmitter the cm is shown</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Sionna_Ray_Tracing_Introduction_66_0.png" src="../_images/examples_Sionna_Ray_Tracing_Introduction_66_0.png" />
</div>
</div>
<p>Note that it can happen in rare cases that diffracted rays arrive inside or behind buildings through paths which should not exists. This is not a bug in Sionna’s ray tracing algorithm but rather an artefact of the way how scenes are created which can lead to the false detection of diffraction edges.</p>
</section>
<section id="Site-specifc-Link-Level-Simulations">
<h2>Site-specifc Link-Level Simulations<a class="headerlink" href="#Site-specifc-Link-Level-Simulations" title="Link to this heading"></a></h2>
<p>We will now use Sionna RT for site-specific link-level simulations. For this, we evaluate the BER performance for a MU-MIMO 5G NR system in the uplink direction based on ray traced CIRs for random user positions.</p>
<p>We use the 5G NR PUSCH transmitter and receiver from the <a class="reference external" href="https://nvlabs.github.io/sionna/examples/5G_NR_PUSCH.html">5G NR PUSCH Tutorial</a> notebook. Note that also the systems from the <a class="reference external" href="https://nvlabs.github.io/sionna/examples/MIMO_OFDM_Transmissions_over_CDL.html">MIMO OFDM Transmissions over the CDL Channel Model</a> or the <a class="reference external" href="https://nvlabs.github.io/sionna/examples/Neural_Receiver.html">Neural Receiver for OFDM SIMO Systems</a> tutorials could be used instead.</p>
<p>There are different ways to implement uplink scenarios in Sionna RT. In this example, we configure the basestation as transmitter and the user equipments (UEs) as receivers which simplifies the ray tracing. Due to channel reciprocity, one can <em>reverse</em> the direction of the ray traced channels afterwards. For the ray tracer itself, the direction (uplink/downlink) does not change the simulated paths.</p>
<p><em>Note</em>: Running the cells below can take several hours of compute time.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># System parameters</span>
<span class="n">subcarrier_spacing</span> <span class="o">=</span> <span class="mf">30e3</span>
<span class="n">num_time_steps</span> <span class="o">=</span> <span class="mi">14</span> <span class="c1"># Total number of ofdm symbols per slot</span>

<span class="n">num_tx</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># Number of users</span>
<span class="n">num_rx</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># Only one receiver considered</span>
<span class="n">num_tx_ant</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># Each user has 4 antennas</span>
<span class="n">num_rx_ant</span> <span class="o">=</span> <span class="mi">16</span> <span class="c1"># The receiver is equipped with 16 antennas</span>

<span class="c1"># batch_size for CIR generation</span>
<span class="n">batch_size_cir</span> <span class="o">=</span> <span class="mi">1000</span>
</pre></div>
</div>
</div>
<p>Let us add a new transmitter that acts as basestation. We will later use channel reciprocity to simulate the uplink direction.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remove old tx from scene</span>
<span class="n">scene</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;tx&quot;</span><span class="p">)</span>

<span class="n">scene</span><span class="o">.</span><span class="n">synthetic_array</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># Emulate multiple antennas to reduce ray tracing complexity</span>

<span class="c1"># Transmitter (=basestation) has an antenna pattern from 3GPP 38.901</span>
<span class="n">scene</span><span class="o">.</span><span class="n">tx_array</span> <span class="o">=</span> <span class="n">PlanarArray</span><span class="p">(</span><span class="n">num_rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                             <span class="n">num_cols</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">num_rx_ant</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="c1"># We want to transmitter to be equiped with the 16 rx antennas</span>
                             <span class="n">vertical_spacing</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">horizontal_spacing</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;tr38901&quot;</span><span class="p">,</span>
                             <span class="n">polarization</span><span class="o">=</span><span class="s2">&quot;cross&quot;</span><span class="p">)</span>

<span class="c1"># Create transmitter</span>
<span class="n">tx</span> <span class="o">=</span> <span class="n">Transmitter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;tx&quot;</span><span class="p">,</span>
                 <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">8.5</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">27</span><span class="p">],</span>
                 <span class="n">look_at</span><span class="o">=</span><span class="p">[</span><span class="mi">45</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mf">1.5</span><span class="p">])</span> <span class="c1"># optional, defines view direction</span>
<span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We now need to update the coverage map for the new transmitter.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">max_depth</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># Defines max number of ray interactions</span>

<span class="c1"># Update coverage_map</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">scene</span><span class="o">.</span><span class="n">coverage_map</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">,</span>
                        <span class="n">diffraction</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">cm_cell_size</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">),</span>
                        <span class="n">combining_vec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">precoding_vec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">num_samples</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">10e6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">sample_positions</span></code> allows sampling of random user positions from a coverage map. It ensures that only positions are sampled that have a path gain of at least <code class="docutils literal notranslate"><span class="pre">min_gain_dB</span></code> dB and at most <code class="docutils literal notranslate"><span class="pre">max_gain_dB</span></code> dB, i.e., ignores positions without connection to the transmitter. Further, one can set the distance <code class="docutils literal notranslate"><span class="pre">min_dist</span></code> and <code class="docutils literal notranslate"><span class="pre">max_dist</span></code> to sample only points with a certain distance away from the transmitter.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">min_gain_db</span> <span class="o">=</span> <span class="o">-</span><span class="mi">130</span> <span class="c1"># in dB; ignore any position with less than -130 dB path gain</span>
<span class="n">max_gain_db</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># in dB; ignore strong paths</span>

<span class="c1"># sample points in a 5-400m radius around the receiver</span>
<span class="n">min_dist</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># in m</span>
<span class="n">max_dist</span> <span class="o">=</span> <span class="mi">400</span> <span class="c1"># in m</span>

<span class="c1">#sample batch_size random user positions from coverage map</span>
<span class="n">ue_pos</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">sample_positions</span><span class="p">(</span><span class="n">num_pos</span><span class="o">=</span><span class="n">batch_size_cir</span><span class="p">,</span>
                                <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;path_gain&quot;</span><span class="p">,</span>
                                <span class="n">min_val_db</span><span class="o">=</span><span class="n">min_gain_db</span><span class="p">,</span>
                                <span class="n">max_val_db</span><span class="o">=</span><span class="n">max_gain_db</span><span class="p">,</span>
                                <span class="n">min_dist</span><span class="o">=</span><span class="n">min_dist</span><span class="p">,</span>
                                <span class="n">max_dist</span><span class="o">=</span><span class="n">max_dist</span><span class="p">)</span>
<span class="n">ue_pos</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">ue_pos</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We now add new receivers (=UEs) at random position.</p>
<p><em>Remark</em>: This is an example for 5G NR PUSCH (uplink direction), we will reverse the direction of the channel for later BER simulations.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remove old receivers from scene</span>
<span class="n">scene</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;rx&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">batch_size_cir</span><span class="p">):</span>
    <span class="n">scene</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;rx-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Configure antenna array for all receivers (=UEs)</span>
<span class="n">scene</span><span class="o">.</span><span class="n">rx_array</span> <span class="o">=</span> <span class="n">PlanarArray</span><span class="p">(</span><span class="n">num_rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                             <span class="n">num_cols</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">num_tx_ant</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="c1"># Each receiver is equipped with 4 tx antennas (uplink)</span>
                             <span class="n">vertical_spacing</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">horizontal_spacing</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;iso&quot;</span><span class="p">,</span> <span class="c1"># UE orientation is random</span>
                             <span class="n">polarization</span><span class="o">=</span><span class="s2">&quot;cross&quot;</span><span class="p">)</span>

<span class="c1"># Create batch_size receivers</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">batch_size_cir</span><span class="p">):</span>
    <span class="n">rx</span> <span class="o">=</span> <span class="n">Receiver</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;rx-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                  <span class="n">position</span><span class="o">=</span><span class="n">ue_pos</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="c1"># Random position sampled from coverage map</span>
                  <span class="p">)</span>
    <span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rx</span><span class="p">)</span>

<span class="c1"># And visualize the scene</span>
<span class="k">if</span> <span class="n">no_preview</span><span class="p">:</span>
    <span class="n">scene</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&quot;birds_view&quot;</span><span class="p">,</span> <span class="n">show_devices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Sionna_Ray_Tracing_Introduction_77_0.png" src="../_images/examples_Sionna_Ray_Tracing_Introduction_77_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">skip_if</span> no_preview
scene.preview(show_devices=True, coverage_map=cm)
</pre></div>
</div>
</div>
<p>Each dot represents a random receiver position drawn from the random sampling function of the coverage map. This allows to efficiently sample batches of random channel realizations even in complex scenarios.</p>
<p>We can now simulate the CIRs for many different random positions.</p>
<p><em>Remark</em>: Running the cells below can take some time depending on the requested number of CIRs.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_num_cirs</span> <span class="o">=</span> <span class="mi">5000</span> <span class="c1"># Defines how many different CIRS are generated.</span>
<span class="c1"># Remark: some path are removed if no path was found for this position</span>

<span class="n">max_depth</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">min_gain_db</span> <span class="o">=</span> <span class="o">-</span><span class="mi">130</span> <span class="c1"># in dB / ignore any position with less than -130 dB path gain</span>
<span class="n">max_gain_db</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># in dB / ignore any position with more than 0 dB path gain</span>

<span class="c1"># Sample points within a 10-400m radius around the transmitter</span>
<span class="n">min_dist</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># in m</span>
<span class="n">max_dist</span> <span class="o">=</span> <span class="mi">400</span> <span class="c1"># in m</span>

<span class="c1"># Placeholder to gather channel impulse reponses</span>
<span class="n">a</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">tau</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># Each simulation returns batch_size_cir results</span>
<span class="n">num_runs</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">target_num_cirs</span><span class="o">/</span><span class="n">batch_size_cir</span><span class="p">))</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_runs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Progress: </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">num_runs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Sample random user positions</span>
    <span class="n">ue_pos</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">sample_positions</span><span class="p">(</span>
                        <span class="n">num_pos</span><span class="o">=</span><span class="n">batch_size_cir</span><span class="p">,</span>
                        <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;path_gain&quot;</span><span class="p">,</span>
                        <span class="n">min_val_db</span><span class="o">=</span><span class="n">min_gain_db</span><span class="p">,</span>
                        <span class="n">max_val_db</span><span class="o">=</span><span class="n">max_gain_db</span><span class="p">,</span>
                        <span class="n">min_dist</span><span class="o">=</span><span class="n">min_dist</span><span class="p">,</span>
                        <span class="n">max_dist</span><span class="o">=</span><span class="n">max_dist</span><span class="p">)</span>
    <span class="n">ue_pos</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">ue_pos</span><span class="p">)</span>

    <span class="c1"># Update all receiver positions</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">batch_size_cir</span><span class="p">):</span>
        <span class="n">scene</span><span class="o">.</span><span class="n">receivers</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;rx-</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">ue_pos</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

    <span class="c1"># Simulate CIR</span>
    <span class="n">paths</span> <span class="o">=</span> <span class="n">scene</span><span class="o">.</span><span class="n">compute_paths</span><span class="p">(</span>
                    <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">,</span>
                    <span class="n">diffraction</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">num_samples</span><span class="o">=</span><span class="mf">1e6</span><span class="p">)</span> <span class="c1"># shared between all tx in a scene</span>

    <span class="c1"># Transform paths into channel impulse responses</span>
    <span class="n">paths</span><span class="o">.</span><span class="n">reverse_direction</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># Convert to uplink direction</span>
    <span class="n">paths</span><span class="o">.</span><span class="n">apply_doppler</span><span class="p">(</span><span class="n">sampling_frequency</span><span class="o">=</span><span class="n">subcarrier_spacing</span><span class="p">,</span>
                        <span class="n">num_time_steps</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                        <span class="n">tx_velocities</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">rx_velocities</span><span class="o">=</span><span class="p">[</span><span class="mf">3.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># We fix here the maximum number of paths to 75 which ensures</span>
    <span class="c1"># that we can simply concatenate different channel impulse reponses</span>
    <span class="n">a_</span><span class="p">,</span> <span class="n">tau_</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">cir</span><span class="p">(</span><span class="n">num_paths</span><span class="o">=</span><span class="mi">75</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">paths</span> <span class="c1"># Free memory</span>

    <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a_</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
        <span class="n">tau</span> <span class="o">=</span> <span class="n">tau_</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Concatenate along the num_tx dimension</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">a_</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">tau</span><span class="p">,</span> <span class="n">tau_</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="k">del</span> <span class="n">cm</span> <span class="c1"># Free memory</span>

<span class="c1"># Exchange the num_tx and batchsize dimensions</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="c1"># Remove CIRs that have no active link (i.e., a is all-zero)</span>
<span class="n">p_link</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">p_link</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">,</span><span class="o">...</span><span class="p">]</span>
<span class="n">tau</span> <span class="o">=</span> <span class="n">tau</span><span class="p">[</span><span class="n">p_link</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">,</span><span class="o">...</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape of a:&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape of tau: &quot;</span><span class="p">,</span> <span class="n">tau</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Shape of a: (4814, 1, 16, 1, 4, 75, 14)
Shape of tau:  (4814, 1, 1, 75)
</pre></div></div>
</div>
<p>Note that transmitter and receiver have been reversed, i.e., the transmitter now denotes the UE (with 4 antennas each) and the receiver is the basestation (with 16 antennas).</p>
<p><em>Remark</em>: We have removed all positions where the resulting CIR was zero, i.e., no path between transmitter and receiver was found. This comes from the fact that the <code class="docutils literal notranslate"><span class="pre">sample_position</span></code> function samples from the quantized coverage map and randomizes the position within the cell. It can happen that for this random position no connection between transmitter and receiver can be found.</p>
<p>Let us now initialize a <code class="docutils literal notranslate"><span class="pre">data_generator</span></code> that samples random UEs from the dataset and <em>yields</em> the previously simulated CIRs.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CIRGenerator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a generator from a given dataset of channel impulse responses.</span>

<span class="sd">    The generator samples ``num_tx`` different transmitters from the given path</span>
<span class="sd">    coefficients `a` and path delays `tau` and stacks the CIRs into a single tensor.</span>

<span class="sd">    Note that the generator internally samples ``num_tx`` random transmitters</span>
<span class="sd">    from the dataset. For this, the inputs ``a`` and ``tau`` must be given for</span>
<span class="sd">    a single transmitter (i.e., ``num_tx`` =1) which will then be stacked</span>
<span class="sd">    internally.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : [batch size, num_rx, num_rx_ant, 1, num_tx_ant, num_paths, num_time_steps], complex</span>
<span class="sd">        Path coefficients per transmitter.</span>

<span class="sd">    tau : [batch size, num_rx, 1, num_paths], float</span>
<span class="sd">        Path delays [s] per transmitter.</span>

<span class="sd">    num_tx : int</span>
<span class="sd">        Number of transmitters</span>

<span class="sd">    Output</span>
<span class="sd">    -------</span>
<span class="sd">    a : [batch size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_paths, num_time_steps], tf.complex</span>
<span class="sd">        Path coefficients</span>

<span class="sd">    tau : [batch size, num_rx, num_tx, num_paths], tf.float</span>
<span class="sd">        Path delays [s]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">a</span><span class="p">,</span>
                 <span class="n">tau</span><span class="p">,</span>
                 <span class="n">num_tx</span><span class="p">):</span>

        <span class="c1"># Copy to tensorflow</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_a</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tau</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dataset_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_tx</span> <span class="o">=</span> <span class="n">num_tx</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># Generator implements an infinite loop that yields new random samples</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1"># Sample 4 random users and stack them together</span>
            <span class="n">idx</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform_candidate_sampler</span><span class="p">(</span>
                            <span class="n">tf</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataset_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                            <span class="n">num_true</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataset_size</span><span class="p">,</span>
                            <span class="n">num_sampled</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_tx</span><span class="p">,</span>
                            <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">range_max</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataset_size</span><span class="p">)</span>

            <span class="n">a</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_a</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
            <span class="n">tau</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tau</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>

            <span class="c1"># Transpose to remove batch dimension</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
            <span class="n">tau</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

            <span class="c1"># And remove batch-dimension</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">tau</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="k">yield</span> <span class="n">a</span><span class="p">,</span> <span class="n">tau</span>
</pre></div>
</div>
</div>
<p>We use Sionna’s built-in <a class="reference external" href="https://nvlabs.github.io/sionna/api/channel.wireless.html#sionna.channel.CIRDataset">CIRDataset</a> to initialize a channel model that can be directly used in Sionna’s <a class="reference external" href="https://nvlabs.github.io/sionna/api/channel.wireless.html#sionna.channel.OFDMChannel">OFDMChannel</a> layer.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># Must be the same for the BER simulations as CIRDataset returns fixed batch_size</span>

<span class="c1"># Init CIR generator</span>
<span class="n">cir_generator</span> <span class="o">=</span> <span class="n">CIRGenerator</span><span class="p">(</span><span class="n">a</span><span class="p">,</span>
                             <span class="n">tau</span><span class="p">,</span>
                             <span class="n">num_tx</span><span class="p">)</span>
<span class="c1"># Initialises a channel model that can be directly used by OFDMChannel layer</span>
<span class="n">channel_model</span> <span class="o">=</span> <span class="n">CIRDataset</span><span class="p">(</span><span class="n">cir_generator</span><span class="p">,</span>
                           <span class="n">batch_size</span><span class="p">,</span>
                           <span class="n">num_rx</span><span class="p">,</span>
                           <span class="n">num_rx_ant</span><span class="p">,</span>
                           <span class="n">num_tx</span><span class="p">,</span>
                           <span class="n">num_tx_ant</span><span class="p">,</span>
                           <span class="mi">75</span><span class="p">,</span>
                           <span class="n">num_time_steps</span><span class="p">)</span>

<span class="c1"># Delete to free memory</span>
<span class="k">del</span> <span class="n">a</span><span class="p">,</span> <span class="n">tau</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We need to enable sionna.config.xla_compat before we can use</span>
<span class="c1"># tf.function with jit_compile=True.</span>
<span class="c1"># See https://nvlabs.github.io/sionna/api/config.html#sionna.Config.xla_compat</span>
<span class="n">sionna</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">xla_compat</span><span class="o">=</span><span class="kc">False</span> <span class="c1"># not supported in CIRDataset</span>

<span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simulate PUSCH transmissions over a 3GPP 38.901 model.</span>

<span class="sd">    This model runs BER simulations for a multi-user MIMO uplink channel</span>
<span class="sd">    compliant with the 5G NR PUSCH specifications.</span>
<span class="sd">    You can pick different scenarios, i.e., channel models, perfect or</span>
<span class="sd">    estimated CSI, as well as different MIMO detectors (LMMSE or KBest).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    channel_model : :class:`~sionna.channel.ChannelModel` object</span>
<span class="sd">        An instance of a :class:`~sionna.channel.ChannelModel` object, such as</span>
<span class="sd">        :class:`~sionna.channel.RayleighBlockFading` or</span>
<span class="sd">        :class:`~sionna.channel.tr38901.UMi` or</span>
<span class="sd">        :class:`~sionna.channel.CIRDataset`.</span>

<span class="sd">    perfect_csi : bool</span>
<span class="sd">        Determines if perfect CSI is assumed or if the CSI is estimated</span>

<span class="sd">    detector : str, one of [&quot;lmmse&quot;, &quot;kbest&quot;]</span>
<span class="sd">        MIMO detector to be used. Note that each detector has additional</span>
<span class="sd">        parameters that can be configured in the source code of the _init_ call.</span>

<span class="sd">    Input</span>
<span class="sd">    -----</span>
<span class="sd">    batch_size : int</span>
<span class="sd">        Number of simultaneously simulated slots</span>

<span class="sd">    ebno_db : float</span>
<span class="sd">        Signal-to-noise-ratio</span>

<span class="sd">    Output</span>
<span class="sd">    ------</span>
<span class="sd">    b : [batch_size, num_tx, tb_size], tf.float</span>
<span class="sd">        Transmitted information bits</span>

<span class="sd">    b_hat : [batch_size, num_tx, tb_size], tf.float</span>
<span class="sd">        Decoded information bits</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">channel_model</span><span class="p">,</span>
                 <span class="n">perfect_csi</span><span class="p">,</span> <span class="c1"># bool</span>
                 <span class="n">detector</span><span class="p">,</span>    <span class="c1"># &quot;lmmse&quot;, &quot;kbest&quot;</span>
                <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_channel_model</span> <span class="o">=</span> <span class="n">channel_model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_perfect_csi</span> <span class="o">=</span> <span class="n">perfect_csi</span>

        <span class="c1"># System configuration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_prb</span> <span class="o">=</span> <span class="mi">16</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mcs_index</span> <span class="o">=</span> <span class="mi">14</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_layers</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mcs_table</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span> <span class="o">=</span> <span class="s2">&quot;freq&quot;</span>

        <span class="c1"># Below parameters must equal the Path2CIR parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_tx_ant</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_tx</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_subcarrier_spacing</span> <span class="o">=</span> <span class="mf">30e3</span> <span class="c1"># must be the same as used for Path2CIR</span>

        <span class="c1"># PUSCHConfig for the first transmitter</span>
        <span class="n">pusch_config</span> <span class="o">=</span> <span class="n">PUSCHConfig</span><span class="p">()</span>
        <span class="n">pusch_config</span><span class="o">.</span><span class="n">carrier</span><span class="o">.</span><span class="n">subcarrier_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subcarrier_spacing</span><span class="o">/</span><span class="mi">1000</span>
        <span class="n">pusch_config</span><span class="o">.</span><span class="n">carrier</span><span class="o">.</span><span class="n">n_size_grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_prb</span>
        <span class="n">pusch_config</span><span class="o">.</span><span class="n">num_antenna_ports</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_tx_ant</span>
        <span class="n">pusch_config</span><span class="o">.</span><span class="n">num_layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_layers</span>
        <span class="n">pusch_config</span><span class="o">.</span><span class="n">precoding</span> <span class="o">=</span> <span class="s2">&quot;codebook&quot;</span>
        <span class="n">pusch_config</span><span class="o">.</span><span class="n">tpmi</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">pusch_config</span><span class="o">.</span><span class="n">dmrs</span><span class="o">.</span><span class="n">dmrs_port_set</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_layers</span><span class="p">))</span>
        <span class="n">pusch_config</span><span class="o">.</span><span class="n">dmrs</span><span class="o">.</span><span class="n">config_type</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">pusch_config</span><span class="o">.</span><span class="n">dmrs</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">pusch_config</span><span class="o">.</span><span class="n">dmrs</span><span class="o">.</span><span class="n">additional_position</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">pusch_config</span><span class="o">.</span><span class="n">dmrs</span><span class="o">.</span><span class="n">num_cdm_groups_without_data</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">pusch_config</span><span class="o">.</span><span class="n">tb</span><span class="o">.</span><span class="n">mcs_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mcs_index</span>
        <span class="n">pusch_config</span><span class="o">.</span><span class="n">tb</span><span class="o">.</span><span class="n">mcs_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mcs_table</span>

        <span class="c1"># Create PUSCHConfigs for the other transmitters by cloning of the first PUSCHConfig</span>
        <span class="c1"># and modifying the used DMRS ports.</span>
        <span class="n">pusch_configs</span> <span class="o">=</span> <span class="p">[</span><span class="n">pusch_config</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_tx</span><span class="p">):</span>
            <span class="n">pc</span> <span class="o">=</span> <span class="n">pusch_config</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
            <span class="n">pc</span><span class="o">.</span><span class="n">dmrs</span><span class="o">.</span><span class="n">dmrs_port_set</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_layers</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_layers</span><span class="p">))</span>
            <span class="n">pusch_configs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pc</span><span class="p">)</span>

        <span class="c1"># Create PUSCHTransmitter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pusch_transmitter</span> <span class="o">=</span> <span class="n">PUSCHTransmitter</span><span class="p">(</span><span class="n">pusch_configs</span><span class="p">,</span> <span class="n">output_domain</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">)</span>

        <span class="c1"># Create PUSCHReceiver</span>
        <span class="n">rx_tx_association</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_tx</span><span class="p">],</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="n">stream_management</span> <span class="o">=</span> <span class="n">StreamManagement</span><span class="p">(</span><span class="n">rx_tx_association</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">_num_layers</span><span class="p">)</span>

        <span class="k">assert</span> <span class="n">detector</span> <span class="ow">in</span><span class="p">[</span><span class="s2">&quot;lmmse&quot;</span><span class="p">,</span> <span class="s2">&quot;kbest&quot;</span><span class="p">],</span> <span class="s2">&quot;Unsupported MIMO detector&quot;</span>
        <span class="k">if</span> <span class="n">detector</span><span class="o">==</span><span class="s2">&quot;lmmse&quot;</span><span class="p">:</span>
            <span class="n">detector</span> <span class="o">=</span> <span class="n">LinearDetector</span><span class="p">(</span><span class="n">equalizer</span><span class="o">=</span><span class="s2">&quot;lmmse&quot;</span><span class="p">,</span>
                                      <span class="n">output</span><span class="o">=</span><span class="s2">&quot;bit&quot;</span><span class="p">,</span>
                                      <span class="n">demapping_method</span><span class="o">=</span><span class="s2">&quot;maxlog&quot;</span><span class="p">,</span>
                                      <span class="n">resource_grid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_pusch_transmitter</span><span class="o">.</span><span class="n">resource_grid</span><span class="p">,</span>
                                      <span class="n">stream_management</span><span class="o">=</span><span class="n">stream_management</span><span class="p">,</span>
                                      <span class="n">constellation_type</span><span class="o">=</span><span class="s2">&quot;qam&quot;</span><span class="p">,</span>
                                      <span class="n">num_bits_per_symbol</span><span class="o">=</span><span class="n">pusch_config</span><span class="o">.</span><span class="n">tb</span><span class="o">.</span><span class="n">num_bits_per_symbol</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">detector</span><span class="o">==</span><span class="s2">&quot;kbest&quot;</span><span class="p">:</span>
            <span class="n">detector</span> <span class="o">=</span> <span class="n">KBestDetector</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;bit&quot;</span><span class="p">,</span>
                                     <span class="n">num_streams</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_tx</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_layers</span><span class="p">,</span>
                                     <span class="n">k</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
                                     <span class="n">resource_grid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_pusch_transmitter</span><span class="o">.</span><span class="n">resource_grid</span><span class="p">,</span>
                                     <span class="n">stream_management</span><span class="o">=</span><span class="n">stream_management</span><span class="p">,</span>
                                     <span class="n">constellation_type</span><span class="o">=</span><span class="s2">&quot;qam&quot;</span><span class="p">,</span>
                                     <span class="n">num_bits_per_symbol</span><span class="o">=</span><span class="n">pusch_config</span><span class="o">.</span><span class="n">tb</span><span class="o">.</span><span class="n">num_bits_per_symbol</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_perfect_csi</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pusch_receiver</span> <span class="o">=</span> <span class="n">PUSCHReceiver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pusch_transmitter</span><span class="p">,</span>
                                                 <span class="n">mimo_detector</span><span class="o">=</span><span class="n">detector</span><span class="p">,</span>
                                                 <span class="n">input_domain</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">,</span>
                                                 <span class="n">channel_estimator</span><span class="o">=</span><span class="s2">&quot;perfect&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pusch_receiver</span> <span class="o">=</span> <span class="n">PUSCHReceiver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pusch_transmitter</span><span class="p">,</span>
                                                 <span class="n">mimo_detector</span><span class="o">=</span><span class="n">detector</span><span class="p">,</span>
                                                 <span class="n">input_domain</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">)</span>


        <span class="c1"># Configure the actual channel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_channel</span> <span class="o">=</span> <span class="n">OFDMChannel</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_channel_model</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_pusch_transmitter</span><span class="o">.</span><span class="n">resource_grid</span><span class="p">,</span>
                            <span class="n">normalize_channel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">return_channel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># XLA currently not supported by the CIRDataset function</span>
    <span class="nd">@tf</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">jit_compile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">ebno_db</span><span class="p">):</span>

        <span class="n">x</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pusch_transmitter</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
        <span class="n">no</span> <span class="o">=</span> <span class="n">ebnodb2no</span><span class="p">(</span><span class="n">ebno_db</span><span class="p">,</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">_pusch_transmitter</span><span class="o">.</span><span class="n">_num_bits_per_symbol</span><span class="p">,</span>
                       <span class="n">pusch_transmitter</span><span class="o">.</span><span class="n">_target_coderate</span><span class="p">,</span>
                       <span class="n">pusch_transmitter</span><span class="o">.</span><span class="n">resource_grid</span><span class="p">)</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">no</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_perfect_csi</span><span class="p">:</span>
            <span class="n">b_hat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pusch_receiver</span><span class="p">([</span><span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">no</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">b_hat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pusch_receiver</span><span class="p">([</span><span class="n">y</span><span class="p">,</span> <span class="n">no</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">b</span><span class="p">,</span> <span class="n">b_hat</span>
</pre></div>
</div>
</div>
<p>We now initialize the end-to-end model with the <code class="docutils literal notranslate"><span class="pre">CIRDataset</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ebno_db</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">e2e_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">channel_model</span><span class="p">,</span>
                  <span class="n">perfect_csi</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1"># bool</span>
                  <span class="n">detector</span><span class="o">=</span><span class="s2">&quot;lmmse&quot;</span><span class="p">)</span>  <span class="c1"># &quot;lmmse&quot;, &quot;kbest&quot;</span>

<span class="c1"># We can draw samples from the end-2-end link-level simulations</span>
<span class="n">b</span><span class="p">,</span> <span class="n">b_hat</span> <span class="o">=</span> <span class="n">e2e_model</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">ebno_db</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>And let’s run the final evaluation for different system configurations.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ebno_db</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># sim SNR range</span>
<span class="n">ber_plot</span> <span class="o">=</span> <span class="n">PlotBER</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Site-Specific MU-MIMO 5G NR PUSCH&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">detector</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lmmse&quot;</span><span class="p">,</span> <span class="s2">&quot;kbest&quot;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">perf_csi</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]:</span>
        <span class="n">e2e_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">channel_model</span><span class="p">,</span>
                          <span class="n">perfect_csi</span><span class="o">=</span><span class="n">perf_csi</span><span class="p">,</span>
                          <span class="n">detector</span><span class="o">=</span><span class="n">detector</span><span class="p">)</span>
        <span class="c1"># define legend</span>
        <span class="n">csi</span> <span class="o">=</span> <span class="s2">&quot;Perf. CSI&quot;</span> <span class="k">if</span> <span class="n">perf_csi</span> <span class="k">else</span> <span class="s2">&quot;Imperf. CSI&quot;</span>
        <span class="n">det</span> <span class="o">=</span> <span class="s2">&quot;K-Best&quot;</span> <span class="k">if</span> <span class="n">detector</span><span class="o">==</span><span class="s2">&quot;kbest&quot;</span> <span class="k">else</span> <span class="s2">&quot;LMMSE&quot;</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">det</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">csi</span>
        <span class="n">ber_plot</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span>
                    <span class="n">e2e_model</span><span class="p">,</span>
                    <span class="n">ebno_dbs</span><span class="o">=</span><span class="n">ebno_db</span><span class="p">,</span> <span class="c1"># SNR to simulate</span>
                    <span class="n">legend</span><span class="o">=</span><span class="n">l</span><span class="p">,</span> <span class="c1"># legend string for plotting</span>
                    <span class="n">max_mc_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
                    <span class="n">num_target_block_errors</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>
                    <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="c1"># batch-size per Monte Carlo run</span>
                    <span class="n">soft_estimates</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1"># the model returns hard-estimates</span>
                    <span class="n">early_stop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">show_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">add_bler</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">forward_keyboard_interrupt</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
EbNo [dB] |        BER |       BLER |  bit errors |    num bits | block errors |  num blocks | runtime [s] |    status
---------------------------------------------------------------------------------------------------------------------------------------
     -3.0 | 1.3044e-01 | 9.7163e-01 |     1354403 |    10383360 |         2021 |        2080 |        15.1 |reached target block errors
     -1.0 | 6.1308e-02 | 5.6194e-01 |     1101783 |    17971200 |         2023 |        3600 |         7.6 |reached target block errors
      1.0 | 3.4327e-02 | 2.8301e-01 |     1220094 |    35543040 |         2015 |        7120 |        14.7 |reached target block errors
      3.0 | 1.9063e-02 | 1.5870e-01 |     1202870 |    63098880 |         2006 |       12640 |        26.0 |reached target block errors
      5.0 | 1.1136e-02 | 9.3633e-02 |     1187394 |   106629120 |         2000 |       21360 |        43.7 |reached target block errors
      7.0 | 6.5732e-03 | 5.4113e-02 |     1212793 |   184504320 |         2000 |       36960 |        75.6 |reached target block errors
      9.0 | 3.8248e-03 | 3.2675e-02 |      763729 |   199680000 |         1307 |       40000 |        81.8 |reached max iter
     11.0 | 2.0157e-03 | 1.7300e-02 |      402504 |   199680000 |          692 |       40000 |        81.8 |reached max iter
     13.0 | 1.2349e-03 | 1.0500e-02 |      246578 |   199680000 |          420 |       40000 |        81.9 |reached max iter
     15.0 | 6.5825e-04 | 5.6000e-03 |      131439 |   199680000 |          224 |       40000 |        82.0 |reached max iter
     17.0 | 6.0718e-04 | 4.3250e-03 |      121242 |   199680000 |          173 |       40000 |        81.9 |reached max iter
EbNo [dB] |        BER |       BLER |  bit errors |    num bits | block errors |  num blocks | runtime [s] |    status
---------------------------------------------------------------------------------------------------------------------------------------
     -3.0 | 2.3005e-01 | 1.0000e+00 |     2296782 |     9984000 |         2000 |        2000 |        14.6 |reached target block errors
     -1.0 | 1.8133e-01 | 9.9760e-01 |     1882809 |    10383360 |         2075 |        2080 |         4.1 |reached target block errors
      1.0 | 1.2890e-01 | 9.5972e-01 |     1389944 |    10782720 |         2073 |        2160 |         4.2 |reached target block errors
      3.0 | 6.6731e-02 | 5.1505e-01 |     1305831 |    19568640 |         2019 |        3920 |         7.5 |reached target block errors
      5.0 | 4.0830e-02 | 3.0957e-01 |     1320784 |    32348160 |         2006 |        6480 |        12.5 |reached target block errors
      7.0 | 2.5047e-02 | 1.8835e-01 |     1330346 |    53114880 |         2004 |       10640 |        20.5 |reached target block errors
      9.0 | 1.5103e-02 | 1.1816e-01 |     1278691 |    84664320 |         2004 |       16960 |        32.7 |reached target block errors
     11.0 | 9.4176e-03 | 7.1225e-02 |     1320111 |   140175360 |         2000 |       28080 |        54.0 |reached target block errors
     13.0 | 5.7804e-03 | 4.3900e-02 |     1154231 |   199680000 |         1756 |       40000 |        77.1 |reached max iter
     15.0 | 3.6159e-03 | 2.9400e-02 |      722031 |   199680000 |         1176 |       40000 |        77.0 |reached max iter
     17.0 | 2.6598e-03 | 2.1375e-02 |      531111 |   199680000 |          855 |       40000 |        76.9 |reached max iter
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1727416034.582095  404870 device_compiler.h:186] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
EbNo [dB] |        BER |       BLER |  bit errors |    num bits | block errors |  num blocks | runtime [s] |    status
---------------------------------------------------------------------------------------------------------------------------------------
     -3.0 | 1.4539e-01 | 9.9663e-01 |     1509650 |    10383360 |         2073 |        2080 |        33.3 |reached target block errors
     -1.0 | 8.0750e-02 | 8.9554e-01 |      902955 |    11182080 |         2006 |        2240 |        23.0 |reached target block errors
      1.0 | 3.2724e-02 | 2.9762e-01 |     1097780 |    33546240 |         2000 |        6720 |        69.0 |reached target block errors
      3.0 | 1.6044e-02 | 1.3736e-01 |     1166131 |    72683520 |         2000 |       14560 |       149.6 |reached target block errors
      5.0 | 7.7006e-03 | 6.5609e-02 |     1174771 |   152555520 |         2005 |       30560 |       313.9 |reached target block errors
      7.0 | 2.7694e-03 | 2.3075e-02 |      552995 |   199680000 |          923 |       40000 |       410.9 |reached max iter
      9.0 | 9.6473e-04 | 8.7500e-03 |      192638 |   199680000 |          350 |       40000 |       410.7 |reached max iter
     11.0 | 3.2840e-04 | 2.5250e-03 |       65574 |   199680000 |          101 |       40000 |       410.6 |reached max iter
     13.0 | 2.0362e-04 | 1.4500e-03 |       40659 |   199680000 |           58 |       40000 |       410.6 |reached max iter
     15.0 | 1.3302e-04 | 1.0750e-03 |       26562 |   199680000 |           43 |       40000 |       410.4 |reached max iter
     17.0 | 2.9422e-05 | 5.2500e-04 |        5875 |   199680000 |           21 |       40000 |       410.6 |reached max iter
EbNo [dB] |        BER |       BLER |  bit errors |    num bits | block errors |  num blocks | runtime [s] |    status
---------------------------------------------------------------------------------------------------------------------------------------
     -3.0 | 2.4326e-01 | 1.0000e+00 |     2428727 |     9984000 |         2000 |        2000 |        32.1 |reached target block errors
     -1.0 | 1.9212e-01 | 1.0000e+00 |     1918113 |     9984000 |         2000 |        2000 |        20.5 |reached target block errors
      1.0 | 1.4095e-01 | 9.8510e-01 |     1463484 |    10383360 |         2049 |        2080 |        21.3 |reached target block errors
      3.0 | 7.9212e-02 | 7.1285e-01 |     1138826 |    14376960 |         2053 |        2880 |        29.5 |reached target block errors
      5.0 | 4.1720e-02 | 3.2308e-01 |     1299586 |    31150080 |         2016 |        6240 |        64.0 |reached target block errors
      7.0 | 2.1736e-02 | 1.6266e-01 |     1336789 |    61501440 |         2004 |       12320 |       126.4 |reached target block errors
      9.0 | 1.1747e-02 | 9.0423e-02 |     1304218 |   111022080 |         2011 |       22240 |       228.3 |reached target block errors
     11.0 | 5.8807e-03 | 4.4525e-02 |     1174264 |   199680000 |         1781 |       40000 |       410.5 |reached max iter
     13.0 | 3.6754e-03 | 2.7575e-02 |      733912 |   199680000 |         1103 |       40000 |       410.2 |reached max iter
     15.0 | 2.3447e-03 | 1.8450e-02 |      468195 |   199680000 |          738 |       40000 |       410.5 |reached max iter
     17.0 | 1.9887e-03 | 1.6000e-02 |      397104 |   199680000 |          640 |       40000 |       410.1 |reached max iter
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># and show figure</span>
<span class="n">ber_plot</span><span class="p">(</span><span class="n">show_bler</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_ber</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-4</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">17</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Sionna_Ray_Tracing_Introduction_90_0.png" src="../_images/examples_Sionna_Ray_Tracing_Introduction_90_0.png" />
</div>
</div>
</section>
<section id="Conclusion-and-Outlook">
<h2>Conclusion and Outlook<a class="headerlink" href="#Conclusion-and-Outlook" title="Link to this heading"></a></h2>
<p>In this notebook, you have learned how to use the Sionna RT module. We have seen how paths can be found in complex environments such as in the Munich scene. In a second step, we have calculated the effective CIRs from the paths and used them for link-level simulations.</p>
<p>There is one key feature of Sionna RT that was not discussed in this notebook: Automatic gradient computation. Like most components of Sionna, the ray tracer is differentiable with respect to most system parameters, such as radio materials, transmitter and receiver orientations, array geometries, positions, etc. This enables a whole new line of research which is discussed in the <a class="reference external" href="https://nvlabs.github.io/sionna/made_with_sionna.html#sionna-rt-differentiable-ray-tracing-for-radio-propagation-modeling">Sionna RT paper and the related
notebooks</a>.</p>
<p>Hopefully you have enjoyed this tutorial on Sionna’s RT module!</p>
<p>Please have a look at the <a class="reference external" href="https://nvlabs.github.io/sionna/api/sionna.html">API documentation</a> of the various components or the other available <a class="reference external" href="https://nvlabs.github.io/sionna/tutorials.html">tutorials</a> to learn more.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="DeepMIMO.html" class="btn btn-neutral float-left" title="Using the DeepMIMO Dataset with Sionna" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Sionna_Ray_Tracing_Diffraction.html" class="btn btn-neutral float-right" title="Tutorial on Diffraction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2024 NVIDIA CORPORATION.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>