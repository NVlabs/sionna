<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Channel &mdash; Sionna 0.8.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/sionna.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Orthogonal Frequency-Division Multiplexing (OFDM)" href="ofdm.html" />
    <link rel="prev" title="Mapping" href="mapping.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Sionna
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#installation-using-pip">Installation using pip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#docker-based-installation">Docker-based Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#installation-from-source">Installation from source</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/Hello_World.html">“Hello, world!”</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/Discover_Sionna.html">Discover Sionna</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/Discover_Sionna.html#Load-Required-Packages">Load Required Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/Discover_Sionna.html#Sionna-Data-flow-and-Design-Paradigms">Sionna Data-flow and Design Paradigms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/Discover_Sionna.html#Let’s-Get-Started---The-First-Layers-(Eager-Mode)">Let’s Get Started - The First Layers (<em>Eager Mode</em>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/Discover_Sionna.html#Batches-and-Multi-dimensional-Tensors">Batches and Multi-dimensional Tensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/Discover_Sionna.html#First-Link-level-Simulation">First Link-level Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/Discover_Sionna.html#Setting-up-the-End-to-end-Model">Setting up the End-to-end Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/Discover_Sionna.html#Run-some-Throughput-Tests-(Graph-Mode)">Run some Throughput Tests (Graph Mode)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/Discover_Sionna.html#Bit-Error-Rate-(BER)-Monte-Carlo-Simulations">Bit-Error Rate (BER) Monte-Carlo Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/Discover_Sionna.html#Conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#for-beginners">For Beginners</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/Sionna_tutorial_part1.html">Part 1: Getting Started with Sionna</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part1.html#Imports-&amp;-Basics">Imports &amp; Basics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part1.html#Sionna-Data-flow-and-Design-Paradigms">Sionna Data-flow and Design Paradigms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part1.html#Hello,-Sionna!">Hello, Sionna!</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part1.html#Communication-Systems-as-Keras-Models">Communication Systems as Keras Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part1.html#Forward-Error-Correction-(FEC)">Forward Error Correction (FEC)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part1.html#Eager-vs-Graph-Mode">Eager vs Graph Mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part1.html#Exercise">Exercise</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Sionna_tutorial_part2.html">Part 2: Differentiable Communication Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part2.html#Imports">Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part2.html#Gradient-Computation-Through-End-to-end-Systems">Gradient Computation Through End-to-end Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part2.html#Creating-Custom-Layers">Creating Custom Layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part2.html#Setting-up-Training-Loops">Setting up Training Loops</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Sionna_tutorial_part3.html">Part 3: Advanced Link-level Simulations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part3.html#Imports">Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part3.html#OFDM-Resource-Grid-and-Stream-Management">OFDM Resource Grid and Stream Management</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Sionna_tutorial_part3.html#Stream-Management">Stream Management</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Sionna_tutorial_part3.html#OFDM-Resource-Grid">OFDM Resource Grid</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part3.html#Antenna-Arrays">Antenna Arrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part3.html#Channel-Model">Channel Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part3.html#Uplink-Transmission-in-the-Frequency-Domain">Uplink Transmission in the Frequency Domain</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Sionna_tutorial_part4.html">Part 4: Toward Learned Receivers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part4.html#Imports">Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part4.html#Simulation-Parameters">Simulation Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part4.html#Implemention-of-an-Advanced-Neural-Receiver">Implemention of an Advanced Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part4.html#Training-the-Neural-Receiver">Training the Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part4.html#Benchmarking-the-Neural-Receiver">Benchmarking the Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part4.html#Conclusion">Conclusion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part4.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Simple_MIMO_Simulation.html">Basic MIMO Simulations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Simple_MIMO_Simulation.html#Table-of-Contents">Table of Contents</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Simple_MIMO_Simulation.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Simple_MIMO_Simulation.html#Simple-uncoded-transmission">Simple uncoded transmission</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Simple_MIMO_Simulation.html#Adding-spatial-correlation">Adding spatial correlation</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Simple_MIMO_Simulation.html#Extension-to-channel-coding">Extension to channel coding</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Simple_MIMO_Simulation.html#BER-simulations-using-a-Keras-model">BER simulations using a Keras model</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#for-experts">For Experts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html">5G Channel Coding and Rate-Matching: Polar vs. LDPC Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#BER-Performance-of-5G-Coding-Schemes">BER Performance of 5G Coding Schemes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#A-Deeper-Look-into-the-Polar-Code-Module">A Deeper Look into the Polar Code Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#Rate-Matching-and-Rate-Recovery">Rate-Matching and Rate-Recovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#Throughput-and-Decoding-Complexity">Throughput and Decoding Complexity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html">Bit-Interleaved Coded Modulation (BICM)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#System-Block-Diagram">System Block Diagram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#A-Simple-BICM-System">A Simple BICM System</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#Constellations-and-Bit-Channels">Constellations and Bit-Channels</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#Simple-BER-Simulations">Simple BER Simulations</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#All-zero-Codeword-Simulations">All-zero Codeword Simulations</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#Remove-Encoder:-Simulate-QPSK-with-All-zero-Codeword-Transmission">Remove Encoder: Simulate QPSK with All-zero Codeword Transmission</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#Remove-(De-)Mapping:-Approximate-the-LLR-Distribution-of-the-All-zero-Codeword-(and-BPSK/QPSK)">Remove (De-)Mapping: Approximate the LLR Distribution of the All-zero Codeword (and BPSK/QPSK)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#The-Role-of-the-Scrambler">The Role of the Scrambler</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#EXIT-Charts">EXIT Charts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#Mismatched-Demapping-and-the-Advantages-of-Min-sum-Decoding">Mismatched Demapping and the Advantages of Min-sum Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html">MIMO OFDM Transmissions over the CDL Channel Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Table-of-Contents">Table of Contents</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#System-Setup">System Setup</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Stream-Management">Stream Management</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#OFDM-Resource-Grid-&amp;-Pilot-Pattern">OFDM Resource Grid &amp; Pilot Pattern</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Antenna-Arrays">Antenna Arrays</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#CDL-Channel-Model">CDL Channel Model</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Other-Physical-Layer-Components">Other Physical Layer Components</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Simulations">Simulations</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Uplink-Transmission-in-the-Frequency-Domain">Uplink Transmission in the Frequency Domain</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Uplink-Transmission-in-the-Time-Domain">Uplink Transmission in the Time Domain</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Downlink-Transmission-in-the-Frequency-Domain">Downlink Transmission in the Frequency Domain</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Understand-the-Difference-Between-the-CDL-Models">Understand the Difference Between the CDL Models</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Create-an-End-to-End-Keras-Model">Create an End-to-End Keras Model</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Compare-Uplink-Performance-Over-the-Different-CDL-Models">Compare Uplink Performance Over the Different CDL Models</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Compare-Downlink-Performance-Over-the-Different-CDL-Models">Compare Downlink Performance Over the Different CDL Models</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Evaluate-the-Impact-of-Mobility">Evaluate the Impact of Mobility</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Evaluate-the-Impact-of-Insufficient-Cyclic-Prefix-Length">Evaluate the Impact of Insufficient Cyclic Prefix Length</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Neural_Receiver.html">Neural Receiver for OFDM SIMO Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Neural_Receiver.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Neural_Receiver.html#Simulation-Parameters">Simulation Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Neural_Receiver.html#Neural-Receiver">Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Neural_Receiver.html#End-to-end-System">End-to-end System</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Neural_Receiver.html#End-to-end-System-as-a-Keras-Model">End-to-end System as a Keras Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Neural_Receiver.html#Evaluation-of-the-Baselines">Evaluation of the Baselines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Neural_Receiver.html#Training-the-Neural-Receiver">Training the Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Neural_Receiver.html#Evaluation-of-the-Neural-Receiver">Evaluation of the Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Neural_Receiver.html#Pre-computed-Results">Pre-computed Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Neural_Receiver.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Realistic_Multiuser_MIMO_Simulations.html">Realistic Multiuser MIMO OFDM Simulations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Realistic_Multiuser_MIMO_Simulations.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Realistic_Multiuser_MIMO_Simulations.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Realistic_Multiuser_MIMO_Simulations.html#System-Setup">System Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Realistic_Multiuser_MIMO_Simulations.html#Uplink-Transmissions-in-the-Frequency-Domain">Uplink Transmissions in the Frequency Domain</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Realistic_Multiuser_MIMO_Simulations.html#Compare-Estimated-and-Actual-Frequency-Responses">Compare Estimated and Actual Frequency Responses</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Realistic_Multiuser_MIMO_Simulations.html#Understand-the-Difference-Between-the-Channel-Models">Understand the Difference Between the Channel Models</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Realistic_Multiuser_MIMO_Simulations.html#Setup-a-Keras-Model-for-BER-simulations">Setup a Keras Model for BER simulations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Autoencoder.html">End-to-end Learning with Autoencoders</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Autoencoder.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Autoencoder.html#Simulation-Parameters">Simulation Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Autoencoder.html#Neural-Demapper">Neural Demapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Autoencoder.html#Trainable-End-to-end-System:-Conventional-Training">Trainable End-to-end System: Conventional Training</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Autoencoder.html#Trainable-End-to-end-System:-RL-based-Training">Trainable End-to-end System: RL-based Training</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Autoencoder.html#Evaluation">Evaluation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Autoencoder.html#Visualizing-the-Learned-Constellations">Visualizing the Learned Constellations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Autoencoder.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html">Weighted Belief Propagation Decoding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html#Weighted-BP-for-BCH-Codes">Weighted BP for BCH Codes</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html#Weights-before-Training-and-Simulation-of-BER">Weights <em>before</em> Training and Simulation of BER</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html#Training">Training</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html#Results">Results</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html#Further-Experiments">Further Experiments</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html#Damped-BP">Damped BP</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html#Learning-the-5G-LDPC-Code">Learning the 5G LDPC Code</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/CIR_Dataset.html">Channel Models from Datasets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/CIR_Dataset.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/CIR_Dataset.html#Simulation-Parameters">Simulation Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/CIR_Dataset.html#Creating-a-Simple-Dataset">Creating a Simple Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/CIR_Dataset.html#Generators">Generators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/CIR_Dataset.html#Use-the-Channel-Model-for-OFDM-Transmissions">Use the Channel Model for OFDM Transmissions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="sionna.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="fec.html">Forward Error Correction (FEC)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="fec.ldpc.html">Low-Density Parity-Check (LDPC)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fec.ldpc.html#encoder">Encoder</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.ldpc.html#ldpc5gencoder">LDPC5GEncoder</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.ldpc.html#allzeroencoder">AllZeroEncoder</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="fec.ldpc.html#decoder">Decoder</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.ldpc.html#ldpcbpdecoder">LDPCBPDecoder</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.ldpc.html#ldpc5gdecoder">LDPC5GDecoder</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fec.polar.html">Polar Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fec.polar.html#polar-encoding">Polar Encoding</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.polar.html#polar5gencoder">Polar5GEncoder</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.polar.html#polarencoder">PolarEncoder</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="fec.polar.html#polar-decoding">Polar Decoding</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.polar.html#polar5gdecoder">Polar5GDecoder</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.polar.html#polarscdecoder">PolarSCDecoder</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.polar.html#polarscldecoder">PolarSCLDecoder</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.polar.html#polarbpdecoder">PolarBPDecoder</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="fec.polar.html#polar-utility-functions">Polar Utility Functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.polar.html#generate-5g-ranking">generate_5g_ranking</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.polar.html#generate-polar-transform-mat">generate_polar_transform_mat</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.polar.html#generate-rm-code">generate_rm_code</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fec.conv.html">Convolutional Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fec.conv.html#convolutional-encoding">Convolutional Encoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="fec.conv.html#viterbi-decoding">Viterbi Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="fec.conv.html#convolutional-code-utility-functions">Convolutional Code Utility Functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.conv.html#trellis">Trellis</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.conv.html#polynomial-selector">polynomial_selector</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fec.crc.html">Cyclic Redundancy Check (CRC)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fec.crc.html#crcencoder">CRCEncoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="fec.crc.html#crcdecoder">CRCDecoder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fec.interleaving.html">Interleaving</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fec.interleaving.html#interleaver">Interleaver</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.interleaving.html#rowcolumninterleaver">RowColumnInterleaver</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.interleaving.html#randominterleaver">RandomInterleaver</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="fec.interleaving.html#deinterleaver">Deinterleaver</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fec.scrambling.html">Scrambling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fec.scrambling.html#scrambler">Scrambler</a></li>
<li class="toctree-l4"><a class="reference internal" href="fec.scrambling.html#descrambler">Descrambler</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fec.utils.html">FEC Utility Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fec.utils.html#exit-analysis">EXIT Analysis</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#plot-exit-chart">plot_exit_chart</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#get-exit-analytic">get_exit_analytic</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#plot-trajectory">plot_trajectory</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="fec.utils.html#miscellaneous">Miscellaneous</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#gaussianpriorsource">GaussianPriorSource</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#load-parity-check-examples">load_parity_check_examples</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#alist2mat">alist2mat</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#load-alist">load_alist</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#bin2int">bin2int</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#int2bin">int2bin</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#bin2int-tf">bin2int_tf</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#int2bin-tf">int2bin_tf</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#llr2mi">llr2mi</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#j-fun">j_fun</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#j-fun-inv">j_fun_inv</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#j-fun-tf">j_fun_tf</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#j-fun-inv-tf">j_fun_inv_tf</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mapping.html">Mapping</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mapping.html#constellations">Constellations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#constellation">Constellation</a></li>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#qam">qam</a></li>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#pam">pam</a></li>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#pam-gray">pam_gray</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mapping.html#mapper">Mapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="mapping.html#demapping">Demapping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#demapper">Demapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#demapperwithprior">DemapperWithPrior</a></li>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#symboldemapper">SymbolDemapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#symboldemapperwithprior">SymbolDemapperWithPrior</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Channel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#awgn">AWGN</a></li>
<li class="toctree-l3"><a class="reference internal" href="#flat-fading-channel">Flat-fading channel</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#flatfadingchannel">FlatFadingChannel</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generateflatfadingchannel">GenerateFlatFadingChannel</a></li>
<li class="toctree-l4"><a class="reference internal" href="#applyflatfadingchannel">ApplyFlatFadingChannel</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spatialcorrelation">SpatialCorrelation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#kroneckermodel">KroneckerModel</a></li>
<li class="toctree-l4"><a class="reference internal" href="#percolumnmodel">PerColumnModel</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#channel-model-interface">Channel model interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="#time-domain-channel">Time domain channel</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#timechannel">TimeChannel</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generatetimechannel">GenerateTimeChannel</a></li>
<li class="toctree-l4"><a class="reference internal" href="#applytimechannel">ApplyTimeChannel</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cir-to-time-channel">cir_to_time_channel</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#channel-with-ofdm-waveform">Channel with OFDM waveform</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ofdmchannel">OFDMChannel</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generateofdmchannel">GenerateOFDMChannel</a></li>
<li class="toctree-l4"><a class="reference internal" href="#applyofdmchannel">ApplyOFDMChannel</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cir-to-ofdm-channel">cir_to_ofdm_channel</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rayleigh-block-fading">Rayleigh block fading</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gpp-38-901-channel-models">3GPP 38.901 channel models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#panelarray">PanelArray</a></li>
<li class="toctree-l4"><a class="reference internal" href="#antenna">Antenna</a></li>
<li class="toctree-l4"><a class="reference internal" href="#antennaarray">AntennaArray</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tapped-delay-line-tdl">Tapped delay line (TDL)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#clustered-delay-line-cdl">Clustered delay line (CDL)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#urban-microcell-umi">Urban microcell (UMi)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#urban-macrocell-uma">Urban macrocell (UMa)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rural-macrocell-rma">Rural macrocell (RMa)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#external-datasets">External datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#utility-functions">Utility functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#subcarrier-frequencies">subcarrier_frequencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#time-lag-discrete-time-channel">time_lag_discrete_time_channel</a></li>
<li class="toctree-l4"><a class="reference internal" href="#deg-2-rad">deg_2_rad</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rad-2-deg">rad_2_deg</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wrap-angle-0-360">wrap_angle_0_360</a></li>
<li class="toctree-l4"><a class="reference internal" href="#drop-uts-in-sector">drop_uts_in_sector</a></li>
<li class="toctree-l4"><a class="reference internal" href="#relocate-uts">relocate_uts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#set-3gpp-scenario-parameters">set_3gpp_scenario_parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gen-single-sector-topology">gen_single_sector_topology</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gen-single-sector-topology-interferers">gen_single_sector_topology_interferers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exp-corr-mat">exp_corr_mat</a></li>
<li class="toctree-l4"><a class="reference internal" href="#one-ring-corr-mat">one_ring_corr_mat</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ofdm.html">Orthogonal Frequency-Division Multiplexing (OFDM)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ofdm.html#resource-grid">Resource Grid</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ofdm.html#resourcegrid">ResourceGrid</a></li>
<li class="toctree-l4"><a class="reference internal" href="ofdm.html#resourcegridmapper">ResourceGridMapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="ofdm.html#resourcegriddemapper">ResourceGridDemapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="ofdm.html#removenulledsubcarriers">RemoveNulledSubcarriers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ofdm.html#modulation-demodulation">Modulation &amp; Demodulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ofdm.html#ofdmmodulator">OFDMModulator</a></li>
<li class="toctree-l4"><a class="reference internal" href="ofdm.html#ofdmdemodulator">OFDMDemodulator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ofdm.html#pilot-pattern">Pilot Pattern</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ofdm.html#pilotpattern">PilotPattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="ofdm.html#emptypilotpattern">EmptyPilotPattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="ofdm.html#kroneckerpilotpattern">KroneckerPilotPattern</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ofdm.html#channel-estimation">Channel Estimation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ofdm.html#lschannelestimator">LSChannelEstimator</a></li>
<li class="toctree-l4"><a class="reference internal" href="ofdm.html#nearestneighborinterpolator">NearestNeighborInterpolator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ofdm.html#precoding">Precoding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ofdm.html#zfprecoder">ZFPrecoder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ofdm.html#equalization">Equalization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ofdm.html#lmmseequalizer">LMMSEEqualizer</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mimo.html">Multiple-Input Multiple-Output (MIMO)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mimo.html#stream-management">Stream Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="mimo.html#precoding">Precoding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#zero-forcing-precoder">zero_forcing_precoder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mimo.html#equalization">Equalization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#lmmse-equalizer">lmmse_equalizer</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">Utility Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="utils.html#metrics">Metrics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="utils.html#biterrorrate">BitErrorRate</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#bitwisemutualinformation">BitwiseMutualInformation</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#compute-ber">compute_ber</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#compute-bler">compute_bler</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#compute-ser">compute_ser</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#count-errors">count_errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#count-block-errors">count_block_errors</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#tensors">Tensors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="utils.html#expand-to-rank">expand_to_rank</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#flatten-dims">flatten_dims</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#flatten-last-dims">flatten_last_dims</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#insert-dims">insert_dims</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#split-dims">split_dims</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#matrix-sqrt">matrix_sqrt</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#matrix-sqrt-inv">matrix_sqrt_inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#matrix-inv">matrix_inv</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#miscellaneous">Miscellaneous</a><ul>
<li class="toctree-l4"><a class="reference internal" href="utils.html#binarysource">BinarySource</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#qamsource">QAMSource</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#plotber">PlotBER</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#sim-ber">sim_ber</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#ebnodb2no">ebnodb2no</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#hard-decisions">hard_decisions</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#plot-ber">plot_ber</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#complex-normal">complex_normal</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#fft">fft</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#ifft">ifft</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#log2">log2</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#log10">log10</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#empirical-psd">empirical_psd</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="config.html">Configuration</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Sionna</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="sionna.html">API Documentation</a> &raquo;</li>
      <li>Channel</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="channel">
<h1>Channel<a class="headerlink" href="#channel" title="Permalink to this headline"></a></h1>
<p>This module provides layers and functions that implement channel models.
Models currently available include <a class="reference internal" href="#sionna.channel.AWGN" title="sionna.channel.AWGN"><code class="xref py py-class docutils literal notranslate"><span class="pre">AWGN</span></code></a>, <a class="reference internal" href="#flat-fading"><span class="std std-ref">flat-fading</span></a> with (optional) <a class="reference internal" href="#sionna.channel.SpatialCorrelation" title="sionna.channel.SpatialCorrelation"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpatialCorrelation</span></code></a>, <a class="reference internal" href="#sionna.channel.RayleighBlockFading" title="sionna.channel.RayleighBlockFading"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayleighBlockFading</span></code></a>, as well as models from the 3rd Generation Partnership Project (3GPP) <a class="reference internal" href="#tr38901" id="id1"><span>[TR38901]</span></a>: <a class="reference internal" href="#tdl"><span class="std std-ref">TDL</span></a>, <a class="reference internal" href="#cdl"><span class="std std-ref">CDL</span></a>, <a class="reference internal" href="#umi"><span class="std std-ref">UMi</span></a>, <a class="reference internal" href="#uma"><span class="std std-ref">UMa</span></a>, and <a class="reference internal" href="#rma"><span class="std std-ref">RMa</span></a>. It is also possible to <a class="reference internal" href="#external-datasets"><span class="std std-ref">use externally generated CIRs</span></a>.</p>
<p>Apart from <a class="reference internal" href="#flat-fading"><span class="std std-ref">flat-fading</span></a>, all of these models generate channel impulse responses (CIRs) that can then be used to
implement a channel transfer function in the <a class="reference internal" href="#time-domain"><span class="std std-ref">time domain</span></a> or
<a class="reference internal" href="#ofdm-waveform"><span class="std std-ref">assuming an OFDM waveform</span></a>.</p>
<p>This is achieved using the different functions, classes, and Keras layers which
operate as shown in the figures below.</p>
<div class="figure align-center" id="id29">
<img alt="../_images/channel_arch_time.png" src="../_images/channel_arch_time.png" />
<p class="caption"><span class="caption-text">Channel module architecture for time domain simulations.</span><a class="headerlink" href="#id29" title="Permalink to this image"></a></p>
</div>
<div class="figure align-center" id="id30">
<img alt="../_images/channel_arch_freq.png" src="../_images/channel_arch_freq.png" />
<p class="caption"><span class="caption-text">Channel module architecture for simulations assuming OFDM waveform.</span><a class="headerlink" href="#id30" title="Permalink to this image"></a></p>
</div>
<p>A channel model generate CIRs from which channel responses in the time domain
or in the frequency domain are computed using the
<a class="reference internal" href="#sionna.channel.cir_to_time_channel" title="sionna.channel.cir_to_time_channel"><code class="xref py py-func docutils literal notranslate"><span class="pre">cir_to_time_channel()</span></code></a> or
<a class="reference internal" href="#sionna.channel.cir_to_ofdm_channel" title="sionna.channel.cir_to_ofdm_channel"><code class="xref py py-func docutils literal notranslate"><span class="pre">cir_to_ofdm_channel()</span></code></a> functions, respectively.
If one does not need access to the raw CIRs, the
<a class="reference internal" href="#sionna.channel.GenerateTimeChannel" title="sionna.channel.GenerateTimeChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenerateTimeChannel</span></code></a> and
<a class="reference internal" href="#sionna.channel.GenerateOFDMChannel" title="sionna.channel.GenerateOFDMChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenerateOFDMChannel</span></code></a> classes can be used to conveniently
sample CIRs and generate channel responses in the desired domain.</p>
<p>Once the channel responses in the time or frequency domain are computed, they
can be applied to the channel input using the
<a class="reference internal" href="#sionna.channel.ApplyTimeChannel" title="sionna.channel.ApplyTimeChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ApplyTimeChannel</span></code></a> or
<a class="reference internal" href="#sionna.channel.ApplyOFDMChannel" title="sionna.channel.ApplyOFDMChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ApplyOFDMChannel</span></code></a> Keras layers.</p>
<p>The following code snippets show how to setup and run a Rayleigh block fading
model assuming an OFDM waveform, and without accessing the CIRs or
channel responses.
This is the easiest way to setup a channel model.
Setting-up other models is done in a similar way, except for
<a class="reference internal" href="#sionna.channel.AWGN" title="sionna.channel.AWGN"><code class="xref py py-class docutils literal notranslate"><span class="pre">AWGN</span></code></a> (see the <a class="reference internal" href="#sionna.channel.AWGN" title="sionna.channel.AWGN"><code class="xref py py-class docutils literal notranslate"><span class="pre">AWGN</span></code></a>
class documentation).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">rayleigh</span> <span class="o">=</span> <span class="n">RayleighBlockFading</span><span class="p">(</span><span class="n">num_rx</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                               <span class="n">num_rx_ant</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
                               <span class="n">num_tx</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
                               <span class="n">num_tx_ant</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">channel</span>  <span class="o">=</span> <span class="n">OFDMChannel</span><span class="p">(</span><span class="n">channel_model</span> <span class="o">=</span> <span class="n">rayleigh</span><span class="p">,</span>
                       <span class="n">resource_grid</span> <span class="o">=</span> <span class="n">rg</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">rg</span></code> is an instance of <a class="reference internal" href="ofdm.html#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>.</p>
<p>Running the channel model is done as follows:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># x is the channel input</span>
<span class="c1"># no is the noise variance</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">channel</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">no</span><span class="p">])</span>
</pre></div>
</div>
<p>To use the time domain representation of the channel, one can use
<a class="reference internal" href="#sionna.channel.TimeChannel" title="sionna.channel.TimeChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeChannel</span></code></a> instead of
<a class="reference internal" href="#sionna.channel.OFDMChannel" title="sionna.channel.OFDMChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">OFDMChannel</span></code></a>.</p>
<p>If access to the channel responses is needed, one can separate their
generation from their application to the channel input by setting up the channel
model as follows:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">rayleigh</span> <span class="o">=</span> <span class="n">RayleighBlockFading</span><span class="p">(</span><span class="n">num_rx</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                               <span class="n">num_rx_ant</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
                               <span class="n">num_tx</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
                               <span class="n">num_tx_ant</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">generate_channel</span> <span class="o">=</span> <span class="n">GenerateOFDMChannel</span><span class="p">(</span><span class="n">channel_model</span> <span class="o">=</span> <span class="n">rayleigh</span><span class="p">,</span>
                                       <span class="n">resource_grid</span> <span class="o">=</span> <span class="n">rg</span><span class="p">)</span>

<span class="n">apply_channel</span> <span class="o">=</span> <span class="n">ApplyOFDMChannel</span><span class="p">()</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">rg</span></code> is an instance of <a class="reference internal" href="ofdm.html#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>.
Running the channel model is done as follows:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate a batch of channel responses</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">generate_channel</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
<span class="c1"># Apply the channel</span>
<span class="c1"># x is the channel input</span>
<span class="c1"># no is the noise variance</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">apply_channel</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">no</span><span class="p">])</span>
</pre></div>
</div>
<p>Generating and applying the channel in the time domain can be achieved by using
<a class="reference internal" href="#sionna.channel.GenerateTimeChannel" title="sionna.channel.GenerateTimeChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenerateTimeChannel</span></code></a> and
<a class="reference internal" href="#sionna.channel.ApplyTimeChannel" title="sionna.channel.ApplyTimeChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ApplyTimeChannel</span></code></a> instead of
<a class="reference internal" href="#sionna.channel.GenerateOFDMChannel" title="sionna.channel.GenerateOFDMChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenerateOFDMChannel</span></code></a> and
<a class="reference internal" href="#sionna.channel.ApplyOFDMChannel" title="sionna.channel.ApplyOFDMChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ApplyOFDMChannel</span></code></a>, respectively.</p>
<p>To access the CIRs, setting up the channel can be done as follows:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">rayleigh</span> <span class="o">=</span> <span class="n">RayleighBlockFading</span><span class="p">(</span><span class="n">num_rx</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                               <span class="n">num_rx_ant</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
                               <span class="n">num_tx</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
                               <span class="n">num_tx_ant</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">apply_channel</span> <span class="o">=</span> <span class="n">ApplyOFDMChannel</span><span class="p">()</span>
</pre></div>
</div>
<p>and running the channel model as follows:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">cir</span> <span class="o">=</span> <span class="n">rayleigh</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">cir_to_ofdm_channel</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="o">*</span><span class="n">cir</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">apply_channel</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">no</span><span class="p">])</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">frequencies</span></code> are the subcarrier frequencies in the baseband, which can
be computed using the <a class="reference internal" href="#sionna.channel.subcarrier_frequencies" title="sionna.channel.subcarrier_frequencies"><code class="xref py py-func docutils literal notranslate"><span class="pre">subcarrier_frequencies()</span></code></a> utility
function.</p>
<p>Applying the channel in the time domain can be done by using
<a class="reference internal" href="#sionna.channel.cir_to_time_channel" title="sionna.channel.cir_to_time_channel"><code class="xref py py-func docutils literal notranslate"><span class="pre">cir_to_time_channel()</span></code></a> and
<a class="reference internal" href="#sionna.channel.ApplyTimeChannel" title="sionna.channel.ApplyTimeChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ApplyTimeChannel</span></code></a> instead of
<a class="reference internal" href="#sionna.channel.cir_to_ofdm_channel" title="sionna.channel.cir_to_ofdm_channel"><code class="xref py py-func docutils literal notranslate"><span class="pre">cir_to_ofdm_channel()</span></code></a> and
<a class="reference internal" href="#sionna.channel.ApplyOFDMChannel" title="sionna.channel.ApplyOFDMChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ApplyOFDMChannel</span></code></a>, respectively.</p>
<p>For the purpose of the present document, the following symbols apply:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 76%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(N_T (u)\)</span></p></td>
<td><p>Number of transmitters (transmitter index)</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(N_R (v)\)</span></p></td>
<td><p>Number of receivers (receiver index)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(N_{TA} (k)\)</span></p></td>
<td><p>Number of antennas per transmitter (transmit antenna index)</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(N_{RA} (l)\)</span></p></td>
<td><p>Number of antennas per receiver (receive antenna index)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(N_S (s)\)</span></p></td>
<td><p>Number of OFDM symbols (OFDM symbol index)</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(N_F (n)\)</span></p></td>
<td><p>Number of subcarriers (subcarrier index)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(N_B (b)\)</span></p></td>
<td><p>Number of time samples forming the channel input (baseband symbol index)</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(L_{\text{min}}\)</span></p></td>
<td><p>Smallest time-lag for the discrete complex baseband channel</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(L_{\text{max}}\)</span></p></td>
<td><p>Largest time-lag for the discrete complex baseband channel</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(M (m)\)</span></p></td>
<td><p>Number of paths (clusters) forming a power delay profile (path index)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\tau_m(t)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(m^{th}\)</span> path (cluster) delay at time step <span class="math notranslate nohighlight">\(t\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(a_m(t)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(m^{th}\)</span> path (cluster) complex coefficient at time step <span class="math notranslate nohighlight">\(t\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\Delta_f\)</span></p></td>
<td><p>Subcarrier spacing</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(W\)</span></p></td>
<td><p>Bandwidth</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(N_0\)</span></p></td>
<td><p>Noise variance</p></td>
</tr>
</tbody>
</table>
<p>All transmitters are equipped with <span class="math notranslate nohighlight">\(N_{TA}\)</span> antennas and all receivers
with <span class="math notranslate nohighlight">\(N_{RA}\)</span> antennas.</p>
<p>A channel model, such as <a class="reference internal" href="#sionna.channel.RayleighBlockFading" title="sionna.channel.RayleighBlockFading"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayleighBlockFading</span></code></a> or
<a class="reference internal" href="#sionna.channel.tr38901.UMi" title="sionna.channel.tr38901.UMi"><code class="xref py py-class docutils literal notranslate"><span class="pre">UMi</span></code></a>, is used to generate for each link between
antenna <span class="math notranslate nohighlight">\(k\)</span> of transmitter <span class="math notranslate nohighlight">\(u\)</span> and antenna <span class="math notranslate nohighlight">\(l\)</span> of receiver
<span class="math notranslate nohighlight">\(v\)</span> a power delay profile
<span class="math notranslate nohighlight">\((a_{u, k, v, l, m}(t), \tau_{u, v, m}), 0 \leq m \leq M-1\)</span>.
The delays are assumed not to depend on time <span class="math notranslate nohighlight">\(t\)</span>, and transmit and receive
antennas <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(l\)</span>.
Such a power delay profile corresponds to the channel impulse response</p>
<div class="math notranslate nohighlight">
\[h_{u, k, v, l}(t,\tau) =
\sum_{m=0}^{M-1} a_{u, k, v, l,m}(t) \delta(\tau - \tau_{u, v, m})\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta(\cdot)\)</span> is the Dirac delta measure.
For example, in the case of Rayleigh block fading, the power delay profiles are
time-invariant and such that for every link <span class="math notranslate nohighlight">\((u, k, v, l)\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
   M                     &amp;= 1\\
   \tau_{u, v, 0}  &amp;= 0\\
   a_{u, k, v, l, 0}     &amp;\sim \mathcal{CN}(0,1).
\end{align}\end{split}\]</div>
<p>3GPP channel models use the procedure depicted in <a class="reference internal" href="#tr38901" id="id2"><span>[TR38901]</span></a> to generate power
delay profiles. With these models, the power delay profiles are time-<em>variant</em>
in the event of mobility.</p>
<div class="section" id="awgn">
<h2>AWGN<a class="headerlink" href="#awgn" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.AWGN">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">AWGN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/awgn.html#AWGN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.AWGN" title="Permalink to this definition"></a></dt>
<dd><p>Add complex AWGN to the inputs with a certain variance.</p>
<p>This class inherits from the Keras <cite>Layer</cite> class and can be used as layer in
a Keras model.</p>
<p>This layer adds complex AWGN noise with variance <code class="docutils literal notranslate"><span class="pre">no</span></code> to the input.
The noise has variance <code class="docutils literal notranslate"><span class="pre">no/2</span></code> per real dimension.
It can be either a scalar or a tensor which can be broadcast to the shape
of the input.</p>
<p class="rubric">Example</p>
<p>Setting-up:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">awgn_channel</span> <span class="o">=</span> <span class="n">AWGN</span><span class="p">()</span>
</pre></div>
</div>
<p>Running:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># x is the channel input</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># no is the noise variance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">awgn_channel</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">no</span><span class="p">))</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dtype</strong> (<em>Complex tf.DType</em>) – Defines the datatype for internal calculations and the output
dtype. Defaults to <cite>tf.complex64</cite>.</p>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(x, no)</strong> – Tuple:</p></li>
<li><p><strong>x</strong> (<em>Tensor, tf.complex</em>) – Channel input</p></li>
<li><p><strong>no</strong> (<em>Scalar or Tensor, tf.float</em>) – Scalar or tensor whose shape can be broadcast to the shape of <code class="docutils literal notranslate"><span class="pre">x</span></code>.
The noise power <code class="docutils literal notranslate"><span class="pre">no</span></code> is per complex dimension. If <code class="docutils literal notranslate"><span class="pre">no</span></code> is a
scalar, noise of the same variance will be added to the input.
If <code class="docutils literal notranslate"><span class="pre">no</span></code> is a tensor, it must have a shape that can be broadcast to
the shape of <code class="docutils literal notranslate"><span class="pre">x</span></code>. This allows, e.g., adding noise of different
variance to each example in a batch. If <code class="docutils literal notranslate"><span class="pre">no</span></code> has a lower rank than
<code class="docutils literal notranslate"><span class="pre">x</span></code>, then <code class="docutils literal notranslate"><span class="pre">no</span></code> will be broadcast to the shape of <code class="docutils literal notranslate"><span class="pre">x</span></code> by adding
dummy dimensions after the last axis.</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><p><strong>y</strong> (Tensor with same shape as <code class="docutils literal notranslate"><span class="pre">x</span></code>, tf.complex) – Channel output</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="flat-fading-channel">
<span id="flat-fading"></span><h2>Flat-fading channel<a class="headerlink" href="#flat-fading-channel" title="Permalink to this headline"></a></h2>
<div class="section" id="flatfadingchannel">
<h3>FlatFadingChannel<a class="headerlink" href="#flatfadingchannel" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.FlatFadingChannel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">FlatFadingChannel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_tx_ant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rx_ant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_corr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_awgn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/flat_fading_channel.html#FlatFadingChannel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.FlatFadingChannel" title="Permalink to this definition"></a></dt>
<dd><p>Applies random channel matrices to a vector input and adds AWGN.</p>
<p>This class combines <a class="reference internal" href="#sionna.channel.GenerateFlatFadingChannel" title="sionna.channel.GenerateFlatFadingChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenerateFlatFadingChannel</span></code></a> and
<a class="reference internal" href="#sionna.channel.ApplyFlatFadingChannel" title="sionna.channel.ApplyFlatFadingChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ApplyFlatFadingChannel</span></code></a> and computes the output of
a flat-fading channel with AWGN.</p>
<p>For a given batch of input vectors <span class="math notranslate nohighlight">\(\mathbf{x}\in\mathbb{C}^{K}\)</span>,
the output is</p>
<div class="math notranslate nohighlight">
\[\mathbf{y} = \mathbf{H}\mathbf{x} + \mathbf{n}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{H}\in\mathbb{C}^{M\times K}\)</span> are randomly generated
flat-fading channel matrices and
<span class="math notranslate nohighlight">\(\mathbf{n}\in\mathbb{C}^{M}\sim\mathcal{CN}(0, N_o\mathbf{I})\)</span>
is an AWGN vector that is optionally added.</p>
<p>A <a class="reference internal" href="#sionna.channel.SpatialCorrelation" title="sionna.channel.SpatialCorrelation"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpatialCorrelation</span></code></a> can be configured and the
channel realizations optionally returned. This is useful to simulate
receiver algorithms with perfect channel knowledge.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_tx_ant</strong> (<em>int</em>) – Number of transmit antennas.</p></li>
<li><p><strong>num_rx_ant</strong> (<em>int</em>) – Number of receive antennas.</p></li>
<li><p><strong>spatial_corr</strong> (<a class="reference internal" href="#sionna.channel.SpatialCorrelation" title="sionna.channel.SpatialCorrelation"><em>SpatialCorrelation</em></a><em>, </em><em>None</em>) – An instance of <a class="reference internal" href="#sionna.channel.SpatialCorrelation" title="sionna.channel.SpatialCorrelation"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpatialCorrelation</span></code></a> or <cite>None</cite>.
Defaults to <cite>None</cite>.</p></li>
<li><p><strong>add_awgn</strong> (<em>bool</em>) – Indicates if AWGN noise should be added to the output.
Defaults to <cite>True</cite>.</p></li>
<li><p><strong>return_channel</strong> (<em>bool</em>) – Indicates if the channel realizations should be returned.
Defaults  to <cite>False</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>tf.complex64</em><em>, </em><em>tf.complex128</em>) – The dtype of the output. Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(x, no)</strong> – Tuple or Tensor:</p></li>
<li><p><strong>x</strong> (<em>[batch_size, num_tx_ant], tf.complex</em>) – Tensor of transmit vectors.</p></li>
<li><p><strong>no</strong> (<em>Scalar of Tensor, tf.float</em>) – The noise power <code class="docutils literal notranslate"><span class="pre">no</span></code> is per complex dimension.
Only required if <code class="docutils literal notranslate"><span class="pre">add_awgn==True</span></code>.
Will be broadcast to the dimensions of the channel output if needed.
For more details, see <a class="reference internal" href="#sionna.channel.AWGN" title="sionna.channel.AWGN"><code class="xref py py-class docutils literal notranslate"><span class="pre">AWGN</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(y, h)</strong> – Tuple or Tensor:</p></li>
<li><p><strong>y</strong> ([batch_size, num_rx_ant, num_tx_ant], <code class="docutils literal notranslate"><span class="pre">dtype</span></code>) – Channel output.</p></li>
<li><p><strong>h</strong> ([batch_size, num_rx_ant, num_tx_ant], <code class="docutils literal notranslate"><span class="pre">dtype</span></code>) – Channel realizations. Will only be returned if
<code class="docutils literal notranslate"><span class="pre">return_channel==True</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.FlatFadingChannel.apply">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">apply</span></span><a class="headerlink" href="#sionna.channel.FlatFadingChannel.apply" title="Permalink to this definition"></a></dt>
<dd><p>Calls the internal <a class="reference internal" href="#sionna.channel.ApplyFlatFadingChannel" title="sionna.channel.ApplyFlatFadingChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ApplyFlatFadingChannel</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.FlatFadingChannel.generate">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">generate</span></span><a class="headerlink" href="#sionna.channel.FlatFadingChannel.generate" title="Permalink to this definition"></a></dt>
<dd><p>Calls the internal <a class="reference internal" href="#sionna.channel.GenerateFlatFadingChannel" title="sionna.channel.GenerateFlatFadingChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenerateFlatFadingChannel</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.FlatFadingChannel.spatial_corr">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">spatial_corr</span></span><a class="headerlink" href="#sionna.channel.FlatFadingChannel.spatial_corr" title="Permalink to this definition"></a></dt>
<dd><p>The <a class="reference internal" href="#sionna.channel.SpatialCorrelation" title="sionna.channel.SpatialCorrelation"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpatialCorrelation</span></code></a> to be used.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="generateflatfadingchannel">
<h3>GenerateFlatFadingChannel<a class="headerlink" href="#generateflatfadingchannel" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.GenerateFlatFadingChannel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">GenerateFlatFadingChannel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_tx_ant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rx_ant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_corr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/flat_fading_channel.html#GenerateFlatFadingChannel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.GenerateFlatFadingChannel" title="Permalink to this definition"></a></dt>
<dd><p>Generates tensors of flat-fading channel realizations.</p>
<p>This class generates batches of random flat-fading channel matrices.
A spatial correlation can be applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_tx_ant</strong> (<em>int</em>) – Number of transmit antennas.</p></li>
<li><p><strong>num_rx_ant</strong> (<em>int</em>) – Number of receive antennas.</p></li>
<li><p><strong>spatial_corr</strong> (<a class="reference internal" href="#sionna.channel.SpatialCorrelation" title="sionna.channel.SpatialCorrelation"><em>SpatialCorrelation</em></a><em>, </em><em>None</em>) – An instance of <a class="reference internal" href="#sionna.channel.SpatialCorrelation" title="sionna.channel.SpatialCorrelation"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpatialCorrelation</span></code></a> or <cite>None</cite>.
Defaults to <cite>None</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>tf.complex64</em><em>, </em><em>tf.complex128</em>) – The dtype of the output. Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><p><strong>batch_size</strong> (<em>int</em>) – The batch size, i.e., the number of channel matrices to generate.</p>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><p><strong>h</strong> ([batch_size, num_rx_ant, num_tx_ant], <code class="docutils literal notranslate"><span class="pre">dtype</span></code>) – Batch of random flat fading channel matrices.</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.GenerateFlatFadingChannel.spatial_corr">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">spatial_corr</span></span><a class="headerlink" href="#sionna.channel.GenerateFlatFadingChannel.spatial_corr" title="Permalink to this definition"></a></dt>
<dd><p>The <a class="reference internal" href="#sionna.channel.SpatialCorrelation" title="sionna.channel.SpatialCorrelation"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpatialCorrelation</span></code></a> to be used.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="applyflatfadingchannel">
<h3>ApplyFlatFadingChannel<a class="headerlink" href="#applyflatfadingchannel" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.ApplyFlatFadingChannel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">ApplyFlatFadingChannel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">add_awgn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/flat_fading_channel.html#ApplyFlatFadingChannel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.ApplyFlatFadingChannel" title="Permalink to this definition"></a></dt>
<dd><p>Applies given channel matrices to a vector input and adds AWGN.</p>
<p>This class applies a given tensor of flat-fading channel matrices
to an input tensor. AWGN noise can be optionally added.
Mathematically, for channel matrices
<span class="math notranslate nohighlight">\(\mathbf{H}\in\mathbb{C}^{M\times K}\)</span>
and input <span class="math notranslate nohighlight">\(\mathbf{x}\in\mathbb{C}^{K}\)</span>, the output is</p>
<div class="math notranslate nohighlight">
\[\mathbf{y} = \mathbf{H}\mathbf{x} + \mathbf{n}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{n}\in\mathbb{C}^{M}\sim\mathcal{CN}(0, N_o\mathbf{I})\)</span>
is an AWGN vector that is optionally added.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>add_awgn</strong> (<em>bool</em>) – Indicates if AWGN noise should be added to the output.
Defaults to <cite>True</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>tf.complex64</em><em>, </em><em>tf.complex128</em>) – The dtype of the output. Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(x, h, no)</strong> – Tuple:</p></li>
<li><p><strong>x</strong> (<em>[batch_size, num_tx_ant], tf.complex</em>) – Tensor of transmit vectors.</p></li>
<li><p><strong>h</strong> (<em>[batch_size, num_rx_ant, num_tx_ant], tf.complex</em>) – Tensor of channel realizations. Will be broadcast to the
dimensions of <code class="docutils literal notranslate"><span class="pre">x</span></code> if needed.</p></li>
<li><p><strong>no</strong> (<em>Scalar of Tensor, tf.float</em>) – The noise power <code class="docutils literal notranslate"><span class="pre">no</span></code> is per complex dimension.
Only required if <code class="docutils literal notranslate"><span class="pre">add_awgn==True</span></code>.
Will be broadcast to the shape of <code class="docutils literal notranslate"><span class="pre">y</span></code>.
For more details, see <a class="reference internal" href="#sionna.channel.AWGN" title="sionna.channel.AWGN"><code class="xref py py-class docutils literal notranslate"><span class="pre">AWGN</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><p><strong>y</strong> ([batch_size, num_rx_ant, num_tx_ant], <code class="docutils literal notranslate"><span class="pre">dtype</span></code>) – Channel output.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="spatialcorrelation">
<h3>SpatialCorrelation<a class="headerlink" href="#spatialcorrelation" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.SpatialCorrelation">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">SpatialCorrelation</span></span><a class="reference internal" href="../_modules/sionna/channel/spatial_correlation.html#SpatialCorrelation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.SpatialCorrelation" title="Permalink to this definition"></a></dt>
<dd><p>Abstract class that defines an interface for spatial correlation functions.</p>
<p>The <a class="reference internal" href="#sionna.channel.FlatFadingChannel" title="sionna.channel.FlatFadingChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlatFadingChannel</span></code></a> model can be configured with a
spatial correlation model.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><p><strong>h</strong> (<em>tf.complex</em>) – Tensor of arbitray shape containing spatially uncorrelated
channel coeffficients</p>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p><strong>h_corr</strong> (<em>tf.complex</em>) – Tensor of the same shape and dtype as <code class="docutils literal notranslate"><span class="pre">h</span></code> containing the spatially
correlated channel coefficients.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="kroneckermodel">
<h3>KroneckerModel<a class="headerlink" href="#kroneckermodel" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.KroneckerModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">KroneckerModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_tx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_rx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/spatial_correlation.html#KroneckerModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.KroneckerModel" title="Permalink to this definition"></a></dt>
<dd><p>Kronecker model for spatial correlation.</p>
<p>Given a batch of matrices <span class="math notranslate nohighlight">\(\mathbf{H}\in\mathbb{C}^{M\times K}\)</span>,
<span class="math notranslate nohighlight">\(\mathbf{R}_\text{tx}\in\mathbb{C}^{K\times K}\)</span>, and
<span class="math notranslate nohighlight">\(\mathbf{R}_\text{rx}\in\mathbb{C}^{M\times M}\)</span>, this function
will generate the following output:</p>
<div class="math notranslate nohighlight">
\[\mathbf{H}_\text{corr} = \mathbf{R}^{\frac12}_\text{rx} \mathbf{H} \mathbf{R}^{\frac12}_\text{tx}\]</div>
<p>Note that <span class="math notranslate nohighlight">\(\mathbf{R}_\text{tx}\in\mathbb{C}^{K\times K}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{R}_\text{rx}\in\mathbb{C}^{M\times M}\)</span>
must be positive semi-definite, such as the ones generated by
<a class="reference internal" href="#sionna.channel.exp_corr_mat" title="sionna.channel.exp_corr_mat"><code class="xref py py-meth docutils literal notranslate"><span class="pre">exp_corr_mat()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r_tx</strong> (<em>[</em><em>...</em><em>, </em><em>K</em><em>, </em><em>K</em><em>]</em><em>, </em><em>tf.complex</em>) – Tensor containing the transmit correlation matrices. If
the rank of <code class="docutils literal notranslate"><span class="pre">r_tx</span></code> is smaller than that of the input <code class="docutils literal notranslate"><span class="pre">h</span></code>,
it will be broadcast.</p></li>
<li><p><strong>r_rx</strong> (<em>[</em><em>...</em><em>, </em><em>M</em><em>, </em><em>M</em><em>]</em><em>, </em><em>tf.complex</em>) – Tensor containing the receive correlation matrices. If
the rank of <code class="docutils literal notranslate"><span class="pre">r_rx</span></code> is smaller than that of the input <code class="docutils literal notranslate"><span class="pre">h</span></code>,
it will be broadcast.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><p><strong>h</strong> (<em>[…, M, K], tf.complex</em>) – Tensor containing spatially uncorrelated
channel coeffficients.</p>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><p><strong>h_corr</strong> (<em>[…, M, K], tf.complex</em>) – Tensor containing the spatially
correlated channel coefficients.</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.KroneckerModel.r_rx">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">r_rx</span></span><a class="headerlink" href="#sionna.channel.KroneckerModel.r_rx" title="Permalink to this definition"></a></dt>
<dd><p>Tensor containing the receive correlation matrices.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to set this property in Graph mode with XLA, i.e., within
a function that is decorated with <code class="docutils literal notranslate"><span class="pre">&#64;tf.function(jit_compile=True)</span></code>,
you must set <code class="docutils literal notranslate"><span class="pre">sionna.Config.xla_compat=true</span></code>.
See <a class="reference internal" href="config.html#sionna.Config.xla_compat" title="sionna.Config.xla_compat"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xla_compat</span></code></a>.</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.KroneckerModel.r_tx">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">r_tx</span></span><a class="headerlink" href="#sionna.channel.KroneckerModel.r_tx" title="Permalink to this definition"></a></dt>
<dd><p>Tensor containing the transmit correlation matrices.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to set this property in Graph mode with XLA, i.e., within
a function that is decorated with <code class="docutils literal notranslate"><span class="pre">&#64;tf.function(jit_compile=True)</span></code>,
you must set <code class="docutils literal notranslate"><span class="pre">sionna.Config.xla_compat=true</span></code>.
See <a class="reference internal" href="config.html#sionna.Config.xla_compat" title="sionna.Config.xla_compat"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xla_compat</span></code></a>.</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="percolumnmodel">
<h3>PerColumnModel<a class="headerlink" href="#percolumnmodel" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.PerColumnModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">PerColumnModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_rx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/spatial_correlation.html#PerColumnModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.PerColumnModel" title="Permalink to this definition"></a></dt>
<dd><p>Per-column model for spatial correlation.</p>
<p>Given a batch of matrices <span class="math notranslate nohighlight">\(\mathbf{H}\in\mathbb{C}^{M\times K}\)</span>
and correlation matrices <span class="math notranslate nohighlight">\(\mathbf{R}_k\in\mathbb{C}^{M\times M}, k=1,\dots,K\)</span>,
this function will generate the output <span class="math notranslate nohighlight">\(\mathbf{H}_\text{corr}\in\mathbb{C}^{M\times K}\)</span>,
with columns</p>
<div class="math notranslate nohighlight">
\[\mathbf{h}^\text{corr}_k = \mathbf{R}^{\frac12}_k \mathbf{h}_k,\quad k=1, \dots, K\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{h}_k\)</span> is the kth column of <span class="math notranslate nohighlight">\(\mathbf{H}\)</span>.
Note that all <span class="math notranslate nohighlight">\(\mathbf{R}_k\in\mathbb{C}^{M\times M}\)</span> must
be positive semi-definite, such as the ones generated
by <a class="reference internal" href="#sionna.channel.one_ring_corr_mat" title="sionna.channel.one_ring_corr_mat"><code class="xref py py-meth docutils literal notranslate"><span class="pre">one_ring_corr_mat()</span></code></a>.</p>
<p>This model is typically used to simulate a MIMO channel between multiple
single-antenna users and a base station with multiple antennas.
The resulting SIMO channel for each user has a different spatial correlation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>r_rx</strong> (<em>[</em><em>...</em><em>, </em><em>M</em><em>, </em><em>M</em><em>]</em><em>, </em><em>tf.complex</em>) – Tensor containing the receive correlation matrices. If
the rank of <code class="docutils literal notranslate"><span class="pre">r_rx</span></code> is smaller than that of the input <code class="docutils literal notranslate"><span class="pre">h</span></code>,
it will be broadcast. For a typically use of this model, <code class="docutils literal notranslate"><span class="pre">r_rx</span></code>
has shape […, K, M, M], i.e., a different correlation matrix for each
column of <code class="docutils literal notranslate"><span class="pre">h</span></code>.</p>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><p><strong>h</strong> (<em>[…, M, K], tf.complex</em>) – Tensor containing spatially uncorrelated
channel coeffficients.</p>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><p><strong>h_corr</strong> (<em>[…, M, K], tf.complex</em>) – Tensor containing the spatially
correlated channel coefficients.</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.PerColumnModel.r_rx">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">r_rx</span></span><a class="headerlink" href="#sionna.channel.PerColumnModel.r_rx" title="Permalink to this definition"></a></dt>
<dd><p>Tensor containing the receive correlation matrices.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to set this property in Graph mode with XLA, i.e., within
a function that is decorated with <code class="docutils literal notranslate"><span class="pre">&#64;tf.function(jit_compile=True)</span></code>,
you must set <code class="docutils literal notranslate"><span class="pre">sionna.Config.xla_compat=true</span></code>.
See <a class="reference internal" href="config.html#sionna.Config.xla_compat" title="sionna.Config.xla_compat"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xla_compat</span></code></a>.</p>
</div>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="channel-model-interface">
<span id="time-domain"></span><h2>Channel model interface<a class="headerlink" href="#channel-model-interface" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.ChannelModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">ChannelModel</span></span><a class="reference internal" href="../_modules/sionna/channel/channel_model.html#ChannelModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.ChannelModel" title="Permalink to this definition"></a></dt>
<dd><p>Abstract class that defines an interface for channel models.</p>
<p>Any channel model which generates channel impulse responses must implement this interface.
All the channel models available in Sionna, such as <a class="reference internal" href="#sionna.channel.RayleighBlockFading" title="sionna.channel.RayleighBlockFading"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayleighBlockFading</span></code></a> or <a class="reference internal" href="#sionna.channel.tr38901.TDL" title="sionna.channel.tr38901.TDL"><code class="xref py py-class docutils literal notranslate"><span class="pre">TDL</span></code></a>, implement this interface.</p>
<p><em>Remark:</em> Some channel models only require a subset of the input parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size</p></li>
<li><p><strong>num_time_steps</strong> (<em>int</em>) – Number of time steps</p></li>
<li><p><strong>sampling_frequency</strong> (<em>float</em>) – Sampling frequency [Hz]</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>a</strong> (<em>[batch size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_paths, num_time_steps], tf.complex</em>) – Path coefficients</p></li>
<li><p><strong>tau</strong> (<em>[batch size, num_rx, num_tx, num_paths], tf.float</em>) – Path delays [s]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="time-domain-channel">
<h2>Time domain channel<a class="headerlink" href="#time-domain-channel" title="Permalink to this headline"></a></h2>
<p>The model of the channel in the time domain assumes pulse shaping and receive
filtering are performed using a conventional sinc filter (see, e.g., <a class="reference internal" href="#tse" id="id3"><span>[Tse]</span></a>).
Using sinc for transmit and receive filtering, the discrete-time domain received
signal at time step <span class="math notranslate nohighlight">\(b\)</span> is</p>
<div class="math notranslate nohighlight">
\[y_{v, l, b} = \sum_{u=0}^{N_{T}-1}\sum_{k=0}^{N_{TA}-1}
   \sum_{\ell = L_{\text{min}}}^{L_{\text{max}}}
   \bar{h}_{u, k, v, l, b, \ell} x_{u, k, b-\ell}
   + w_{v, l, b}\]</div>
<p>where <span class="math notranslate nohighlight">\(x_{u, k, b}\)</span> is the baseband symbol transmitted by transmitter
<span class="math notranslate nohighlight">\(u\)</span> on antenna <span class="math notranslate nohighlight">\(k\)</span> and at time step <span class="math notranslate nohighlight">\(b\)</span>,
<span class="math notranslate nohighlight">\(w_{v, l, b} \sim \mathcal{CN}\left(0,N_0\right)\)</span> the additive white
Gaussian noise, and <span class="math notranslate nohighlight">\(\bar{h}_{u, k, v, l, b, \ell}\)</span> the channel filter tap
at time step <span class="math notranslate nohighlight">\(b\)</span> and for time-lag <span class="math notranslate nohighlight">\(\ell\)</span>, which is given by</p>
<div class="math notranslate nohighlight">
\[\bar{h}_{u, k, v, l, b, \ell}
= \sum_{m=0}^{M-1} a_{u, k, v, l, m}\left(\frac{b}{W}\right)
   \text{sinc}\left( \ell - W\tau_{u, v, m} \right).\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The two parameters <span class="math notranslate nohighlight">\(L_{\text{min}}\)</span> and <span class="math notranslate nohighlight">\(L_{\text{max}}\)</span> control the smallest
and largest time-lag for the discrete-time channel model, respectively.
They are set when instantiating <a class="reference internal" href="#sionna.channel.TimeChannel" title="sionna.channel.TimeChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeChannel</span></code></a>,
<a class="reference internal" href="#sionna.channel.GenerateTimeChannel" title="sionna.channel.GenerateTimeChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenerateTimeChannel</span></code></a>, and when calling the utility
function <a class="reference internal" href="#sionna.channel.cir_to_time_channel" title="sionna.channel.cir_to_time_channel"><code class="xref py py-func docutils literal notranslate"><span class="pre">cir_to_time_channel()</span></code></a>.
Because the sinc filter is neither time-limited nor causal, the discrete-time
channel model is not causal. Therefore, ideally, one would set
<span class="math notranslate nohighlight">\(L_{\text{min}} = -\infty\)</span> and <span class="math notranslate nohighlight">\(L_{\text{max}} = +\infty\)</span>.
In practice, however, these two parameters need to be set to reasonable
finite values. Values for these two parameters can be computed using the
<a class="reference internal" href="#sionna.channel.time_lag_discrete_time_channel" title="sionna.channel.time_lag_discrete_time_channel"><code class="xref py py-func docutils literal notranslate"><span class="pre">time_lag_discrete_time_channel()</span></code></a> utility function from
a given bandwidth and maximum delay spread.
This function returns <span class="math notranslate nohighlight">\(-6\)</span> for <span class="math notranslate nohighlight">\(L_{\text{min}}\)</span>. <span class="math notranslate nohighlight">\(L_{\text{max}}\)</span> is computed
from the specified bandwidth and maximum delay spread, which default value is
<span class="math notranslate nohighlight">\(3 \mu s\)</span>. These values for <span class="math notranslate nohighlight">\(L_{\text{min}}\)</span> and the maximum delay spread
were found to be valid for all the models available in Sionna when an RMS delay
spread of 100ns is assumed.</p>
</div>
<div class="section" id="timechannel">
<h3>TimeChannel<a class="headerlink" href="#timechannel" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.TimeChannel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">TimeChannel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bandwidth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_time_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximum_delay_spread</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3e-6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_awgn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/time_channel.html#TimeChannel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.TimeChannel" title="Permalink to this definition"></a></dt>
<dd><p>Generate channel responses and apply them to channel inputs in the time domain.</p>
<p>This class inherits from the Keras <cite>Layer</cite> class and can be used as layer
in a Keras model.</p>
<p>The channel output consists of <code class="docutils literal notranslate"><span class="pre">num_time_samples</span></code> + <code class="docutils literal notranslate"><span class="pre">l_max</span></code> - <code class="docutils literal notranslate"><span class="pre">l_min</span></code>
time samples, as it is the result of filtering the channel input of length
<code class="docutils literal notranslate"><span class="pre">num_time_samples</span></code> with the time-variant channel filter  of length
<code class="docutils literal notranslate"><span class="pre">l_max</span></code> - <code class="docutils literal notranslate"><span class="pre">l_min</span></code> + 1. In the case of a single-input single-output link and given a sequence of channel
inputs <span class="math notranslate nohighlight">\(x_0,\cdots,x_{N_B}\)</span>, where <span class="math notranslate nohighlight">\(N_B\)</span> is <code class="docutils literal notranslate"><span class="pre">num_time_samples</span></code>, this
layer outputs</p>
<div class="math notranslate nohighlight">
\[y_b = \sum_{\ell = L_{\text{min}}}^{L_{\text{max}}} x_{b-\ell} \bar{h}_{b,\ell} + w_b\]</div>
<p>where <span class="math notranslate nohighlight">\(L_{\text{min}}\)</span> corresponds <code class="docutils literal notranslate"><span class="pre">l_min</span></code>, <span class="math notranslate nohighlight">\(L_{\text{max}}\)</span> to <code class="docutils literal notranslate"><span class="pre">l_max</span></code>, <span class="math notranslate nohighlight">\(w_b\)</span> to
the additive noise, and <span class="math notranslate nohighlight">\(\bar{h}_{b,\ell}\)</span> to the
<span class="math notranslate nohighlight">\(\ell^{th}\)</span> tap of the <span class="math notranslate nohighlight">\(b^{th}\)</span> channel sample.
This layer outputs <span class="math notranslate nohighlight">\(y_b\)</span> for <span class="math notranslate nohighlight">\(b\)</span> ranging from <span class="math notranslate nohighlight">\(L_{\text{min}}\)</span> to
<span class="math notranslate nohighlight">\(N_B + L_{\text{max}} - 1\)</span>, and <span class="math notranslate nohighlight">\(x_{b}\)</span> is set to 0 for <span class="math notranslate nohighlight">\(b &lt; 0\)</span> or <span class="math notranslate nohighlight">\(b \geq N_B\)</span>.
The channel taps <span class="math notranslate nohighlight">\(\bar{h}_{b,\ell}\)</span> are computed assuming a sinc filter
is used for pulse shaping and receive filtering. Therefore, given a channel impulse response
<span class="math notranslate nohighlight">\((a_{m}(t), \tau_{m}), 0 \leq m \leq M-1\)</span>, generated by the <code class="docutils literal notranslate"><span class="pre">channel_model</span></code>,
the channel taps are computed as follows:</p>
<div class="math notranslate nohighlight">
\[\bar{h}_{b, \ell}
= \sum_{m=0}^{M-1} a_{m}\left(\frac{b}{W}\right)
    \text{sinc}\left( \ell - W\tau_{m} \right)\]</div>
<p>for <span class="math notranslate nohighlight">\(\ell\)</span> ranging from <code class="docutils literal notranslate"><span class="pre">l_min</span></code> to <code class="docutils literal notranslate"><span class="pre">l_max</span></code>, and where <span class="math notranslate nohighlight">\(W\)</span> is
the <code class="docutils literal notranslate"><span class="pre">bandwidth</span></code>.</p>
<p>For multiple-input multiple-output (MIMO) links, the channel output is computed for each antenna of each receiver and by summing over all the antennas of all transmitters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>channel_model</strong> (<a class="reference internal" href="#sionna.channel.ChannelModel" title="sionna.channel.ChannelModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChannelModel</span></code></a> object) – An instance of a <a class="reference internal" href="#sionna.channel.ChannelModel" title="sionna.channel.ChannelModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChannelModel</span></code></a>, such as
<a class="reference internal" href="#sionna.channel.RayleighBlockFading" title="sionna.channel.RayleighBlockFading"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayleighBlockFading</span></code></a> or
<a class="reference internal" href="#sionna.channel.tr38901.UMi" title="sionna.channel.tr38901.UMi"><code class="xref py py-class docutils literal notranslate"><span class="pre">UMi</span></code></a>.</p></li>
<li><p><strong>bandwidth</strong> (<em>float</em>) – Bandwidth (<span class="math notranslate nohighlight">\(W\)</span>) [Hz]</p></li>
<li><p><strong>num_time_samples</strong> (<em>int</em>) – Number of time samples forming the channel input (<span class="math notranslate nohighlight">\(N_B\)</span>)</p></li>
<li><p><strong>maximum_delay_spread</strong> (<em>float</em>) – Maximum delay spread [s].
Used to compute the default value of <code class="docutils literal notranslate"><span class="pre">l_max</span></code> if <code class="docutils literal notranslate"><span class="pre">l_max</span></code> is set to
<cite>None</cite>. If a value is given for <code class="docutils literal notranslate"><span class="pre">l_max</span></code>, this parameter is not used.
It defaults to 3us, which was found
to be large enough to include most significant paths with all channel
models included in Sionna assuming a nominal delay spread of 100ns.</p></li>
<li><p><strong>l_min</strong> (<em>int</em>) – Smallest time-lag for the discrete complex baseband channel (<span class="math notranslate nohighlight">\(L_{\text{min}}\)</span>).
If set to <cite>None</cite>, defaults to the value given by <a class="reference internal" href="#sionna.channel.time_lag_discrete_time_channel" title="sionna.channel.time_lag_discrete_time_channel"><code class="xref py py-func docutils literal notranslate"><span class="pre">time_lag_discrete_time_channel()</span></code></a>.</p></li>
<li><p><strong>l_max</strong> (<em>int</em>) – Largest time-lag for the discrete complex baseband channel (<span class="math notranslate nohighlight">\(L_{\text{max}}\)</span>).
If set to <cite>None</cite>, it is computed from <code class="docutils literal notranslate"><span class="pre">bandwidth</span></code> and <code class="docutils literal notranslate"><span class="pre">maximum_delay_spread</span></code>
using <a class="reference internal" href="#sionna.channel.time_lag_discrete_time_channel" title="sionna.channel.time_lag_discrete_time_channel"><code class="xref py py-func docutils literal notranslate"><span class="pre">time_lag_discrete_time_channel()</span></code></a>. If it is not set to <cite>None</cite>,
then the parameter <code class="docutils literal notranslate"><span class="pre">maximum_delay_spread</span></code> is not used.</p></li>
<li><p><strong>add_awgn</strong> (<em>bool</em>) – If set to <cite>False</cite>, no white Gaussian noise is added.
Defaults to <cite>True</cite>.</p></li>
<li><p><strong>normalize_channel</strong> (<em>bool</em>) – If set to <cite>True</cite>, the channel is normalized over the block size
to ensure unit average energy per time step. Defaults to <cite>False</cite>.</p></li>
<li><p><strong>return_channel</strong> (<em>bool</em>) – If set to <cite>True</cite>, the channel response is returned in addition to the
channel output. Defaults to <cite>False</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>tf.DType</em>) – Complex datatype to use for internal processing and output.
Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(x, no) or x</strong> – Tuple or Tensor:</p></li>
<li><p><strong>x</strong> (<em>[batch size, num_tx, num_tx_ant, num_time_samples], tf.complex</em>) – Channel inputs</p></li>
<li><p><strong>no</strong> (<em>Scalar or Tensor, tf.float</em>) – Scalar or tensor whose shape can be broadcast to the shape of the
channel outputs: [batch size, num_rx, num_rx_ant, num_time_samples].
Only required if <code class="docutils literal notranslate"><span class="pre">add_awgn</span></code> is set to <cite>True</cite>.
The noise power <code class="docutils literal notranslate"><span class="pre">no</span></code> is per complex dimension. If <code class="docutils literal notranslate"><span class="pre">no</span></code> is a scalar,
noise of the same variance will be added to the outputs.
If <code class="docutils literal notranslate"><span class="pre">no</span></code> is a tensor, it must have a shape that can be broadcast to
the shape of the channel outputs. This allows, e.g., adding noise of
different variance to each example in a batch. If <code class="docutils literal notranslate"><span class="pre">no</span></code> has a lower
rank than the channel outputs, then <code class="docutils literal notranslate"><span class="pre">no</span></code> will be broadcast to the
shape of the channel outputs by adding dummy dimensions after the last
axis.</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>[batch size, num_rx, num_rx_ant, num_time_samples + l_max - l_min], tf.complex</em>) – Channel outputs
The channel output consists of <code class="docutils literal notranslate"><span class="pre">num_time_samples</span></code> + <code class="docutils literal notranslate"><span class="pre">l_max</span></code> - <code class="docutils literal notranslate"><span class="pre">l_min</span></code>
time samples, as it is the result of filtering the channel input of length
<code class="docutils literal notranslate"><span class="pre">num_time_samples</span></code> with the time-variant channel filter  of length
<code class="docutils literal notranslate"><span class="pre">l_max</span></code> - <code class="docutils literal notranslate"><span class="pre">l_min</span></code> + 1.</p></li>
<li><p><strong>h_time</strong> (<em>[batch size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_time_samples + l_max - l_min, l_max - l_min + 1], tf.complex</em>) – (Optional) Channel responses. Returned only if <code class="docutils literal notranslate"><span class="pre">return_channel</span></code>
is set to <cite>True</cite>.
For each batch example, <code class="docutils literal notranslate"><span class="pre">num_time_samples</span></code> + <code class="docutils literal notranslate"><span class="pre">l_max</span></code> - <code class="docutils literal notranslate"><span class="pre">l_min</span></code> time
steps of the channel realizations are generated to filter the channel input.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="generatetimechannel">
<h3>GenerateTimeChannel<a class="headerlink" href="#generatetimechannel" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.GenerateTimeChannel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">GenerateTimeChannel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bandwidth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_time_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/generate_time_channel.html#GenerateTimeChannel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.GenerateTimeChannel" title="Permalink to this definition"></a></dt>
<dd><p>Generate channel responses in the time domain.</p>
<p>For each batch example, <code class="docutils literal notranslate"><span class="pre">num_time_samples</span></code> + <code class="docutils literal notranslate"><span class="pre">l_max</span></code> - <code class="docutils literal notranslate"><span class="pre">l_min</span></code> time steps of a
channel realization are generated by this layer.
These can be used to filter a channel input of length <code class="docutils literal notranslate"><span class="pre">num_time_samples</span></code> using the
<a class="reference internal" href="#sionna.channel.ApplyTimeChannel" title="sionna.channel.ApplyTimeChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ApplyTimeChannel</span></code></a> layer.</p>
<p>The channel taps <span class="math notranslate nohighlight">\(\bar{h}_{b,\ell}\)</span> (<code class="docutils literal notranslate"><span class="pre">h_time</span></code>) returned by this layer
are computed assuming a sinc filter is used for pulse shaping and receive filtering.
Therefore, given a channel impulse response
<span class="math notranslate nohighlight">\((a_{m}(t), \tau_{m}), 0 \leq m \leq M-1\)</span>, generated by the <code class="docutils literal notranslate"><span class="pre">channel_model</span></code>,
the channel taps are computed as follows:</p>
<div class="math notranslate nohighlight">
\[\bar{h}_{b, \ell}
= \sum_{m=0}^{M-1} a_{m}\left(\frac{b}{W}\right)
    \text{sinc}\left( \ell - W\tau_{m} \right)\]</div>
<p>for <span class="math notranslate nohighlight">\(\ell\)</span> ranging from <code class="docutils literal notranslate"><span class="pre">l_min</span></code> to <code class="docutils literal notranslate"><span class="pre">l_max</span></code>, and where <span class="math notranslate nohighlight">\(W\)</span> is
the <code class="docutils literal notranslate"><span class="pre">bandwidth</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>channel_model</strong> (<a class="reference internal" href="#sionna.channel.ChannelModel" title="sionna.channel.ChannelModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChannelModel</span></code></a> object) – An instance of a <a class="reference internal" href="#sionna.channel.ChannelModel" title="sionna.channel.ChannelModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChannelModel</span></code></a>, such as
<a class="reference internal" href="#sionna.channel.RayleighBlockFading" title="sionna.channel.RayleighBlockFading"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayleighBlockFading</span></code></a> or
<a class="reference internal" href="#sionna.channel.tr38901.UMi" title="sionna.channel.tr38901.UMi"><code class="xref py py-class docutils literal notranslate"><span class="pre">UMi</span></code></a>.</p></li>
<li><p><strong>bandwidth</strong> (<em>float</em>) – Bandwidth (<span class="math notranslate nohighlight">\(W\)</span>) [Hz]</p></li>
<li><p><strong>num_time_samples</strong> (<em>int</em>) – Number of time samples forming the channel input (<span class="math notranslate nohighlight">\(N_B\)</span>)</p></li>
<li><p><strong>l_min</strong> (<em>int</em>) – Smallest time-lag for the discrete complex baseband channel (<span class="math notranslate nohighlight">\(L_{\text{min}}\)</span>)</p></li>
<li><p><strong>l_max</strong> (<em>int</em>) – Largest time-lag for the discrete complex baseband channel (<span class="math notranslate nohighlight">\(L_{\text{max}}\)</span>)</p></li>
<li><p><strong>normalize_channel</strong> (<em>bool</em>) – If set to <cite>True</cite>, the channel is normalized over the block size
to ensure unit average energy per time step. Defaults to <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><p><strong>batch_size</strong> (<em>int</em>) – Batch size. Defaults to <cite>None</cite> for channel models that do not require this paranmeter.</p>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><p><strong>h_time</strong> (<em>[batch size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_time_samples + l_max - l_min, l_max - l_min + 1], tf.complex</em>) – Channel responses.
For each batch example, <code class="docutils literal notranslate"><span class="pre">num_time_samples</span></code> + <code class="docutils literal notranslate"><span class="pre">l_max</span></code> - <code class="docutils literal notranslate"><span class="pre">l_min</span></code> time steps of a
channel realization are generated by this layer.
These can be used to filter a channel input of length <code class="docutils literal notranslate"><span class="pre">num_time_samples</span></code> using the
<a class="reference internal" href="#sionna.channel.ApplyTimeChannel" title="sionna.channel.ApplyTimeChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ApplyTimeChannel</span></code></a> layer.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="applytimechannel">
<h3>ApplyTimeChannel<a class="headerlink" href="#applytimechannel" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.ApplyTimeChannel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">ApplyTimeChannel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_time_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_tot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_awgn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/apply_time_channel.html#ApplyTimeChannel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.ApplyTimeChannel" title="Permalink to this definition"></a></dt>
<dd><p>Apply time domain channel responses <code class="docutils literal notranslate"><span class="pre">h_time</span></code> to channel inputs <code class="docutils literal notranslate"><span class="pre">x</span></code>,
by filtering the channel inputs with time-variant channel responses.</p>
<p>This class inherits from the Keras <cite>Layer</cite> class and can be used as layer
in a Keras model.</p>
<p>For each batch example, <code class="docutils literal notranslate"><span class="pre">num_time_samples</span></code> + <code class="docutils literal notranslate"><span class="pre">l_tot</span></code> - 1 time steps of a
channel realization are required to filter the channel inputs.</p>
<p>The channel output consists of <code class="docutils literal notranslate"><span class="pre">num_time_samples</span></code> + <code class="docutils literal notranslate"><span class="pre">l_tot</span></code> - 1
time samples, as it is the result of filtering the channel input of length
<code class="docutils literal notranslate"><span class="pre">num_time_samples</span></code> with the time-variant channel filter  of length
<code class="docutils literal notranslate"><span class="pre">l_tot</span></code>. In the case of a single-input single-output link and given a sequence of channel
inputs <span class="math notranslate nohighlight">\(x_0,\cdots,x_{N_B}\)</span>, where <span class="math notranslate nohighlight">\(N_B\)</span> is <code class="docutils literal notranslate"><span class="pre">num_time_samples</span></code>, this
layer outputs</p>
<div class="math notranslate nohighlight">
\[y_b = \sum_{\ell = 0}^{L_{\text{tot}}} x_{b-\ell} \bar{h}_{b,\ell} + w_b\]</div>
<p>where <span class="math notranslate nohighlight">\(L_{\text{tot}}\)</span> corresponds <code class="docutils literal notranslate"><span class="pre">l_tot</span></code>, <span class="math notranslate nohighlight">\(w_b\)</span> to the additive noise, and
<span class="math notranslate nohighlight">\(\bar{h}_{b,\ell}\)</span> to the <span class="math notranslate nohighlight">\(\ell^{th}\)</span> tap of the <span class="math notranslate nohighlight">\(b^{th}\)</span> channel sample.
This layer outputs <span class="math notranslate nohighlight">\(y_b\)</span> for <span class="math notranslate nohighlight">\(b\)</span> ranging from 0 to
<span class="math notranslate nohighlight">\(N_B + L_{\text{tot}} - 1\)</span>, and <span class="math notranslate nohighlight">\(x_{b}\)</span> is set to 0 for <span class="math notranslate nohighlight">\(b \geq N_B\)</span>.</p>
<p>For multiple-input multiple-output (MIMO) links, the channel output is computed for each antenna
of each receiver and by summing over all the antennas of all transmitters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_time_samples</strong> (<em>int</em>) – Number of time samples forming the channel input (<span class="math notranslate nohighlight">\(N_B\)</span>)</p></li>
<li><p><strong>l_tot</strong> (<em>int</em>) – Length of the channel filter (<span class="math notranslate nohighlight">\(L_{\text{tot}} = L_{\text{max}} - L_{\text{min}} + 1\)</span>)</p></li>
<li><p><strong>add_awgn</strong> (<em>bool</em>) – If set to <cite>False</cite>, no white Gaussian noise is added.
Defaults to <cite>True</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>tf.DType</em>) – Complex datatype to use for internal processing and output.
Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(x, h_time, no) or (x, h_time)</strong> – Tuple:</p></li>
<li><p><strong>x</strong> (<em>[batch size, num_tx, num_tx_ant, num_time_samples], tf.complex</em>) – Channel inputs</p></li>
<li><p><strong>h_time</strong> (<em>[batch size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_time_samples + l_tot - 1, l_tot], tf.complex</em>) – Channel responses.
For each batch example, <code class="docutils literal notranslate"><span class="pre">num_time_samples</span></code> + <code class="docutils literal notranslate"><span class="pre">l_tot</span></code> - 1 time steps of a
channel realization are required to filter the channel inputs.</p></li>
<li><p><strong>no</strong> (<em>Scalar or Tensor, tf.float</em>) – Scalar or tensor whose shape can be broadcast to the shape of the channel outputs: [batch size, num_rx, num_rx_ant, num_time_samples + l_tot - 1].
Only required if <code class="docutils literal notranslate"><span class="pre">add_awgn</span></code> is set to <cite>True</cite>.
The noise power <code class="docutils literal notranslate"><span class="pre">no</span></code> is per complex dimension. If <code class="docutils literal notranslate"><span class="pre">no</span></code> is a
scalar, noise of the same variance will be added to the outputs.
If <code class="docutils literal notranslate"><span class="pre">no</span></code> is a tensor, it must have a shape that can be broadcast to
the shape of the channel outputs. This allows, e.g., adding noise of
different variance to each example in a batch. If <code class="docutils literal notranslate"><span class="pre">no</span></code> has a lower
rank than the channel outputs, then <code class="docutils literal notranslate"><span class="pre">no</span></code> will be broadcast to the
shape of the channel outputs by adding dummy dimensions after the
last axis.</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><p><strong>y</strong> (<em>[batch size, num_rx, num_rx_ant, num_time_samples + l_tot - 1], tf.complex</em>) – Channel outputs.
The channel output consists of <code class="docutils literal notranslate"><span class="pre">num_time_samples</span></code> + <code class="docutils literal notranslate"><span class="pre">l_tot</span></code> - 1
time samples, as it is the result of filtering the channel input of length
<code class="docutils literal notranslate"><span class="pre">num_time_samples</span></code> with the time-variant channel filter  of length
<code class="docutils literal notranslate"><span class="pre">l_tot</span></code>.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="cir-to-time-channel">
<h3>cir_to_time_channel<a class="headerlink" href="#cir-to-time-channel" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="sionna.channel.cir_to_time_channel">
<span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">cir_to_time_channel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bandwidth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/utils.html#cir_to_time_channel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.cir_to_time_channel" title="Permalink to this definition"></a></dt>
<dd><p>Compute the channel taps forming the discrete complex-baseband
representation of the channel from the channel impulse response
(<code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">tau</span></code>).</p>
<p>This function assumes sinc filter is used for pulse shaping and receive
filtering. Therefore, given a channel impulse response
<span class="math notranslate nohighlight">\((a_{m}(t), \tau_{m}), 0 \leq m \leq M-1\)</span>, the channel taps
are computed as follows:</p>
<div class="math notranslate nohighlight">
\[\bar{h}_{b, \ell}
= \sum_{m=0}^{M-1} a_{m}\left(\frac{b}{W}\right)
    \text{sinc}\left( \ell - W\tau_{m} \right)\]</div>
<p>for <span class="math notranslate nohighlight">\(\ell\)</span> ranging from <code class="docutils literal notranslate"><span class="pre">l_min</span></code> to <code class="docutils literal notranslate"><span class="pre">l_max</span></code>, and where <span class="math notranslate nohighlight">\(W\)</span> is
the <code class="docutils literal notranslate"><span class="pre">bandwidth</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bandwidth</strong> (<em>float</em>) – Bandwidth [Hz]</p></li>
<li><p><strong>a</strong> (<em>[batch size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_paths, num_time_steps], tf.complex</em>) – Path coefficients</p></li>
<li><p><strong>tau</strong> (<em>[batch size, num_rx, num_tx, num_paths], tf.float</em>) – Path delays [s]</p></li>
<li><p><strong>l_min</strong> (<em>int</em>) – Smallest time-lag for the discrete complex baseband channel (<span class="math notranslate nohighlight">\(L_{\text{min}}\)</span>)</p></li>
<li><p><strong>l_max</strong> (<em>int</em>) – Largest time-lag for the discrete complex baseband channel (<span class="math notranslate nohighlight">\(L_{\text{max}}\)</span>)</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – If set to <cite>True</cite>, the channel is normalized over the block size
to ensure unit average energy per time step. Defaults to <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p><strong>hm</strong> (<em>[batch size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_time_steps, l_max - l_min + 1], tf.complex</em>) – Channel taps coefficients</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="channel-with-ofdm-waveform">
<span id="ofdm-waveform"></span><h2>Channel with OFDM waveform<a class="headerlink" href="#channel-with-ofdm-waveform" title="Permalink to this headline"></a></h2>
<p>To implement the channel response assuming an OFDM waveform, it is assumed that
the power delay profiles are invariant over the duration of an OFDM symbol.
Moreover, it is assumed that the duration of the cyclic prefix (CP) equals at
least the maximum delay spread. These assumptions are common in the literature, as they
enable modeling of the channel transfer function in the frequency domain as a
single-tap channel.</p>
<p>For every link <span class="math notranslate nohighlight">\((u, k, v, l)\)</span> and resource element <span class="math notranslate nohighlight">\((s,n)\)</span>,
the frequency channel response is obtained by computing the Fourier transform of
the channel response at the subcarrier frequencies, i.e.,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\widehat{h}_{u, k, v, l, s, n}
   &amp;= \int_{-\infty}^{+\infty} h_{u, k, v, l}(s,\tau) e^{-j2\pi n \Delta_f \tau} d\tau\\
   &amp;= \sum_{m=0}^{M-1} a_{u, k, v, l, m}(s)
   e^{j2\pi n \Delta_f \tau_{u, k, v, l, m}}
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(s\)</span> is used as time step to indicate that the channel response can
change from one OFDM symbol to the next in the event of mobility, even if it is
assumed static over the duration of an OFDM symbol.</p>
<p>For every receive antenna <span class="math notranslate nohighlight">\(l\)</span> of every receiver <span class="math notranslate nohighlight">\(v\)</span>, the
received signal <span class="math notranslate nohighlight">\(y_{v, l, s, n}\)</span> for resource element
<span class="math notranslate nohighlight">\((s, n)\)</span> is computed by</p>
<div class="math notranslate nohighlight">
\[y_{v, l, s, n} = \sum_{u=0}^{N_{T}-1}\sum_{k=0}^{N_{TA}-1}
   \widehat{h}_{u, k, v, l, s, n} x_{u, k, s, n}
   + w_{v, l, s, n}\]</div>
<p>where <span class="math notranslate nohighlight">\(x_{u, k, s, n}\)</span> is the baseband symbol transmitted by transmitter
<span class="math notranslate nohighlight">\(u\)</span> on antenna <span class="math notranslate nohighlight">\(k\)</span> and resource element <span class="math notranslate nohighlight">\((s, n)\)</span>, and
<span class="math notranslate nohighlight">\(w_{v, l, s, n} \sim \mathcal{CN}\left(0,N_0\right)\)</span> the additive white
Gaussian noise.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This model does not account for intersymbol interference (ISI) nor
intercarrier interference (ICI). To model the ICI due to channel aging over
the duration of an OFDM symbol or the ISI due to a delay spread exceeding the
CP duration, one would need to simulate the channel in the time domain.
This can be achieved by using the <a class="reference internal" href="ofdm.html#sionna.ofdm.OFDMModulator" title="sionna.ofdm.OFDMModulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">OFDMModulator</span></code></a> and
<a class="reference internal" href="ofdm.html#sionna.ofdm.OFDMDemodulator" title="sionna.ofdm.OFDMDemodulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">OFDMDemodulator</span></code></a> layers, and the
<a class="reference internal" href="#time-domain"><span class="std std-ref">time domain channel model</span></a>.
By doing so, one performs inverse discrete Fourier transform (IDFT) on
the transmitter side and discrete Fourier transform (DFT) on the receiver side
on top of a single-carrier sinc-shaped waveform.
This is equivalent to
<a class="reference internal" href="#ofdm-waveform"><span class="std std-ref">simulating the channel in the frequency domain</span></a> if no
ISI nor ICI is assumed, but allows the simulation of these effects in the
event of a non-stationary channel or long delay spreads.
Note that simulating the channel in the time domain is typically significantly
more computationally demanding that simulating the channel in the frequency
domain.</p>
</div>
<div class="section" id="ofdmchannel">
<h3>OFDMChannel<a class="headerlink" href="#ofdmchannel" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.OFDMChannel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">OFDMChannel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_awgn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/ofdm_channel.html#OFDMChannel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.OFDMChannel" title="Permalink to this definition"></a></dt>
<dd><p>Generate channel frequency responses and apply them to channel inputs
assuming an OFDM waveform with no ICI nor ISI.</p>
<p>This class inherits from the Keras <cite>Layer</cite> class and can be used as layer
in a Keras model.</p>
<p>For each OFDM symbol <span class="math notranslate nohighlight">\(s\)</span> and subcarrier <span class="math notranslate nohighlight">\(n\)</span>, the channel output is computed as follows:</p>
<div class="math notranslate nohighlight">
\[y_{s,n} = \widehat{h}_{s, n} x_{s,n} + w_{s,n}\]</div>
<p>where <span class="math notranslate nohighlight">\(y_{s,n}\)</span> is the channel output computed by this layer,
<span class="math notranslate nohighlight">\(\widehat{h}_{s, n}\)</span> the frequency channel response,
<span class="math notranslate nohighlight">\(x_{s,n}\)</span> the channel input <code class="docutils literal notranslate"><span class="pre">x</span></code>, and <span class="math notranslate nohighlight">\(w_{s,n}\)</span> the additive noise.</p>
<p>For multiple-input multiple-output (MIMO) links, the channel output is computed for each antenna
of each receiver and by summing over all the antennas of all transmitters.</p>
<p>The channel frequency response for the <span class="math notranslate nohighlight">\(s^{th}\)</span> OFDM symbol and
<span class="math notranslate nohighlight">\(n^{th}\)</span> subcarrier is computed from a given channel impulse response
<span class="math notranslate nohighlight">\((a_{m}(t), \tau_{m}), 0 \leq m \leq M-1\)</span> generated by the <code class="docutils literal notranslate"><span class="pre">channel_model</span></code>
as follows:</p>
<div class="math notranslate nohighlight">
\[\widehat{h}_{s, n} = \sum_{m=0}^{M-1} a_{m}(s) e^{j2\pi n \Delta_f \tau_{m}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta_f\)</span> is the subcarrier spacing, and <span class="math notranslate nohighlight">\(s\)</span> is used as time
step to indicate that the channel impulse response can change from one OFDM symbol to the
next in the event of mobility, even if it is assumed static over the duration
of an OFDM symbol.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>channel_model</strong> (<a class="reference internal" href="#sionna.channel.ChannelModel" title="sionna.channel.ChannelModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChannelModel</span></code></a> object) – An instance of a <a class="reference internal" href="#sionna.channel.ChannelModel" title="sionna.channel.ChannelModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChannelModel</span></code></a> object, such as
<a class="reference internal" href="#sionna.channel.RayleighBlockFading" title="sionna.channel.RayleighBlockFading"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayleighBlockFading</span></code></a> or
<a class="reference internal" href="#sionna.channel.tr38901.UMi" title="sionna.channel.tr38901.UMi"><code class="xref py py-class docutils literal notranslate"><span class="pre">UMi</span></code></a>.</p></li>
<li><p><strong>resource_grid</strong> (<a class="reference internal" href="ofdm.html#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>) – Resource grid</p></li>
<li><p><strong>add_awgn</strong> (<em>bool</em>) – If set to <cite>False</cite>, no white Gaussian noise is added.
Defaults to <cite>True</cite>.</p></li>
<li><p><strong>normalize_channel</strong> (<em>bool</em>) – If set to <cite>True</cite>, the channel is normalized over the resource grid
to ensure unit average energy per resource element. Defaults to <cite>False</cite>.</p></li>
<li><p><strong>return_channel</strong> (<em>bool</em>) – If set to <cite>True</cite>, the channel response is returned in addition to the
channel output. Defaults to <cite>False</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>tf.DType</em>) – Complex datatype to use for internal processing and output.
Defaults to tf.complex64.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(x, no) or x</strong> – Tuple or Tensor:</p></li>
<li><p><strong>x</strong> (<em>[batch size, num_tx, num_tx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – Channel inputs</p></li>
<li><p><strong>no</strong> (<em>Scalar or Tensor, tf.float</em>) – Scalar or tensor whose shape can be broadcast to the shape of the
channel outputs:
[batch size, num_rx, num_rx_ant, num_ofdm_symbols, fft_size].
Only required if <code class="docutils literal notranslate"><span class="pre">add_awgn</span></code> is set to <cite>True</cite>.
The noise power <code class="docutils literal notranslate"><span class="pre">no</span></code> is per complex dimension. If <code class="docutils literal notranslate"><span class="pre">no</span></code> is a scalar,
noise of the same variance will be added to the outputs.
If <code class="docutils literal notranslate"><span class="pre">no</span></code> is a tensor, it must have a shape that can be broadcast to
the shape of the channel outputs. This allows, e.g., adding noise of
different variance to each example in a batch. If <code class="docutils literal notranslate"><span class="pre">no</span></code> has a lower
rank than the channel outputs, then <code class="docutils literal notranslate"><span class="pre">no</span></code> will be broadcast to the
shape of the channel outputs by adding dummy dimensions after the last
axis.</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>[batch size, num_rx, num_rx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – Channel outputs</p></li>
<li><p><strong>h_freq</strong> (<em>[batch size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – (Optional) Channel frequency responses. Returned only if
<code class="docutils literal notranslate"><span class="pre">return_channel</span></code> is set to <cite>True</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="generateofdmchannel">
<h3>GenerateOFDMChannel<a class="headerlink" href="#generateofdmchannel" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.GenerateOFDMChannel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">GenerateOFDMChannel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/generate_ofdm_channel.html#GenerateOFDMChannel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.GenerateOFDMChannel" title="Permalink to this definition"></a></dt>
<dd><p>Generate channel frequency responses.
The channel impulse response is constant over the duration of an OFDM symbol.</p>
<p>Given a channel impulse response
<span class="math notranslate nohighlight">\((a_{m}(t), \tau_{m}), 0 \leq m \leq M-1\)</span>, generated by the <code class="docutils literal notranslate"><span class="pre">channel_model</span></code>,
the channel frequency response for the <span class="math notranslate nohighlight">\(s^{th}\)</span> OFDM symbol and
<span class="math notranslate nohighlight">\(n^{th}\)</span> subcarrier is computed as follows:</p>
<div class="math notranslate nohighlight">
\[\widehat{h}_{s, n} = \sum_{m=0}^{M-1} a_{m}(s) e^{j2\pi n \Delta_f \tau_{m}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta_f\)</span> is the subcarrier spacing, and <span class="math notranslate nohighlight">\(s\)</span> is used as time
step to indicate that the channel impulse response can change from one OFDM symbol to the
next in the event of mobility, even if it is assumed static over the duration
of an OFDM symbol.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>channel_model</strong> (<a class="reference internal" href="#sionna.channel.ChannelModel" title="sionna.channel.ChannelModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChannelModel</span></code></a> object) – An instance of a <a class="reference internal" href="#sionna.channel.ChannelModel" title="sionna.channel.ChannelModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChannelModel</span></code></a> object, such as
<a class="reference internal" href="#sionna.channel.RayleighBlockFading" title="sionna.channel.RayleighBlockFading"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayleighBlockFading</span></code></a> or
<a class="reference internal" href="#sionna.channel.tr38901.UMi" title="sionna.channel.tr38901.UMi"><code class="xref py py-class docutils literal notranslate"><span class="pre">UMi</span></code></a>.</p></li>
<li><p><strong>resource_grid</strong> (<a class="reference internal" href="ofdm.html#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>) – Resource grid</p></li>
<li><p><strong>normalize_channel</strong> (<em>bool</em>) – If set to <cite>True</cite>, the channel is normalized over the resource grid
to ensure unit average energy per resource element. Defaults to <cite>False</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>tf.DType</em>) – Complex datatype to use for internal processing and output.
Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><p><strong>batch_size</strong> (<em>int</em>) – Batch size. Defaults to <cite>None</cite> for channel models that do not require this paranmeter.</p>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><p><strong>h_freq</strong> (<em>[batch size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_ofdm_symbols, num_subcarriers], tf.complex</em>) – Channel frequency responses</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="applyofdmchannel">
<h3>ApplyOFDMChannel<a class="headerlink" href="#applyofdmchannel" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.ApplyOFDMChannel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">ApplyOFDMChannel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">add_awgn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/apply_ofdm_channel.html#ApplyOFDMChannel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.ApplyOFDMChannel" title="Permalink to this definition"></a></dt>
<dd><p>Apply single-tap channel frequency responses to channel inputs.</p>
<p>This class inherits from the Keras <cite>Layer</cite> class and can be used as layer
in a Keras model.</p>
<p>For each OFDM symbol <span class="math notranslate nohighlight">\(s\)</span> and subcarrier <span class="math notranslate nohighlight">\(n\)</span>, the single-tap channel
is applied as follows:</p>
<div class="math notranslate nohighlight">
\[y_{s,n} = \widehat{h}_{s, n} x_{s,n} + w_{s,n}\]</div>
<p>where <span class="math notranslate nohighlight">\(y_{s,n}\)</span> is the channel output computed by this layer,
<span class="math notranslate nohighlight">\(\widehat{h}_{s, n}\)</span> the frequency channel response (<code class="docutils literal notranslate"><span class="pre">h_freq</span></code>),
<span class="math notranslate nohighlight">\(x_{s,n}\)</span> the channel input <code class="docutils literal notranslate"><span class="pre">x</span></code>, and <span class="math notranslate nohighlight">\(w_{s,n}\)</span> the additive noise.</p>
<p>For multiple-input multiple-output (MIMO) links, the channel output is computed for each antenna
of each receiver and by summing over all the antennas of all transmitters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>add_awgn</strong> (<em>bool</em>) – If set to <cite>False</cite>, no white Gaussian noise is added.
Defaults to <cite>True</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>tf.DType</em>) – Complex datatype to use for internal processing and output. Defaults to
<cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(x, h_freq, no) or (x, h_freq)</strong> – Tuple:</p></li>
<li><p><strong>x</strong> (<em>[batch size, num_tx, num_tx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – Channel inputs</p></li>
<li><p><strong>h_freq</strong> (<em>[batch size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – Channel frequency responses</p></li>
<li><p><strong>no</strong> (<em>Scalar or Tensor, tf.float</em>) – Scalar or tensor whose shape can be broadcast to the shape of the
channel outputs:
[batch size, num_rx, num_rx_ant, num_ofdm_symbols, fft_size].
Only required if <code class="docutils literal notranslate"><span class="pre">add_awgn</span></code> is set to <cite>True</cite>.
The noise power <code class="docutils literal notranslate"><span class="pre">no</span></code> is per complex dimension. If <code class="docutils literal notranslate"><span class="pre">no</span></code> is a
scalar, noise of the same variance will be added to the outputs.
If <code class="docutils literal notranslate"><span class="pre">no</span></code> is a tensor, it must have a shape that can be broadcast to
the shape of the channel outputs. This allows, e.g., adding noise of
different variance to each example in a batch. If <code class="docutils literal notranslate"><span class="pre">no</span></code> has a lower
rank than the channel outputs, then <code class="docutils literal notranslate"><span class="pre">no</span></code> will be broadcast to the
shape of the channel outputs by adding dummy dimensions after the
last axis.</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><p><strong>y</strong> (<em>[batch size, num_rx, num_rx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – Channel outputs</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="cir-to-ofdm-channel">
<h3>cir_to_ofdm_channel<a class="headerlink" href="#cir-to-ofdm-channel" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="sionna.channel.cir_to_ofdm_channel">
<span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">cir_to_ofdm_channel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frequencies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/utils.html#cir_to_ofdm_channel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.cir_to_ofdm_channel" title="Permalink to this definition"></a></dt>
<dd><p>Compute the frequency response of the channel at <code class="docutils literal notranslate"><span class="pre">frequencies</span></code>.</p>
<p>Given a channel impulse response
<span class="math notranslate nohighlight">\((a_{m}, \tau_{m}), 0 \leq m \leq M-1\)</span> (inputs <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">tau</span></code>),
the channel frequency response for the frequency <span class="math notranslate nohighlight">\(f\)</span>
is computed as follows:</p>
<div class="math notranslate nohighlight">
\[\widehat{h}(f) = \sum_{m=0}^{M-1} a_{m} e^{j2\pi f \tau_{m}}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frequencies</strong> (<em>[fft_size], tf.float</em>) – Frequencies at which to compute the channel response</p></li>
<li><p><strong>a</strong> (<em>[batch size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_paths, num_time_steps], tf.complex</em>) – Path coefficients</p></li>
<li><p><strong>tau</strong> (<em>[batch size, num_rx, num_tx, num_paths], tf.float</em>) – Path delays</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – If set to <cite>True</cite>, the channel is normalized over the resource grid
to ensure unit average energy per resource element. Defaults to <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p><strong>h_f</strong> (<em>[batch size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_time_steps, fft_size], tf.complex</em>) – Channel frequency responses at <code class="docutils literal notranslate"><span class="pre">frequencies</span></code></p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="rayleigh-block-fading">
<h2>Rayleigh block fading<a class="headerlink" href="#rayleigh-block-fading" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.RayleighBlockFading">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">RayleighBlockFading</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_rx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rx_ant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_tx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_tx_ant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/rayleigh_block_fading.html#RayleighBlockFading"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.RayleighBlockFading" title="Permalink to this definition"></a></dt>
<dd><p>Generate channel impulse responses corresponding to a Rayleigh block
fading channel model.</p>
<p>The channel impulse responses generated are formed of a single path with
zero delay and a normally distributed fading coefficient.
All time steps of a batch example share the same channel coefficient
(block fading).</p>
<p>This class can be used in conjunction with the classes that simulate the
channel response in time or frequency domain, i.e.,
<a class="reference internal" href="#sionna.channel.OFDMChannel" title="sionna.channel.OFDMChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">OFDMChannel</span></code></a>,
<a class="reference internal" href="#sionna.channel.TimeChannel" title="sionna.channel.TimeChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeChannel</span></code></a>,
<a class="reference internal" href="#sionna.channel.GenerateOFDMChannel" title="sionna.channel.GenerateOFDMChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenerateOFDMChannel</span></code></a>,
<a class="reference internal" href="#sionna.channel.ApplyOFDMChannel" title="sionna.channel.ApplyOFDMChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ApplyOFDMChannel</span></code></a>,
<a class="reference internal" href="#sionna.channel.GenerateTimeChannel" title="sionna.channel.GenerateTimeChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenerateTimeChannel</span></code></a>,
<a class="reference internal" href="#sionna.channel.ApplyTimeChannel" title="sionna.channel.ApplyTimeChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ApplyTimeChannel</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_rx</strong> (<em>int</em>) – Number of receivers (<span class="math notranslate nohighlight">\(N_R\)</span>)</p></li>
<li><p><strong>num_rx_ant</strong> (<em>int</em>) – Number of antennas per receiver (<span class="math notranslate nohighlight">\(N_{RA}\)</span>)</p></li>
<li><p><strong>num_tx</strong> (<em>int</em>) – Number of transmitters (<span class="math notranslate nohighlight">\(N_T\)</span>)</p></li>
<li><p><strong>num_tx_ant</strong> (<em>int</em>) – Number of antennas per transmitter (<span class="math notranslate nohighlight">\(N_{TA}\)</span>)</p></li>
<li><p><strong>dtype</strong> (<em>tf.DType</em>) – Complex datatype to use for internal processing and output.
Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size</p></li>
<li><p><strong>num_time_steps</strong> (<em>int</em>) – Number of time steps</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>[batch size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_paths = 1, num_time_steps], tf.complex</em>) – Path coefficients</p></li>
<li><p><strong>tau</strong> (<em>[batch size, num_rx, num_tx, num_paths = 1], tf.float</em>) – Path delays [s]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="gpp-38-901-channel-models">
<h2>3GPP 38.901 channel models<a class="headerlink" href="#gpp-38-901-channel-models" title="Permalink to this headline"></a></h2>
<p>The submodule <code class="docutils literal notranslate"><span class="pre">tr38901</span></code> implements 3GPP channel models from <a class="reference internal" href="#tr38901" id="id4"><span>[TR38901]</span></a>.</p>
<p>The <a class="reference internal" href="#cdl"><span class="std std-ref">CDL</span></a>, <a class="reference internal" href="#umi"><span class="std std-ref">UMi</span></a>, <a class="reference internal" href="#uma"><span class="std std-ref">UMa</span></a>, and <a class="reference internal" href="#rma"><span class="std std-ref">RMa</span></a>
models require setting-up antenna models for the transmitters and
receivers. This is achieved using the
<a class="reference internal" href="#sionna.channel.tr38901.PanelArray" title="sionna.channel.tr38901.PanelArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">PanelArray</span></code></a> class.</p>
<p>The <a class="reference internal" href="#umi"><span class="std std-ref">UMi</span></a>, <a class="reference internal" href="#uma"><span class="std std-ref">UMa</span></a>, and <a class="reference internal" href="#rma"><span class="std std-ref">RMa</span></a> models require
setting-up a network topology, specifying, e.g., the user terminals (UTs) and
base stations (BSs) locations, the UTs velocities, etc.
<a class="reference internal" href="#utility-functions"><span class="std std-ref">Utility functions</span></a> are available to help laying out
complex topologies or to quickly setup simple but widely used topologies.</p>
<div class="section" id="panelarray">
<h3>PanelArray<a class="headerlink" href="#panelarray" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.tr38901.</span></span><span class="sig-name descname"><span class="pre">PanelArray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">num_rows_per_panel</span></em>, <em class="sig-param"><span class="pre">num_cols_per_panel</span></em>, <em class="sig-param"><span class="pre">polarization</span></em>, <em class="sig-param"><span class="pre">polarization_type</span></em>, <em class="sig-param"><span class="pre">antenna_pattern</span></em>, <em class="sig-param"><span class="pre">carrier_frequency</span></em>, <em class="sig-param"><span class="pre">num_rows=1</span> <span class="pre">num_cols=1</span></em>, <em class="sig-param"><span class="pre">panel_vertical_spacing=None</span></em>, <em class="sig-param"><span class="pre">panel_horizontal_spacing=None</span></em>, <em class="sig-param"><span class="pre">element_vertical_spacing=None</span></em>, <em class="sig-param"><span class="pre">element_horizontal_spacing=None</span></em>, <em class="sig-param"><span class="pre">dtype=tf.complex64</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/tr38901/antenna.html#PanelArray"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.tr38901.PanelArray" title="Permalink to this definition"></a></dt>
<dd><p>Antenna panel array following the <a class="reference internal" href="#tr38901" id="id5"><span>[TR38901]</span></a> specification.</p>
<p>This class is used to create models of the panel arrays used by the
transmitters and receivers and that need to be specified when using the
<a class="reference internal" href="#cdl"><span class="std std-ref">CDL</span></a>, <a class="reference internal" href="#umi"><span class="std std-ref">UMi</span></a>, <a class="reference internal" href="#uma"><span class="std std-ref">UMa</span></a>, and <a class="reference internal" href="#rma"><span class="std std-ref">RMa</span></a>
models.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">PanelArray</span><span class="p">(</span><span class="n">num_rows_per_panel</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">num_cols_per_panel</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">polarization</span> <span class="o">=</span> <span class="s1">&#39;dual&#39;</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">polarization_type</span> <span class="o">=</span> <span class="s1">&#39;VH&#39;</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">antenna_pattern</span> <span class="o">=</span> <span class="s1">&#39;38.901&#39;</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">carrier_frequency</span> <span class="o">=</span> <span class="mf">3.5e9</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">num_cols</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">panel_horizontal_spacing</span> <span class="o">=</span> <span class="mf">3.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/panel_array.png" src="../_images/panel_array.png" />
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_rows_per_panel</strong> (<em>int</em>) – Number of rows of elements per panel</p></li>
<li><p><strong>num_cols_per_panel</strong> (<em>int</em>) – Number of columns of elements per panel</p></li>
<li><p><strong>polarization</strong> (<em>str</em>) – Polarization, either “single” or “dual”</p></li>
<li><p><strong>polarization_type</strong> (<em>str</em>) – Type of polarization. For single polarization, must be “V” or “H”.
For dual polarization, must be “VH” or “cross”.</p></li>
<li><p><strong>antenna_pattern</strong> (<em>str</em>) – Element radiation pattern, either “omni” or “38.901”</p></li>
<li><p><strong>carrier_frequency</strong> (<em>float</em>) – Carrier frequency [Hz]</p></li>
<li><p><strong>num_rows</strong> (<em>int</em>) – Number of rows of panels. Defaults to 1.</p></li>
<li><p><strong>num_cols</strong> (<em>int</em>) – Number of columns of panels. Defaults to 1.</p></li>
<li><p><strong>panel_vertical_spacing</strong> (<cite>None</cite> or float) – Vertical spacing of panels [multiples of wavelength].
Must be greater than the panel width.
If set to <cite>None</cite> (default value), it is set to the panel width + 0.5.</p></li>
<li><p><strong>panel_horizontal_spacing</strong> (<cite>None</cite> or float) – Horizontal spacing of panels [in multiples of wavelength].
Must be greater than the panel height.
If set to <cite>None</cite> (default value), it is set to the panel height + 0.5.</p></li>
<li><p><strong>element_vertical_spacing</strong> (<cite>None</cite> or float) – Element vertical spacing [multiple of wavelength].
Defaults to 0.5 if set to <cite>None</cite>.</p></li>
<li><p><strong>element_horizontal_spacing</strong> (<cite>None</cite> or float) – Element horizontal spacing [multiple of wavelength].
Defaults to 0.5 if set to <cite>None</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>Complex tf.DType</em>) – Defines the datatype for internal calculations and the output
dtype. Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.ant_ind_pol1">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ant_ind_pol1</span></span><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.ant_ind_pol1" title="Permalink to this definition"></a></dt>
<dd><p>Indices of antenna elements with the first polarization direction</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.ant_ind_pol2">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ant_ind_pol2</span></span><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.ant_ind_pol2" title="Permalink to this definition"></a></dt>
<dd><p>Indices of antenna elements with the second polarization direction.
Only defined with dual polarization.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.ant_pol1">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ant_pol1</span></span><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.ant_pol1" title="Permalink to this definition"></a></dt>
<dd><p>Field of an antenna element with the first polarization direction</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.ant_pol2">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ant_pol2</span></span><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.ant_pol2" title="Permalink to this definition"></a></dt>
<dd><p>Field of an antenna element with the second polarization direction.
Only defined with dual polarization.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.ant_pos">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ant_pos</span></span><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.ant_pos" title="Permalink to this definition"></a></dt>
<dd><p>Positions of the antennas</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.ant_pos_pol1">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ant_pos_pol1</span></span><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.ant_pos_pol1" title="Permalink to this definition"></a></dt>
<dd><p>Positions of the antenna elements with the first polarization
direction</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.ant_pos_pol2">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ant_pos_pol2</span></span><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.ant_pos_pol2" title="Permalink to this definition"></a></dt>
<dd><p>Positions of antenna elements with the second polarization direction.
Only defined with dual polarization.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.element_horizontal_spacing">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">element_horizontal_spacing</span></span><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.element_horizontal_spacing" title="Permalink to this definition"></a></dt>
<dd><p>Horizontal spacing between the antenna elements within a panel
[multiple of wavelength]</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.element_vertical_spacing">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">element_vertical_spacing</span></span><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.element_vertical_spacing" title="Permalink to this definition"></a></dt>
<dd><p>Vertical spacing between the antenna elements within a panel
[multiple of wavelength]</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.num_ant">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_ant</span></span><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.num_ant" title="Permalink to this definition"></a></dt>
<dd><p>Total number of antenna elements</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.num_cols">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_cols</span></span><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.num_cols" title="Permalink to this definition"></a></dt>
<dd><p>Number of columns of panels</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.num_cols_per_panel">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_cols_per_panel</span></span><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.num_cols_per_panel" title="Permalink to this definition"></a></dt>
<dd><p>Number of columns of elements per panel</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.num_panels">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_panels</span></span><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.num_panels" title="Permalink to this definition"></a></dt>
<dd><p>Number of panels</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.num_panels_ant">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_panels_ant</span></span><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.num_panels_ant" title="Permalink to this definition"></a></dt>
<dd><p>Number of antenna elements per panel</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.num_rows">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_rows</span></span><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.num_rows" title="Permalink to this definition"></a></dt>
<dd><p>Number of rows of panels</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.num_rows_per_panel">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_rows_per_panel</span></span><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.num_rows_per_panel" title="Permalink to this definition"></a></dt>
<dd><p>Number of rows of elements per panel</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.panel_horizontal_spacing">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">panel_horizontal_spacing</span></span><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.panel_horizontal_spacing" title="Permalink to this definition"></a></dt>
<dd><p>Horizontal spacing between the panels [multiple of wavelength]</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.panel_vertical_spacing">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">panel_vertical_spacing</span></span><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.panel_vertical_spacing" title="Permalink to this definition"></a></dt>
<dd><p>Vertical spacing between the panels [multiple of wavelength]</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.polarization">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">polarization</span></span><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.polarization" title="Permalink to this definition"></a></dt>
<dd><p>Polarization (“single” or “dual”)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.polarization_type">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">polarization_type</span></span><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.polarization_type" title="Permalink to this definition"></a></dt>
<dd><p>Polarization type. “V” or “H” for single polarization.
“VH” or “cross” for dual polarization.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/tr38901/antenna.html#PanelArray.show"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.show" title="Permalink to this definition"></a></dt>
<dd><p>Show the panel array geometry</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sionna.channel.tr38901.PanelArray.show_element_radiation_pattern">
<span class="sig-name descname"><span class="pre">show_element_radiation_pattern</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/tr38901/antenna.html#PanelArray.show_element_radiation_pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.tr38901.PanelArray.show_element_radiation_pattern" title="Permalink to this definition"></a></dt>
<dd><p>Show the radiation field of antenna elements forming the panel</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="antenna">
<h3>Antenna<a class="headerlink" href="#antenna" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.tr38901.Antenna">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.tr38901.</span></span><span class="sig-name descname"><span class="pre">Antenna</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polarization</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polarization_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna_pattern</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">carrier_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/tr38901/antenna.html#Antenna"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.tr38901.Antenna" title="Permalink to this definition"></a></dt>
<dd><p>Single antenna following the <a class="reference internal" href="#tr38901" id="id6"><span>[TR38901]</span></a> specification.</p>
<p>This class is a special case of <a class="reference internal" href="#sionna.channel.tr38901.PanelArray" title="sionna.channel.tr38901.PanelArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">PanelArray</span></code></a>,
and can be used in lieu of it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>polarization</strong> (<em>str</em>) – Polarization, either “single” or “dual”</p></li>
<li><p><strong>polarization_type</strong> (<em>str</em>) – Type of polarization. For single polarization, must be “V” or “H”.
For dual polarization, must be “VH” or “cross”.</p></li>
<li><p><strong>antenna_pattern</strong> (<em>str</em>) – Element radiation pattern, either “omni” or “38.901”</p></li>
<li><p><strong>carrier_frequency</strong> (<em>float</em>) – Carrier frequency [Hz]</p></li>
<li><p><strong>dtype</strong> (<em>Complex tf.DType</em>) – Defines the datatype for internal calculations and the output
dtype. Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="antennaarray">
<h3>AntennaArray<a class="headerlink" href="#antennaarray" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.tr38901.AntennaArray">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.tr38901.</span></span><span class="sig-name descname"><span class="pre">AntennaArray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polarization</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polarization_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna_pattern</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">carrier_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_spacing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">horizontal_spacing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/tr38901/antenna.html#AntennaArray"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.tr38901.AntennaArray" title="Permalink to this definition"></a></dt>
<dd><p>Antenna array following the <a class="reference internal" href="#tr38901" id="id7"><span>[TR38901]</span></a> specification.</p>
<p>This class is a special case of <a class="reference internal" href="#sionna.channel.tr38901.PanelArray" title="sionna.channel.tr38901.PanelArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">PanelArray</span></code></a>,
and can used in lieu of it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_rows</strong> (<em>int</em>) – Number of rows of elements</p></li>
<li><p><strong>num_cols</strong> (<em>int</em>) – Number of columns of elements</p></li>
<li><p><strong>polarization</strong> (<em>str</em>) – Polarization, either “single” or “dual”</p></li>
<li><p><strong>polarization_type</strong> (<em>str</em>) – Type of polarization. For single polarization, must be “V” or “H”.
For dual polarization, must be “VH” or “cross”.</p></li>
<li><p><strong>antenna_pattern</strong> (<em>str</em>) – Element radiation pattern, either “omni” or “38.901”</p></li>
<li><p><strong>carrier_frequency</strong> (<em>float</em>) – Carrier frequency [Hz]</p></li>
<li><p><strong>vertical_spacing</strong> (<cite>None</cite> or float) – Element vertical spacing [multiple of wavelength].
Defaults to 0.5 if set to <cite>None</cite>.</p></li>
<li><p><strong>horizontal_spacing</strong> (<cite>None</cite> or float) – Element horizontal spacing [multiple of wavelength].
Defaults to 0.5 if set to <cite>None</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>Complex tf.DType</em>) – Defines the datatype for internal calculations and the output
dtype. Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="tapped-delay-line-tdl">
<span id="tdl"></span><h3>Tapped delay line (TDL)<a class="headerlink" href="#tapped-delay-line-tdl" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.tr38901.TDL">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.tr38901.</span></span><span class="sig-name descname"><span class="pre">TDL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delay_spread</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">carrier_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_sinusoids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">los_angle_of_arrival</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PI</span> <span class="pre">/</span> <span class="pre">4.</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_speed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_speed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/tr38901/tdl.html#TDL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.tr38901.TDL" title="Permalink to this definition"></a></dt>
<dd><p>Tapped delay line (TDL) channel model from 3GPP <a class="reference internal" href="#tr38901" id="id8"><span>[TR38901]</span></a> specification.</p>
<p>Channel coefficients are generated using a sum-of-sinusoids model <a class="reference internal" href="#sos" id="id9"><span>[SoS]</span></a>.
Channel aging is simulated in the event of mobility.</p>
<p>If a minimum speed and a maximum speed are specified such that the
maximum speed is greater than the minimum speed, then speeds are randomly
and uniformly sampled from the specified interval for each link and each
batch example.</p>
<p>The TDL model only works for single-input single-output (SISO) systems.
One can conduct simulations for multiple-input multiple-output (MIMO)
systems using the other channel models available in Sionna.</p>
<p class="rubric">Example</p>
<p>The following code snippet shows how to setup a TDL channel model assuming
an OFDM waveform:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tdl</span> <span class="o">=</span> <span class="n">TDL</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">delay_spread</span> <span class="o">=</span> <span class="mf">300e-9</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">carrier_frequency</span> <span class="o">=</span> <span class="mf">3.5e9</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">min_speed</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">max_speed</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">OFDMChannel</span><span class="p">(</span><span class="n">channel_model</span> <span class="o">=</span> <span class="n">tdl</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">resource_grid</span> <span class="o">=</span> <span class="n">rg</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">rg</span></code> is an instance of <a class="reference internal" href="ofdm.html#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>.</p>
<p class="rubric">Notes</p>
<p>The following tables from <a class="reference internal" href="#tr38901" id="id10"><span>[TR38901]</span></a> provide typical values for the delay
spread.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 60%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Model</p></th>
<th class="head"><p>Delay spread</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Very short delay spread</p></td>
<td><p><span class="math notranslate nohighlight">\(10\)</span> ns</p></td>
</tr>
<tr class="row-odd"><td><p>Short short delay spread</p></td>
<td><p><span class="math notranslate nohighlight">\(10\)</span> ns</p></td>
</tr>
<tr class="row-even"><td><p>Nominal delay spread</p></td>
<td><p><span class="math notranslate nohighlight">\(100\)</span> ns</p></td>
</tr>
<tr class="row-odd"><td><p>Long delay spread</p></td>
<td><p><span class="math notranslate nohighlight">\(300\)</span> ns</p></td>
</tr>
<tr class="row-even"><td><p>Very long delay spread</p></td>
<td><p><span class="math notranslate nohighlight">\(1000\)</span> ns</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 27%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 5%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 5%" />
<col style="width: 6%" />
</colgroup>
<tbody>
<tr class="row-odd"><td colspan="2"><p>Delay spread [ns]</p></td>
<td colspan="7"><p>Frequency [GHz]</p></td>
</tr>
<tr class="row-even"><td rowspan="3"><p>Indoor office</p></td>
<td><p>Short delay profile</p></td>
<td><p>20</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
</tr>
<tr class="row-odd"><td><p>Normal delay profile</p></td>
<td><p>39</p></td>
<td><p>30</p></td>
<td><p>24</p></td>
<td><p>20</p></td>
<td><p>18</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
</tr>
<tr class="row-even"><td><p>Long delay profile</p></td>
<td><p>59</p></td>
<td><p>53</p></td>
<td><p>47</p></td>
<td><p>43</p></td>
<td><p>41</p></td>
<td><p>38</p></td>
<td><p>37</p></td>
</tr>
<tr class="row-odd"><td rowspan="3"><p>UMi Street-canyon</p></td>
<td><p>Short delay profile</p></td>
<td><p>65</p></td>
<td><p>45</p></td>
<td><p>37</p></td>
<td><p>32</p></td>
<td><p>30</p></td>
<td><p>27</p></td>
<td><p>26</p></td>
</tr>
<tr class="row-even"><td><p>Normal delay profile</p></td>
<td><p>129</p></td>
<td><p>93</p></td>
<td><p>76</p></td>
<td><p>66</p></td>
<td><p>61</p></td>
<td><p>55</p></td>
<td><p>53</p></td>
</tr>
<tr class="row-odd"><td><p>Long delay profile</p></td>
<td><p>634</p></td>
<td><p>316</p></td>
<td><p>307</p></td>
<td><p>301</p></td>
<td><p>297</p></td>
<td><p>293</p></td>
<td><p>291</p></td>
</tr>
<tr class="row-even"><td rowspan="3"><p>UMa</p></td>
<td><p>Short delay profile</p></td>
<td><p>93</p></td>
<td><p>93</p></td>
<td><p>85</p></td>
<td><p>80</p></td>
<td><p>78</p></td>
<td><p>75</p></td>
<td><p>74</p></td>
</tr>
<tr class="row-odd"><td><p>Normal delay profile</p></td>
<td><p>363</p></td>
<td><p>363</p></td>
<td><p>302</p></td>
<td><p>266</p></td>
<td><p>249</p></td>
<td><p>228</p></td>
<td><p>221</p></td>
</tr>
<tr class="row-even"><td><p>Long delay profile</p></td>
<td><p>1148</p></td>
<td><p>1148</p></td>
<td><p>955</p></td>
<td><p>841</p></td>
<td><p>786</p></td>
<td><p>720</p></td>
<td><p>698</p></td>
</tr>
<tr class="row-odd"><td rowspan="3"><p>RMa / RMa O2I</p></td>
<td><p>Short delay profile</p></td>
<td><p>32</p></td>
<td><p>32</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-even"><td><p>Normal delay profile</p></td>
<td><p>37</p></td>
<td><p>37</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-odd"><td><p>Long delay profile</p></td>
<td><p>153</p></td>
<td><p>153</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>UMi / UMa O2I</p></td>
<td><p>Normal delay profile</p></td>
<td colspan="7"><p>242</p></td>
</tr>
<tr class="row-odd"><td><p>Long delay profile</p></td>
<td colspan="7"><p>616</p></td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>str</em>) – TDL model to use. Must be one of “A”, “B”, “C”, “D” or “E”.</p></li>
<li><p><strong>delay_spread</strong> (<em>float</em>) – RMS delay spread [s]</p></li>
<li><p><strong>carrier_frequency</strong> (<em>float</em>) – Carrier frequency [Hz]</p></li>
<li><p><strong>num_sinusoids</strong> (<em>int</em>) – Number of sinusoids for the sum-of-sinusoids model. Defaults to 20.</p></li>
<li><p><strong>los_angle_of_arrival</strong> (<em>float</em>) – Angle-of-arrival for LoS path [radian]. Only used with LoS models.
Defaults to <span class="math notranslate nohighlight">\(\pi/4\)</span>.</p></li>
<li><p><strong>min_speed</strong> (<em>float</em>) – Minimum speed [m/s]. Defaults to 0.</p></li>
<li><p><strong>max_speed</strong> (<em>None</em><em> or </em><em>float</em>) – Maximum speed [m/s]. If set to <cite>None</cite>,
then <code class="docutils literal notranslate"><span class="pre">max_speed</span></code> takes the same value as <code class="docutils literal notranslate"><span class="pre">min_speed</span></code>.
Defaults to <cite>None</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>Complex tf.DType</em>) – Defines the datatype for internal calculations and the output
dtype. Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size</p></li>
<li><p><strong>num_time_steps</strong> (<em>int</em>) – Number of time steps</p></li>
<li><p><strong>sampling_frequency</strong> (<em>float</em>) – Sampling frequency [Hz]</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>[batch size, num_rx = 1, num_rx_ant = 1, num_tx = 1, num_tx_ant = 1, num_paths, num_time_steps], tf.complex</em>) – Path coefficients</p></li>
<li><p><strong>tau</strong> (<em>[batch size, num_rx = 1, num_tx = 1, num_paths], tf.float</em>) – Path delays [s]</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.TDL.delay_spread">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">delay_spread</span></span><a class="headerlink" href="#sionna.channel.tr38901.TDL.delay_spread" title="Permalink to this definition"></a></dt>
<dd><p>RMS delay spread [s]</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.TDL.delays">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">delays</span></span><a class="headerlink" href="#sionna.channel.tr38901.TDL.delays" title="Permalink to this definition"></a></dt>
<dd><p>Path delays [s]</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.TDL.k_factor">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">k_factor</span></span><a class="headerlink" href="#sionna.channel.tr38901.TDL.k_factor" title="Permalink to this definition"></a></dt>
<dd><p>K-factor in linear scale. Only available with LoS models.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.TDL.los">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">los</span></span><a class="headerlink" href="#sionna.channel.tr38901.TDL.los" title="Permalink to this definition"></a></dt>
<dd><p><cite>True</cite> if this is a LoS model. <cite>False</cite> otherwise.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.TDL.mean_power_los">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">mean_power_los</span></span><a class="headerlink" href="#sionna.channel.tr38901.TDL.mean_power_los" title="Permalink to this definition"></a></dt>
<dd><p>LoS component power in linear scale.
Only available with LoS models.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.TDL.mean_powers">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">mean_powers</span></span><a class="headerlink" href="#sionna.channel.tr38901.TDL.mean_powers" title="Permalink to this definition"></a></dt>
<dd><p>Path powers in linear scale</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.TDL.num_clusters">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_clusters</span></span><a class="headerlink" href="#sionna.channel.tr38901.TDL.num_clusters" title="Permalink to this definition"></a></dt>
<dd><p>Number of paths (<span class="math notranslate nohighlight">\(M\)</span>)</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="clustered-delay-line-cdl">
<span id="cdl"></span><h3>Clustered delay line (CDL)<a class="headerlink" href="#clustered-delay-line-cdl" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.tr38901.CDL">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.tr38901.</span></span><span class="sig-name descname"><span class="pre">CDL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delay_spread</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">carrier_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ut_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_speed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_speed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/tr38901/cdl.html#CDL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.tr38901.CDL" title="Permalink to this definition"></a></dt>
<dd><p>Clustered delay line (CDL) channel model from 3GPP <a class="reference internal" href="#tr38901" id="id11"><span>[TR38901]</span></a> specification.</p>
<p>If a minimum speed and a maximum speed are specified such that the
maximum speed is greater than the minimum speed, then UTs speeds are
randomly and uniformly sampled from the specified interval for each link
and each batch example.</p>
<p>The CDL model only works for systems with a single transmitter and a single
receiver. The transmitter and receiver can be equipped with multiple
antennas.</p>
<p class="rubric">Example</p>
<p>The following code snippet shows how to setup a CDL channel model assuming
an OFDM waveform:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Panel array configuration for the transmitter and receiver</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bs_array</span> <span class="o">=</span> <span class="n">PanelArray</span><span class="p">(</span><span class="n">num_rows_per_panel</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">num_cols_per_panel</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">polarization</span> <span class="o">=</span> <span class="s1">&#39;dual&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">polarization_type</span> <span class="o">=</span> <span class="s1">&#39;cross&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">antenna_pattern</span> <span class="o">=</span> <span class="s1">&#39;38.901&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">carrier_frequency</span> <span class="o">=</span> <span class="mf">3.5e9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut_array</span> <span class="o">=</span> <span class="n">PanelArray</span><span class="p">(</span><span class="n">num_rows_per_panel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">num_cols_per_panel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">polarization</span> <span class="o">=</span> <span class="s1">&#39;single&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">polarization_type</span> <span class="o">=</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">antenna_pattern</span> <span class="o">=</span> <span class="s1">&#39;omni&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">carrier_frequency</span> <span class="o">=</span> <span class="mf">3.5e9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># CDL channel model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cdl</span> <span class="o">=</span> <span class="n">CDL</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>          <span class="n">delay_spread</span> <span class="o">=</span> <span class="mf">300e-9</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">carrier_frequency</span> <span class="o">=</span> <span class="mf">3.5e9</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">ut_array</span> <span class="o">=</span> <span class="n">ut_array</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">bs_array</span> <span class="o">=</span> <span class="n">bs_array</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;uplink&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">OFDMChannel</span><span class="p">(</span><span class="n">channel_model</span> <span class="o">=</span> <span class="n">cdl</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">resource_grid</span> <span class="o">=</span> <span class="n">rg</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">rg</span></code> is an instance of <a class="reference internal" href="ofdm.html#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>.</p>
<p class="rubric">Notes</p>
<p>The following tables from <a class="reference internal" href="#tr38901" id="id12"><span>[TR38901]</span></a> provide typical values for the delay
spread.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 60%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Model</p></th>
<th class="head"><p>Delay spread</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Very short delay spread</p></td>
<td><p><span class="math notranslate nohighlight">\(10\)</span> ns</p></td>
</tr>
<tr class="row-odd"><td><p>Short short delay spread</p></td>
<td><p><span class="math notranslate nohighlight">\(10\)</span> ns</p></td>
</tr>
<tr class="row-even"><td><p>Nominal delay spread</p></td>
<td><p><span class="math notranslate nohighlight">\(100\)</span> ns</p></td>
</tr>
<tr class="row-odd"><td><p>Long delay spread</p></td>
<td><p><span class="math notranslate nohighlight">\(300\)</span> ns</p></td>
</tr>
<tr class="row-even"><td><p>Very long delay spread</p></td>
<td><p><span class="math notranslate nohighlight">\(1000\)</span> ns</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 27%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 5%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 5%" />
<col style="width: 6%" />
</colgroup>
<tbody>
<tr class="row-odd"><td colspan="2"><p>Delay spread [ns]</p></td>
<td colspan="7"><p>Frequency [GHz]</p></td>
</tr>
<tr class="row-even"><td rowspan="3"><p>Indoor office</p></td>
<td><p>Short delay profile</p></td>
<td><p>20</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
</tr>
<tr class="row-odd"><td><p>Normal delay profile</p></td>
<td><p>39</p></td>
<td><p>30</p></td>
<td><p>24</p></td>
<td><p>20</p></td>
<td><p>18</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
</tr>
<tr class="row-even"><td><p>Long delay profile</p></td>
<td><p>59</p></td>
<td><p>53</p></td>
<td><p>47</p></td>
<td><p>43</p></td>
<td><p>41</p></td>
<td><p>38</p></td>
<td><p>37</p></td>
</tr>
<tr class="row-odd"><td rowspan="3"><p>UMi Street-canyon</p></td>
<td><p>Short delay profile</p></td>
<td><p>65</p></td>
<td><p>45</p></td>
<td><p>37</p></td>
<td><p>32</p></td>
<td><p>30</p></td>
<td><p>27</p></td>
<td><p>26</p></td>
</tr>
<tr class="row-even"><td><p>Normal delay profile</p></td>
<td><p>129</p></td>
<td><p>93</p></td>
<td><p>76</p></td>
<td><p>66</p></td>
<td><p>61</p></td>
<td><p>55</p></td>
<td><p>53</p></td>
</tr>
<tr class="row-odd"><td><p>Long delay profile</p></td>
<td><p>634</p></td>
<td><p>316</p></td>
<td><p>307</p></td>
<td><p>301</p></td>
<td><p>297</p></td>
<td><p>293</p></td>
<td><p>291</p></td>
</tr>
<tr class="row-even"><td rowspan="3"><p>UMa</p></td>
<td><p>Short delay profile</p></td>
<td><p>93</p></td>
<td><p>93</p></td>
<td><p>85</p></td>
<td><p>80</p></td>
<td><p>78</p></td>
<td><p>75</p></td>
<td><p>74</p></td>
</tr>
<tr class="row-odd"><td><p>Normal delay profile</p></td>
<td><p>363</p></td>
<td><p>363</p></td>
<td><p>302</p></td>
<td><p>266</p></td>
<td><p>249</p></td>
<td><p>228</p></td>
<td><p>221</p></td>
</tr>
<tr class="row-even"><td><p>Long delay profile</p></td>
<td><p>1148</p></td>
<td><p>1148</p></td>
<td><p>955</p></td>
<td><p>841</p></td>
<td><p>786</p></td>
<td><p>720</p></td>
<td><p>698</p></td>
</tr>
<tr class="row-odd"><td rowspan="3"><p>RMa / RMa O2I</p></td>
<td><p>Short delay profile</p></td>
<td><p>32</p></td>
<td><p>32</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-even"><td><p>Normal delay profile</p></td>
<td><p>37</p></td>
<td><p>37</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-odd"><td><p>Long delay profile</p></td>
<td><p>153</p></td>
<td><p>153</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>UMi / UMa O2I</p></td>
<td><p>Normal delay profile</p></td>
<td colspan="7"><p>242</p></td>
</tr>
<tr class="row-odd"><td><p>Long delay profile</p></td>
<td colspan="7"><p>616</p></td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>str</em>) – CDL model to use. Must be one of “A”, “B”, “C”, “D” or “E”.</p></li>
<li><p><strong>delay_spread</strong> (<em>float</em>) – RMS delay spread [s].</p></li>
<li><p><strong>carrier_frequency</strong> (<em>float</em>) – Carrier frequency [Hz].</p></li>
<li><p><strong>ut_array</strong> (<a class="reference internal" href="#sionna.channel.tr38901.PanelArray" title="sionna.channel.tr38901.PanelArray"><em>PanelArray</em></a>) – Panel array used by the UTs. All UTs share the same antenna array
configuration.</p></li>
<li><p><strong>bs_array</strong> (<a class="reference internal" href="#sionna.channel.tr38901.PanelArray" title="sionna.channel.tr38901.PanelArray"><em>PanelArray</em></a>) – Panel array used by the Bs. All BSs share the same antenna array
configuration.</p></li>
<li><p><strong>direction</strong> (<em>str</em>) – Link direction. Must be either “uplink” or “downlink”.</p></li>
<li><p><strong>ut_orientation</strong> (<cite>None</cite> or Tensor of shape [3], tf.float) – Orientation of the UT. If set to <cite>None</cite>, [<span class="math notranslate nohighlight">\(\pi\)</span>, 0, 0] is used.
Defaults to <cite>None</cite>.</p></li>
<li><p><strong>bs_orientation</strong> (<cite>None</cite> or Tensor of shape [3], tf.float) – Orientation of the BS. If set to <cite>None</cite>, [0, 0, 0] is used.
Defaults to <cite>None</cite>.</p></li>
<li><p><strong>min_speed</strong> (<em>float</em>) – Minimum speed [m/s]. Defaults to 0.</p></li>
<li><p><strong>max_speed</strong> (<em>None</em><em> or </em><em>float</em>) – Maximum speed [m/s]. If set to <cite>None</cite>,
then <code class="docutils literal notranslate"><span class="pre">max_speed</span></code> takes the same value as <code class="docutils literal notranslate"><span class="pre">min_speed</span></code>.
Defaults to <cite>None</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>Complex tf.DType</em>) – Defines the datatype for internal calculations and the output
dtype. Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size</p></li>
<li><p><strong>num_time_steps</strong> (<em>int</em>) – Number of time steps</p></li>
<li><p><strong>sampling_frequency</strong> (<em>float</em>) – Sampling frequency [Hz]</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>[batch size, num_rx = 1, num_rx_ant, num_tx = 1, num_tx_ant, num_paths, num_time_steps], tf.complex</em>) – Path coefficients</p></li>
<li><p><strong>tau</strong> (<em>[batch size, num_rx = 1, num_tx = 1, num_paths], tf.float</em>) – Path delays [s]</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.CDL.delay_spread">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">delay_spread</span></span><a class="headerlink" href="#sionna.channel.tr38901.CDL.delay_spread" title="Permalink to this definition"></a></dt>
<dd><p>RMS delay spread [s]</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.CDL.delays">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">delays</span></span><a class="headerlink" href="#sionna.channel.tr38901.CDL.delays" title="Permalink to this definition"></a></dt>
<dd><p>Path delays [s]</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.CDL.k_factor">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">k_factor</span></span><a class="headerlink" href="#sionna.channel.tr38901.CDL.k_factor" title="Permalink to this definition"></a></dt>
<dd><p>K-factor in linear scale. Only available with LoS models.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.CDL.los">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">los</span></span><a class="headerlink" href="#sionna.channel.tr38901.CDL.los" title="Permalink to this definition"></a></dt>
<dd><p><cite>True</cite> is this is a LoS model. <cite>False</cite> otherwise.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.CDL.num_clusters">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_clusters</span></span><a class="headerlink" href="#sionna.channel.tr38901.CDL.num_clusters" title="Permalink to this definition"></a></dt>
<dd><p>Number of paths (<span class="math notranslate nohighlight">\(M\)</span>)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.tr38901.CDL.powers">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">powers</span></span><a class="headerlink" href="#sionna.channel.tr38901.CDL.powers" title="Permalink to this definition"></a></dt>
<dd><p>Path powers in linear scale</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="urban-microcell-umi">
<span id="umi"></span><h3>Urban microcell (UMi)<a class="headerlink" href="#urban-microcell-umi" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.tr38901.UMi">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.tr38901.</span></span><span class="sig-name descname"><span class="pre">UMi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">carrier_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">o2i_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ut_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_pathloss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_shadow_fading</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">always_generate_lsp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/tr38901/umi.html#UMi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.tr38901.UMi" title="Permalink to this definition"></a></dt>
<dd><p>Urban microcell (UMi) channel model from 3GPP <a class="reference internal" href="#tr38901" id="id13"><span>[TR38901]</span></a> specification.</p>
<p>Setting up a UMi model requires configuring the network topology, i.e., the
UTs and BSs locations, UTs velocities, etc. This is achieved using the
<a class="reference internal" href="#sionna.channel.tr38901.UMi.set_topology" title="sionna.channel.tr38901.UMi.set_topology"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_topology()</span></code></a> method. Setting a different
topology for each batch example is possible. The batch size used when setting up the network topology
is used for the link simulations.</p>
<p>The following code snippet shows how to setup a UMi channel model operating
in the frequency domain:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># UT and BS panel arrays</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bs_array</span> <span class="o">=</span> <span class="n">PanelArray</span><span class="p">(</span><span class="n">num_rows_per_panel</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">num_cols_per_panel</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">polarization</span> <span class="o">=</span> <span class="s1">&#39;dual&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">polarization_type</span>  <span class="o">=</span> <span class="s1">&#39;cross&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">antenna_pattern</span> <span class="o">=</span> <span class="s1">&#39;38.901&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">carrier_frequency</span> <span class="o">=</span> <span class="mf">3.5e9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut_array</span> <span class="o">=</span> <span class="n">PanelArray</span><span class="p">(</span><span class="n">num_rows_per_panel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">num_cols_per_panel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">polarization</span> <span class="o">=</span> <span class="s1">&#39;single&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">polarization_type</span> <span class="o">=</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">antenna_pattern</span> <span class="o">=</span> <span class="s1">&#39;omni&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">carrier_frequency</span> <span class="o">=</span> <span class="mf">3.5e9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Instantiating UMi channel model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel_model</span> <span class="o">=</span> <span class="n">UMi</span><span class="p">(</span><span class="n">carrier_frequency</span> <span class="o">=</span> <span class="mf">3.5e9</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">o2i_model</span> <span class="o">=</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">ut_array</span> <span class="o">=</span> <span class="n">ut_array</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">bs_array</span> <span class="o">=</span> <span class="n">bs_array</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;uplink&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Setting up network topology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ut_loc: UTs locations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># bs_loc: BSs locations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ut_orientations: UTs array orientations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># bs_orientations: BSs array orientations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># in_state: Indoor/outdoor states of UTs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel_model</span><span class="o">.</span><span class="n">set_topology</span><span class="p">(</span><span class="n">ut_loc</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">bs_loc</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">ut_orientations</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">bs_orientations</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">ut_velocities</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">in_state</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Instanting the frequency domain channel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">OFDMChannel</span><span class="p">(</span><span class="n">channel_model</span> <span class="o">=</span> <span class="n">channel_model</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">resource_grid</span> <span class="o">=</span> <span class="n">rg</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">rg</span></code> is an instance of <a class="reference internal" href="ofdm.html#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>carrier_frequency</strong> (<em>float</em>) – Carrier frequency in Hertz</p></li>
<li><p><strong>o2i_model</strong> (<em>str</em>) – Outdoor-to-indoor loss model for UTs located indoor.
Set this parameter to “low” to use the low-loss model, or to “high”
to use the high-loss model.
See section 7.4.3 of <a class="reference internal" href="#tr38901" id="id14"><span>[TR38901]</span></a> for details.</p></li>
<li><p><strong>rx_array</strong> (<a class="reference internal" href="#sionna.channel.tr38901.PanelArray" title="sionna.channel.tr38901.PanelArray"><em>PanelArray</em></a>) – Panel array used by the receivers. All receivers share the same
antenna array configuration.</p></li>
<li><p><strong>tx_array</strong> (<a class="reference internal" href="#sionna.channel.tr38901.PanelArray" title="sionna.channel.tr38901.PanelArray"><em>PanelArray</em></a>) – Panel array used by the transmitters. All transmitters share the
same antenna array configuration.</p></li>
<li><p><strong>direction</strong> (<em>str</em>) – Link direction. Either “uplink” or “downlink”.</p></li>
<li><p><strong>enable_pathloss</strong> (<em>bool</em>) – If <cite>True</cite>, apply pathloss. Otherwise doesn’t. Defaults to <cite>True</cite>.</p></li>
<li><p><strong>enable_shadow_fading</strong> (<em>bool</em>) – If <cite>True</cite>, apply shadow fading. Otherwise doesn’t.
Defaults to <cite>True</cite>.</p></li>
<li><p><strong>always_generate_lsp</strong> (<em>bool</em>) – If <cite>True</cite>, new large scale parameters (LSPs) are generated for every
new generation of channel impulse responses. Otherwise, always reuse
the same LSPs, except if the topology is changed. Defaults to
<cite>False</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>Complex tf.DType</em>) – Defines the datatype for internal calculations and the output
dtype. Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_time_steps</strong> (<em>int</em>) – Number of time steps</p></li>
<li><p><strong>sampling_frequency</strong> (<em>float</em>) – Sampling frequency [Hz]</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>[batch size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_paths, num_time_steps], tf.complex</em>) – Path coefficients</p></li>
<li><p><strong>tau</strong> (<em>[batch size, num_rx, num_tx, num_paths], tf.float</em>) – Path delays [s]</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sionna.channel.tr38901.UMi.set_topology">
<span class="sig-name descname"><span class="pre">set_topology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ut_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ut_orientations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs_orientations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ut_velocities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">los</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sionna.channel.tr38901.UMi.set_topology" title="Permalink to this definition"></a></dt>
<dd><p>Set the network topology.</p>
<p>It is possible to set up a different network topology for each batch
example. The batch size used when setting up the network topology
is used for the link simulations.</p>
<p>When calling this function, not specifying a parameter leads to the
reuse of the previously given value. Not specifying a value that was not
set at a former call rises an error.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ut_loc</strong> (<em>[batch size,num_ut, 3], tf.float</em>) – Locations of the UTs</p></li>
<li><p><strong>bs_loc</strong> (<em>[batch size,num_bs, 3], tf.float</em>) – Locations of BSs</p></li>
<li><p><strong>ut_orientations</strong> (<em>[batch size,num_ut, 3], tf.float</em>) – Orientations of the UTs arrays [radian]</p></li>
<li><p><strong>bs_orientations</strong> (<em>[batch size,num_bs, 3], tf.float</em>) – Orientations of the BSs arrays [radian]</p></li>
<li><p><strong>ut_velocities</strong> (<em>[batch size,num_ut, 3], tf.float</em>) – Velocity vectors of UTs</p></li>
<li><p><strong>in_state</strong> (<em>[batch size,num_ut], tf.bool</em>) – Indoor/outdoor state of UTs. <cite>True</cite> means indoor and <cite>False</cite>
means outdoor.</p></li>
<li><p><strong>los</strong> (tf.bool or <cite>None</cite>) – If not <cite>None</cite> (default value), all UTs located outdoor are
forced to be in LoS if <code class="docutils literal notranslate"><span class="pre">los</span></code> is set to <cite>True</cite>, or in NLoS
if it is set to <cite>False</cite>. If set to <cite>None</cite>, the LoS/NLoS states
of UTs is set following 3GPP specification <a class="reference internal" href="#tr38901" id="id15"><span>[TR38901]</span></a>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to use this function in Graph mode with XLA, i.e., within
a function that is decorated with <code class="docutils literal notranslate"><span class="pre">&#64;tf.function(jit_compile=True)</span></code>,
you must set <code class="docutils literal notranslate"><span class="pre">sionna.Config.xla_compat=true</span></code>.
See <a class="reference internal" href="config.html#sionna.Config.xla_compat" title="sionna.Config.xla_compat"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xla_compat</span></code></a>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sionna.channel.tr38901.UMi.show_topology">
<span class="sig-name descname"><span class="pre">show_topology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bs_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sionna.channel.tr38901.UMi.show_topology" title="Permalink to this definition"></a></dt>
<dd><p>Shows the network topology of the batch example with index
<code class="docutils literal notranslate"><span class="pre">batch_index</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">bs_index</span></code> parameter specifies with respect to which BS the
LoS/NLoS state of UTs is indicated.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bs_index</strong> (<em>int</em>) – BS index with respect to which the LoS/NLoS state of UTs is
indicated. Defaults to 0.</p></li>
<li><p><strong>batch_index</strong> (<em>int</em>) – Batch example for which the topology is shown. Defaults to 0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="urban-macrocell-uma">
<span id="uma"></span><h3>Urban macrocell (UMa)<a class="headerlink" href="#urban-macrocell-uma" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.tr38901.UMa">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.tr38901.</span></span><span class="sig-name descname"><span class="pre">UMa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">carrier_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">o2i_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ut_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_pathloss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_shadow_fading</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">always_generate_lsp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/tr38901/uma.html#UMa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.tr38901.UMa" title="Permalink to this definition"></a></dt>
<dd><p>Urban macrocell (UMa) channel model from 3GPP <a class="reference internal" href="#tr38901" id="id16"><span>[TR38901]</span></a> specification.</p>
<p>Setting up a UMa model requires configuring the network topology, i.e., the
UTs and BSs locations, UTs velocities, etc. This is achieved using the
<a class="reference internal" href="#sionna.channel.tr38901.UMa.set_topology" title="sionna.channel.tr38901.UMa.set_topology"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_topology()</span></code></a> method. Setting a different
topology for each batch example is possible. The batch size used when setting up the network topology
is used for the link simulations.</p>
<p>The following code snippet shows how to setup an UMa channel model assuming
an OFDM waveform:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># UT and BS panel arrays</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bs_array</span> <span class="o">=</span> <span class="n">PanelArray</span><span class="p">(</span><span class="n">num_rows_per_panel</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">num_cols_per_panel</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">polarization</span> <span class="o">=</span> <span class="s1">&#39;dual&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">polarization_type</span> <span class="o">=</span> <span class="s1">&#39;cross&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">antenna_pattern</span> <span class="o">=</span> <span class="s1">&#39;38.901&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">carrier_frequency</span> <span class="o">=</span> <span class="mf">3.5e9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut_array</span> <span class="o">=</span> <span class="n">PanelArray</span><span class="p">(</span><span class="n">num_rows_per_panel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">num_cols_per_panel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">polarization</span> <span class="o">=</span> <span class="s1">&#39;single&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">polarization_type</span> <span class="o">=</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">antenna_pattern</span> <span class="o">=</span> <span class="s1">&#39;omni&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">carrier_frequency</span> <span class="o">=</span> <span class="mf">3.5e9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Instantiating UMa channel model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel_model</span> <span class="o">=</span> <span class="n">UMa</span><span class="p">(</span><span class="n">carrier_frequency</span> <span class="o">=</span> <span class="mf">3.5e9</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">o2i_model</span> <span class="o">=</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">ut_array</span> <span class="o">=</span> <span class="n">ut_array</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">bs_array</span> <span class="o">=</span> <span class="n">bs_array</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;uplink&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Setting up network topology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ut_loc: UTs locations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># bs_loc: BSs locations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ut_orientations: UTs array orientations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># bs_orientations: BSs array orientations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># in_state: Indoor/outdoor states of UTs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel_model</span><span class="o">.</span><span class="n">set_topology</span><span class="p">(</span><span class="n">ut_loc</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">bs_loc</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">ut_orientations</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">bs_orientations</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">ut_velocities</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">in_state</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Instanting the OFDM channel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">OFDMChannel</span><span class="p">(</span><span class="n">channel_model</span> <span class="o">=</span> <span class="n">channel_model</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">resource_grid</span> <span class="o">=</span> <span class="n">rg</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">rg</span></code> is an instance of <a class="reference internal" href="ofdm.html#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>carrier_frequency</strong> (<em>float</em>) – Carrier frequency in Hertz</p></li>
<li><p><strong>o2i_model</strong> (<em>str</em>) – Outdoor-to-indoor loss model for UTs located indoor.
Set this parameter to “low” to use the low-loss model, or to “high”
to use the high-loss model.
See section 7.4.3 of <a class="reference internal" href="#tr38901" id="id17"><span>[TR38901]</span></a> for details.</p></li>
<li><p><strong>rx_array</strong> (<a class="reference internal" href="#sionna.channel.tr38901.PanelArray" title="sionna.channel.tr38901.PanelArray"><em>PanelArray</em></a>) – Panel array used by the receivers. All receivers share the same
antenna array configuration.</p></li>
<li><p><strong>tx_array</strong> (<a class="reference internal" href="#sionna.channel.tr38901.PanelArray" title="sionna.channel.tr38901.PanelArray"><em>PanelArray</em></a>) – Panel array used by the transmitters. All transmitters share the
same antenna array configuration.</p></li>
<li><p><strong>direction</strong> (<em>str</em>) – Link direction. Either “uplink” or “downlink”.</p></li>
<li><p><strong>enable_pathloss</strong> (<em>bool</em>) – If <cite>True</cite>, apply pathloss. Otherwise doesn’t. Defaults to <cite>True</cite>.</p></li>
<li><p><strong>enable_shadow_fading</strong> (<em>bool</em>) – If <cite>True</cite>, apply shadow fading. Otherwise doesn’t.
Defaults to <cite>True</cite>.</p></li>
<li><p><strong>always_generate_lsp</strong> (<em>bool</em>) – If <cite>True</cite>, new large scale parameters (LSPs) are generated for every
new generation of channel impulse responses. Otherwise, always reuse
the same LSPs, except if the topology is changed. Defaults to
<cite>False</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>Complex tf.DType</em>) – Defines the datatype for internal calculations and the output
dtype. Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_time_steps</strong> (<em>int</em>) – Number of time steps</p></li>
<li><p><strong>sampling_frequency</strong> (<em>float</em>) – Sampling frequency [Hz]</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>[batch size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_paths, num_time_steps], tf.complex</em>) – Path coefficients</p></li>
<li><p><strong>tau</strong> (<em>[batch size, num_rx, num_tx, num_paths], tf.float</em>) – Path delays [s]</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sionna.channel.tr38901.UMa.set_topology">
<span class="sig-name descname"><span class="pre">set_topology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ut_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ut_orientations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs_orientations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ut_velocities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">los</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sionna.channel.tr38901.UMa.set_topology" title="Permalink to this definition"></a></dt>
<dd><p>Set the network topology.</p>
<p>It is possible to set up a different network topology for each batch
example. The batch size used when setting up the network topology
is used for the link simulations.</p>
<p>When calling this function, not specifying a parameter leads to the
reuse of the previously given value. Not specifying a value that was not
set at a former call rises an error.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ut_loc</strong> (<em>[batch size,num_ut, 3], tf.float</em>) – Locations of the UTs</p></li>
<li><p><strong>bs_loc</strong> (<em>[batch size,num_bs, 3], tf.float</em>) – Locations of BSs</p></li>
<li><p><strong>ut_orientations</strong> (<em>[batch size,num_ut, 3], tf.float</em>) – Orientations of the UTs arrays [radian]</p></li>
<li><p><strong>bs_orientations</strong> (<em>[batch size,num_bs, 3], tf.float</em>) – Orientations of the BSs arrays [radian]</p></li>
<li><p><strong>ut_velocities</strong> (<em>[batch size,num_ut, 3], tf.float</em>) – Velocity vectors of UTs</p></li>
<li><p><strong>in_state</strong> (<em>[batch size,num_ut], tf.bool</em>) – Indoor/outdoor state of UTs. <cite>True</cite> means indoor and <cite>False</cite>
means outdoor.</p></li>
<li><p><strong>los</strong> (tf.bool or <cite>None</cite>) – If not <cite>None</cite> (default value), all UTs located outdoor are
forced to be in LoS if <code class="docutils literal notranslate"><span class="pre">los</span></code> is set to <cite>True</cite>, or in NLoS
if it is set to <cite>False</cite>. If set to <cite>None</cite>, the LoS/NLoS states
of UTs is set following 3GPP specification <a class="reference internal" href="#tr38901" id="id18"><span>[TR38901]</span></a>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to use this function in Graph mode with XLA, i.e., within
a function that is decorated with <code class="docutils literal notranslate"><span class="pre">&#64;tf.function(jit_compile=True)</span></code>,
you must set <code class="docutils literal notranslate"><span class="pre">sionna.Config.xla_compat=true</span></code>.
See <a class="reference internal" href="config.html#sionna.Config.xla_compat" title="sionna.Config.xla_compat"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xla_compat</span></code></a>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sionna.channel.tr38901.UMa.show_topology">
<span class="sig-name descname"><span class="pre">show_topology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bs_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sionna.channel.tr38901.UMa.show_topology" title="Permalink to this definition"></a></dt>
<dd><p>Shows the network topology of the batch example with index
<code class="docutils literal notranslate"><span class="pre">batch_index</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">bs_index</span></code> parameter specifies with respect to which BS the
LoS/NLoS state of UTs is indicated.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bs_index</strong> (<em>int</em>) – BS index with respect to which the LoS/NLoS state of UTs is
indicated. Defaults to 0.</p></li>
<li><p><strong>batch_index</strong> (<em>int</em>) – Batch example for which the topology is shown. Defaults to 0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="rural-macrocell-rma">
<span id="rma"></span><h3>Rural macrocell (RMa)<a class="headerlink" href="#rural-macrocell-rma" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.tr38901.RMa">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.tr38901.</span></span><span class="sig-name descname"><span class="pre">RMa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">carrier_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ut_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_pathloss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_shadow_fading</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">always_generate_lsp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/tr38901/rma.html#RMa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.tr38901.RMa" title="Permalink to this definition"></a></dt>
<dd><p>Rural macrocell (RMa) channel model from 3GPP <a class="reference internal" href="#tr38901" id="id19"><span>[TR38901]</span></a> specification.</p>
<p>Setting up a RMa model requires configuring the network topology, i.e., the
UTs and BSs locations, UTs velocities, etc. This is achieved using the
<a class="reference internal" href="#sionna.channel.tr38901.RMa.set_topology" title="sionna.channel.tr38901.RMa.set_topology"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_topology()</span></code></a> method. Setting a different
topology for each batch example is possible. The batch size used when setting up the network topology
is used for the link simulations.</p>
<p>The following code snippet shows how to setup an RMa channel model assuming
an OFDM waveform:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># UT and BS panel arrays</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bs_array</span> <span class="o">=</span> <span class="n">PanelArray</span><span class="p">(</span><span class="n">num_rows_per_panel</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">num_cols_per_panel</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">polarization</span> <span class="o">=</span> <span class="s1">&#39;dual&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">polarization_type</span> <span class="o">=</span> <span class="s1">&#39;cross&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">antenna_pattern</span> <span class="o">=</span> <span class="s1">&#39;38.901&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">carrier_frequency</span> <span class="o">=</span> <span class="mf">3.5e9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut_array</span> <span class="o">=</span> <span class="n">PanelArray</span><span class="p">(</span><span class="n">num_rows_per_panel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">num_cols_per_panel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">polarization</span> <span class="o">=</span> <span class="s1">&#39;single&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">polarization_type</span> <span class="o">=</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">antenna_pattern</span> <span class="o">=</span> <span class="s1">&#39;omni&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">carrier_frequency</span> <span class="o">=</span> <span class="mf">3.5e9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Instantiating RMa channel model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel_model</span> <span class="o">=</span> <span class="n">RMa</span><span class="p">(</span><span class="n">carrier_frequency</span> <span class="o">=</span> <span class="mf">3.5e9</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">ut_array</span> <span class="o">=</span> <span class="n">ut_array</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">bs_array</span> <span class="o">=</span> <span class="n">bs_array</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;uplink&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Setting up network topology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ut_loc: UTs locations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># bs_loc: BSs locations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ut_orientations: UTs array orientations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># bs_orientations: BSs array orientations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># in_state: Indoor/outdoor states of UTs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel_model</span><span class="o">.</span><span class="n">set_topology</span><span class="p">(</span><span class="n">ut_loc</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">bs_loc</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">ut_orientations</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">bs_orientations</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">ut_velocities</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">in_state</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Instanting the OFDM channel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">OFDMChannel</span><span class="p">(</span><span class="n">channel_model</span> <span class="o">=</span> <span class="n">channel_model</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">resource_grid</span> <span class="o">=</span> <span class="n">rg</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">rg</span></code> is an instance of <a class="reference internal" href="ofdm.html#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>carrier_frequency</strong> (<em>float</em>) – Carrier frequency [Hz]</p></li>
<li><p><strong>rx_array</strong> (<a class="reference internal" href="#sionna.channel.tr38901.PanelArray" title="sionna.channel.tr38901.PanelArray"><em>PanelArray</em></a>) – Panel array used by the receivers. All receivers share the same
antenna array configuration.</p></li>
<li><p><strong>tx_array</strong> (<a class="reference internal" href="#sionna.channel.tr38901.PanelArray" title="sionna.channel.tr38901.PanelArray"><em>PanelArray</em></a>) – Panel array used by the transmitters. All transmitters share the
same antenna array configuration.</p></li>
<li><p><strong>direction</strong> (<em>str</em>) – Link direction. Either “uplink” or “downlink”.</p></li>
<li><p><strong>enable_pathloss</strong> (<em>bool</em>) – If <cite>True</cite>, apply pathloss. Otherwise doesn’t. Defaults to <cite>True</cite>.</p></li>
<li><p><strong>enable_shadow_fading</strong> (<em>bool</em>) – If <cite>True</cite>, apply shadow fading. Otherwise doesn’t.
Defaults to <cite>True</cite>.</p></li>
<li><p><strong>average_street_width</strong> (<em>float</em>) – Average street width [m]. Defaults to 5m.</p></li>
<li><p><strong>average_street_width</strong> – Average building height [m]. Defaults to 20m.</p></li>
<li><p><strong>always_generate_lsp</strong> (<em>bool</em>) – If <cite>True</cite>, new large scale parameters (LSPs) are generated for every
new generation of channel impulse responses. Otherwise, always reuse
the same LSPs, except if the topology is changed. Defaults to
<cite>False</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>Complex tf.DType</em>) – Defines the datatype for internal calculations and the output
dtype. Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_time_steps</strong> (<em>int</em>) – Number of time steps</p></li>
<li><p><strong>sampling_frequency</strong> (<em>float</em>) – Sampling frequency [Hz]</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>[batch size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_paths, num_time_steps], tf.complex</em>) – Path coefficients</p></li>
<li><p><strong>tau</strong> (<em>[batch size, num_rx, num_tx, num_paths], tf.float</em>) – Path delays [s]</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sionna.channel.tr38901.RMa.set_topology">
<span class="sig-name descname"><span class="pre">set_topology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ut_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ut_orientations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs_orientations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ut_velocities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">los</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sionna.channel.tr38901.RMa.set_topology" title="Permalink to this definition"></a></dt>
<dd><p>Set the network topology.</p>
<p>It is possible to set up a different network topology for each batch
example. The batch size used when setting up the network topology
is used for the link simulations.</p>
<p>When calling this function, not specifying a parameter leads to the
reuse of the previously given value. Not specifying a value that was not
set at a former call rises an error.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ut_loc</strong> (<em>[batch size,num_ut, 3], tf.float</em>) – Locations of the UTs</p></li>
<li><p><strong>bs_loc</strong> (<em>[batch size,num_bs, 3], tf.float</em>) – Locations of BSs</p></li>
<li><p><strong>ut_orientations</strong> (<em>[batch size,num_ut, 3], tf.float</em>) – Orientations of the UTs arrays [radian]</p></li>
<li><p><strong>bs_orientations</strong> (<em>[batch size,num_bs, 3], tf.float</em>) – Orientations of the BSs arrays [radian]</p></li>
<li><p><strong>ut_velocities</strong> (<em>[batch size,num_ut, 3], tf.float</em>) – Velocity vectors of UTs</p></li>
<li><p><strong>in_state</strong> (<em>[batch size,num_ut], tf.bool</em>) – Indoor/outdoor state of UTs. <cite>True</cite> means indoor and <cite>False</cite>
means outdoor.</p></li>
<li><p><strong>los</strong> (tf.bool or <cite>None</cite>) – If not <cite>None</cite> (default value), all UTs located outdoor are
forced to be in LoS if <code class="docutils literal notranslate"><span class="pre">los</span></code> is set to <cite>True</cite>, or in NLoS
if it is set to <cite>False</cite>. If set to <cite>None</cite>, the LoS/NLoS states
of UTs is set following 3GPP specification <a class="reference internal" href="#tr38901" id="id20"><span>[TR38901]</span></a>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to use this function in Graph mode with XLA, i.e., within
a function that is decorated with <code class="docutils literal notranslate"><span class="pre">&#64;tf.function(jit_compile=True)</span></code>,
you must set <code class="docutils literal notranslate"><span class="pre">sionna.Config.xla_compat=true</span></code>.
See <a class="reference internal" href="config.html#sionna.Config.xla_compat" title="sionna.Config.xla_compat"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xla_compat</span></code></a>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sionna.channel.tr38901.RMa.show_topology">
<span class="sig-name descname"><span class="pre">show_topology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bs_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sionna.channel.tr38901.RMa.show_topology" title="Permalink to this definition"></a></dt>
<dd><p>Shows the network topology of the batch example with index
<code class="docutils literal notranslate"><span class="pre">batch_index</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">bs_index</span></code> parameter specifies with respect to which BS the
LoS/NLoS state of UTs is indicated.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bs_index</strong> (<em>int</em>) – BS index with respect to which the LoS/NLoS state of UTs is
indicated. Defaults to 0.</p></li>
<li><p><strong>batch_index</strong> (<em>int</em>) – Batch example for which the topology is shown. Defaults to 0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="external-datasets">
<span id="id21"></span><h2>External datasets<a class="headerlink" href="#external-datasets" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.channel.CIRDataset">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">CIRDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cir_generator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rx_ant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_tx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_tx_ant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/cir_dataset.html#CIRDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.CIRDataset" title="Permalink to this definition"></a></dt>
<dd><p>Creates a channel model from a dataset that can be used with classes such as
<a class="reference internal" href="#sionna.channel.TimeChannel" title="sionna.channel.TimeChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeChannel</span></code></a> and <a class="reference internal" href="#sionna.channel.OFDMChannel" title="sionna.channel.OFDMChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">OFDMChannel</span></code></a>.
The dataset is defined by a <a class="reference external" href="https://wiki.python.org/moin/Generators">generator</a>.</p>
<p>The batch size is configured when instantiating the dataset or through the <a class="reference internal" href="#sionna.channel.CIRDataset.batch_size" title="sionna.channel.CIRDataset.batch_size"><code class="xref py py-attr docutils literal notranslate"><span class="pre">batch_size</span></code></a> property.
The number of time steps (<cite>num_time_steps</cite>) and sampling frequency (<cite>sampling_frequency</cite>) can only be set when instantiating the dataset.
The specified values must be in accordance with the data.</p>
<p class="rubric">Example</p>
<p>The following code snippet shows how to use this class as a channel model.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_generator</span> <span class="o">=</span> <span class="n">MyGenerator</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel_model</span> <span class="o">=</span> <span class="n">sionna</span><span class="o">.</span><span class="n">channel</span><span class="o">.</span><span class="n">CIRDataset</span><span class="p">(</span><span class="n">my_generator</span><span class="p">,</span>
<span class="gp">... </span>                                          <span class="n">batch_size</span><span class="p">,</span>
<span class="gp">... </span>                                          <span class="n">num_rx</span><span class="p">,</span>
<span class="gp">... </span>                                          <span class="n">num_rx_ant</span><span class="p">,</span>
<span class="gp">... </span>                                          <span class="n">num_tx</span><span class="p">,</span>
<span class="gp">... </span>                                          <span class="n">num_tx_ant</span><span class="p">,</span>
<span class="gp">... </span>                                          <span class="n">num_paths</span><span class="p">,</span>
<span class="gp">... </span>                                          <span class="n">num_time_steps</span><span class="o">+</span><span class="n">l_tot</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">sionna</span><span class="o">.</span><span class="n">channel</span><span class="o">.</span><span class="n">TimeChannel</span><span class="p">(</span><span class="n">channel_model</span><span class="p">,</span> <span class="n">bandwidth</span><span class="p">,</span> <span class="n">num_time_steps</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">MyGenerator</span></code> is a generator</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyGenerator</span><span class="p">:</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="o">...</span>
<span class="gp">... </span>        <span class="k">yield</span> <span class="n">a</span><span class="p">,</span> <span class="n">tau</span>
</pre></div>
</div>
<p>that returns complex-valued path coefficients <code class="docutils literal notranslate"><span class="pre">a</span></code> with shape <cite>[batch size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_paths, num_time_steps]</cite>
and real-valued path delays <code class="docutils literal notranslate"><span class="pre">tau</span></code> (in second) <cite>[batch size, num_rx, num_tx, num_paths]</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cir_generator</strong> – Generator that returns channel impulse responses <code class="docutils literal notranslate"><span class="pre">(a,</span> <span class="pre">tau)</span></code> where <code class="docutils literal notranslate"><span class="pre">a</span></code> is the tensor of channel coefficients of shape
<cite>[batch size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_paths, num_time_steps]</cite> and dtype <code class="docutils literal notranslate"><span class="pre">dtype</span></code>, and <code class="docutils literal notranslate"><span class="pre">tau</span></code> the tensor of path delays
of shape  <cite>[batch size, num_rx, num_tx, num_paths]</cite> and dtype <code class="docutils literal notranslate"><span class="pre">dtype.real_dtype</span></code>.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size</p></li>
<li><p><strong>num_rx</strong> (<em>int</em>) – Number of receivers (<span class="math notranslate nohighlight">\(N_R\)</span>)</p></li>
<li><p><strong>num_rx_ant</strong> (<em>int</em>) – Number of antennas per receiver (<span class="math notranslate nohighlight">\(N_{RA}\)</span>)</p></li>
<li><p><strong>num_tx</strong> (<em>int</em>) – Number of transmitters (<span class="math notranslate nohighlight">\(N_T\)</span>)</p></li>
<li><p><strong>num_tx_ant</strong> (<em>int</em>) – Number of antennas per transmitter (<span class="math notranslate nohighlight">\(N_{TA}\)</span>)</p></li>
<li><p><strong>num_paths</strong> (<em>int</em>) – Number of paths (<span class="math notranslate nohighlight">\(M\)</span>)</p></li>
<li><p><strong>num_time_steps</strong> (<em>int</em>) – Number of time steps</p></li>
<li><p><strong>dtype</strong> (<em>tf.DType</em>) – Complex datatype to use for internal processing and output.
Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>a</strong> (<em>[batch size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_paths, num_time_steps], tf.complex</em>) – Path coefficients</p></li>
<li><p><strong>tau</strong> (<em>[batch size, num_rx, num_tx, num_paths], tf.float</em>) – Path delays [s]</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="sionna.channel.CIRDataset.batch_size">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">batch_size</span></span><a class="headerlink" href="#sionna.channel.CIRDataset.batch_size" title="Permalink to this definition"></a></dt>
<dd><p>Batch size</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="utility-functions">
<span id="id23"></span><h2>Utility functions<a class="headerlink" href="#utility-functions" title="Permalink to this headline"></a></h2>
<div class="section" id="subcarrier-frequencies">
<h3>subcarrier_frequencies<a class="headerlink" href="#subcarrier-frequencies" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="sionna.channel.subcarrier_frequencies">
<span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">subcarrier_frequencies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_subcarriers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subcarrier_spacing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/utils.html#subcarrier_frequencies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.subcarrier_frequencies" title="Permalink to this definition"></a></dt>
<dd><p>Compute the baseband frequencies of <code class="docutils literal notranslate"><span class="pre">num_subcarrier</span></code> subcarriers spaced by
<code class="docutils literal notranslate"><span class="pre">subcarrier_spacing</span></code>, i.e.,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># If num_subcarrier is even:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frequencies</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">num_subcarrier</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">num_subcarrier</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">subcarrier_spacing</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># If num_subcarrier is odd:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frequencies</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">num_subcarrier</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="p">(</span><span class="n">num_subcarrier</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">subcarrier_spacing</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_subcarriers</strong> (<em>int</em>) – Number of subcarriers</p></li>
<li><p><strong>subcarrier_spacing</strong> (<em>float</em>) – Subcarrier spacing [Hz]</p></li>
<li><p><strong>dtype</strong> (<em>tf.DType</em>) – Datatype to use for internal processing and output.
If a complex datatype is provided, the corresponding precision of
real components is used.
Defaults to <cite>tf.complex64</cite> (<cite>tf.float32</cite>).</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p><strong>frequencies</strong> (<em>[num_subcarrier], tf.float</em>) – Baseband frequencies of subcarriers</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="time-lag-discrete-time-channel">
<h3>time_lag_discrete_time_channel<a class="headerlink" href="#time-lag-discrete-time-channel" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="sionna.channel.time_lag_discrete_time_channel">
<span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">time_lag_discrete_time_channel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bandwidth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximum_delay_spread</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/utils.html#time_lag_discrete_time_channel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.time_lag_discrete_time_channel" title="Permalink to this definition"></a></dt>
<dd><p>Compute the smallest and largest time-lag for the descrete complex baseband
channel, i.e., <span class="math notranslate nohighlight">\(L_{\text{min}}\)</span> and <span class="math notranslate nohighlight">\(L_{\text{max}}\)</span>.</p>
<p>The smallest time-lag (<span class="math notranslate nohighlight">\(L_{\text{min}}\)</span>) returned is always -6, as this value
was found small enough for all models included in Sionna.</p>
<p>The largest time-lag (<span class="math notranslate nohighlight">\(L_{\text{max}}\)</span>) is computed from the <code class="docutils literal notranslate"><span class="pre">bandwidth</span></code>
and <code class="docutils literal notranslate"><span class="pre">maximum_delay_spread</span></code> as follows:</p>
<div class="math notranslate nohighlight">
\[L_{\text{max}} = \lceil W \tau_{\text{max}} \rceil + 6\]</div>
<p>where <span class="math notranslate nohighlight">\(L_{\text{max}}\)</span> is the largest time-lag, <span class="math notranslate nohighlight">\(W\)</span> the <code class="docutils literal notranslate"><span class="pre">bandwidth</span></code>,
and <span class="math notranslate nohighlight">\(\tau_{\text{max}}\)</span> the <code class="docutils literal notranslate"><span class="pre">maximum_delay_spread</span></code>.</p>
<p>The default value for the <code class="docutils literal notranslate"><span class="pre">maximum_delay_spread</span></code> is 3us, which was found
to be large enough to include most significant paths with all channel models
included in Sionna assuming a nominal delay spread of 100ns.</p>
<p><em>Warining:</em> The values of <span class="math notranslate nohighlight">\(L_{\text{min}}\)</span> and <span class="math notranslate nohighlight">\(L_{\text{max}}\)</span> computed
by this function are only recommended values.
<span class="math notranslate nohighlight">\(L_{\text{min}}\)</span> and <span class="math notranslate nohighlight">\(L_{\text{max}}\)</span> should be set according to
the considered channel model.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bandwidth</strong> (<em>float</em>) – Bandwith (<span class="math notranslate nohighlight">\(W\)</span>) [Hz]</p></li>
<li><p><strong>maximum_delay_spread</strong> (<em>float</em>) – Maximum delay spread [s]. Defaults to 3us.</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>l_min</strong> (<em>int</em>) – Smallest time-lag (<span class="math notranslate nohighlight">\(L_{\text{min}}\)</span>) for the descrete complex baseband
channel. Set to -6, , as this value was found small enough for all models
included in Sionna.</p></li>
<li><p><strong>l_max</strong> (<em>int</em>) – Largest time-lag (<span class="math notranslate nohighlight">\(L_{\text{max}}\)</span>) for the descrete complex baseband
channel</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="deg-2-rad">
<h3>deg_2_rad<a class="headerlink" href="#deg-2-rad" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="sionna.channel.deg_2_rad">
<span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">deg_2_rad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/utils.html#deg_2_rad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.deg_2_rad" title="Permalink to this definition"></a></dt>
<dd><p>Convert degree to radian</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Angles in degree</p>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p><strong>y</strong> (<em>Tensor</em>) – Angles <code class="docutils literal notranslate"><span class="pre">x</span></code> converted to radian</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="rad-2-deg">
<h3>rad_2_deg<a class="headerlink" href="#rad-2-deg" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="sionna.channel.rad_2_deg">
<span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">rad_2_deg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/utils.html#rad_2_deg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.rad_2_deg" title="Permalink to this definition"></a></dt>
<dd><p>Convert radian to degree</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Angles in radian</p>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p><strong>y</strong> (<em>Tensor</em>) – Angles <code class="docutils literal notranslate"><span class="pre">x</span></code> converted to degree</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="wrap-angle-0-360">
<h3>wrap_angle_0_360<a class="headerlink" href="#wrap-angle-0-360" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="sionna.channel.wrap_angle_0_360">
<span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">wrap_angle_0_360</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/utils.html#wrap_angle_0_360"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.wrap_angle_0_360" title="Permalink to this definition"></a></dt>
<dd><p>Wrap <code class="docutils literal notranslate"><span class="pre">angle</span></code> to (0,360)</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><p><strong>angle</strong> (<em>Tensor</em>) – Input to wrap</p>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p><strong>y</strong> (<em>Tensor</em>) – <code class="docutils literal notranslate"><span class="pre">angle</span></code> wrapped to (0,360)</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="drop-uts-in-sector">
<h3>drop_uts_in_sector<a class="headerlink" href="#drop-uts-in-sector" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="sionna.channel.drop_uts_in_sector">
<span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">drop_uts_in_sector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bs_ut_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/utils.html#drop_uts_in_sector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.drop_uts_in_sector" title="Permalink to this definition"></a></dt>
<dd><p>Uniformly sample UT locations from a sector.</p>
<p>The sector from which UTs are sampled is shown in the following figure.
The BS is assumed to be located at the origin (0,0) of the coordinate
system.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/drop_uts_in_sector.png"><img alt="../_images/drop_uts_in_sector.png" src="../_images/drop_uts_in_sector.png" style="width: 307.5px; height: 216.9px;" /></a>
</div>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size</p></li>
<li><p><strong>num_ut</strong> (<em>int</em>) – Number of UTs to sample per batch example</p></li>
<li><p><strong>min_bs_ut_dist</strong> (<em>tf.float</em>) – Minimum BS-UT distance [m]</p></li>
<li><p><strong>isd</strong> (<em>tf.float</em>) – Inter-site distance, i.e., the distance between two adjacent BSs [m]</p></li>
<li><p><strong>dtype</strong> (<em>tf.DType</em>) – Datatype to use for internal processing and output.
If a complex datatype is provided, the corresponding precision of
real components is used.
Defaults to <cite>tf.complex64</cite> (<cite>tf.float32</cite>).</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p><strong>ut_loc</strong> (<em>[batch_size, num_ut, 2], tf.float</em>) – UTs locations in the X-Y plan</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="relocate-uts">
<h3>relocate_uts<a class="headerlink" href="#relocate-uts" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="sionna.channel.relocate_uts">
<span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">relocate_uts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ut_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sector_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_loc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/utils.html#relocate_uts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.relocate_uts" title="Permalink to this definition"></a></dt>
<dd><p>Relocate the UTs by rotating them into the sector with index <code class="docutils literal notranslate"><span class="pre">sector_id</span></code>
and transposing them to the cell centered on <code class="docutils literal notranslate"><span class="pre">cell_loc</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">sector_id</span></code> gives the index of the sector to which the UTs are
rotated to. The picture below shows how the three sectors of a cell are
indexed.</p>
<div class="figure align-center" id="id31">
<a class="reference internal image-reference" href="../_images/panel_array_sector_id.png"><img alt="../_images/panel_array_sector_id.png" src="../_images/panel_array_sector_id.png" style="width: 188.1px; height: 162.9px;" /></a>
<p class="caption"><span class="caption-text">Indexing of sectors</span><a class="headerlink" href="#id31" title="Permalink to this image"></a></p>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">sector_id</span></code> is a scalar, then all UTs are relocated to the same
sector indexed by <code class="docutils literal notranslate"><span class="pre">sector_id</span></code>.
If <code class="docutils literal notranslate"><span class="pre">sector_id</span></code> is a tensor, it should be broadcastable with
[<code class="docutils literal notranslate"><span class="pre">batch_size</span></code>, <code class="docutils literal notranslate"><span class="pre">num_ut</span></code>], and give the sector in which each UT or
batch example is relocated to.</p>
<p>When calling the function, <code class="docutils literal notranslate"><span class="pre">ut_loc</span></code> gives the locations of the UTs to
relocate, which are all assumed to be in sector with index 0, and in the
cell centered on the origin (0,0).</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ut_loc</strong> (<em>[batch_size, num_ut, 2], tf.float</em>) – UTs locations in the X-Y plan</p></li>
<li><p><strong>sector_id</strong> (<em>Tensor broadcastable with [batch_size, num_ut], int</em>) – Indexes of the sector to which to relocate the UTs</p></li>
<li><p><strong>cell_loc</strong> (<em>Tensor broadcastable with [batch_size, num_ut], tf.float</em>) – Center of the cell to which to transpose the UTs</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p><strong>ut_loc</strong> (<em>[batch_size, num_ut, 2], tf.float</em>) – Relocated UTs locations in the X-Y plan</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="set-3gpp-scenario-parameters">
<h3>set_3gpp_scenario_parameters<a class="headerlink" href="#set-3gpp-scenario-parameters" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="sionna.channel.set_3gpp_scenario_parameters">
<span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">set_3gpp_scenario_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scenario</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bs_ut_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_ut_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_ut_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indoor_probability</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_ut_velocity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_ut_velocity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/utils.html#set_3gpp_scenario_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.set_3gpp_scenario_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Set valid parameters for a specified 3GPP system level <code class="docutils literal notranslate"><span class="pre">scenario</span></code>
(RMa, UMi, or UMa).</p>
<p>If a parameter is given, then it is returned. If it is set to <cite>None</cite>,
then a parameter valid according to the chosen scenario is returned
(see <a class="reference internal" href="#tr38901" id="id24"><span>[TR38901]</span></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scenario</strong> (<em>str</em>) – System level model scenario. Must be one of “rma”, “umi”, or “uma”.</p></li>
<li><p><strong>min_bs_ut_dist</strong> (<em>None or tf.float</em>) – Minimum BS-UT distance [m]</p></li>
<li><p><strong>isd</strong> (<em>None or tf.float</em>) – Inter-site distance [m]</p></li>
<li><p><strong>bs_height</strong> (<em>None or tf.float</em>) – BS elevation [m]</p></li>
<li><p><strong>min_ut_height</strong> (<em>None or tf.float</em>) – Minimum UT elevation [m]</p></li>
<li><p><strong>max_ut_height</strong> (<em>None or tf.float</em>) – Maximum UT elevation [m]</p></li>
<li><p><strong>indoor_probability</strong> (<em>None or tf.float</em>) – Probability of a UT to be indoor</p></li>
<li><p><strong>min_ut_velocity</strong> (<em>None or tf.float</em>) – Minimum UT velocity [m/s]</p></li>
<li><p><strong>max_ut_velocity</strong> (<em>None or tf.float</em>) – Maximim UT velocity [m/s]</p></li>
<li><p><strong>dtype</strong> (<em>tf.DType</em>) – Datatype to use for internal processing and output.
If a complex datatype is provided, the corresponding precision of
real components is used.
Defaults to <cite>tf.complex64</cite> (<cite>tf.float32</cite>).</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>min_bs_ut_dist</strong> (<em>tf.float</em>) – Minimum BS-UT distance [m]</p></li>
<li><p><strong>isd</strong> (<em>tf.float</em>) – Inter-site distance [m]</p></li>
<li><p><strong>bs_height</strong> (<em>tf.float</em>) – BS elevation [m]</p></li>
<li><p><strong>min_ut_height</strong> (<em>tf.float</em>) – Minimum UT elevation [m]</p></li>
<li><p><strong>max_ut_height</strong> (<em>tf.float</em>) – Maximum UT elevation [m]</p></li>
<li><p><strong>indoor_probability</strong> (<em>tf.float</em>) – Probability of a UT to be indoor</p></li>
<li><p><strong>min_ut_velocity</strong> (<em>tf.float</em>) – Minimum UT velocity [m/s]</p></li>
<li><p><strong>max_ut_velocity</strong> (<em>tf.float</em>) – Maximim UT velocity [m/s]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="gen-single-sector-topology">
<h3>gen_single_sector_topology<a class="headerlink" href="#gen-single-sector-topology" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="sionna.channel.gen_single_sector_topology">
<span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">gen_single_sector_topology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scenario</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bs_ut_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_ut_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_ut_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indoor_probability</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_ut_velocity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_ut_velocity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/utils.html#gen_single_sector_topology"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.gen_single_sector_topology" title="Permalink to this definition"></a></dt>
<dd><p>Generate a batch of topologies consisting of a single BS located at the
origin and <code class="docutils literal notranslate"><span class="pre">num_ut</span></code> UTs randomly and uniformly dropped in a cell sector.</p>
<p>The following picture shows the sector from which UTs are sampled.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/drop_uts_in_sector.png"><img alt="../_images/drop_uts_in_sector.png" src="../_images/drop_uts_in_sector.png" style="width: 307.5px; height: 216.9px;" /></a>
</div>
<p>UTs orientations are randomly and uniformly set, whereas the BS orientation
is set such that the it is oriented towards the center of the sector.</p>
<p>The drop configuration can be controlled through the optional parameters.
Parameters set to <cite>None</cite> are set to valid values according to the chosen
<code class="docutils literal notranslate"><span class="pre">scenario</span></code> (see <a class="reference internal" href="#tr38901" id="id25"><span>[TR38901]</span></a>).</p>
<p>The returned batch of topologies can be used as-is with the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">set_topology()</span></code> method of the system level models, i.e.
<a class="reference internal" href="#sionna.channel.tr38901.UMi" title="sionna.channel.tr38901.UMi"><code class="xref py py-class docutils literal notranslate"><span class="pre">UMi</span></code></a>, <a class="reference internal" href="#sionna.channel.tr38901.UMa" title="sionna.channel.tr38901.UMa"><code class="xref py py-class docutils literal notranslate"><span class="pre">UMa</span></code></a>,
and <a class="reference internal" href="#sionna.channel.tr38901.RMa" title="sionna.channel.tr38901.RMa"><code class="xref py py-class docutils literal notranslate"><span class="pre">RMa</span></code></a>.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create antenna arrays</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bs_array</span> <span class="o">=</span> <span class="n">PanelArray</span><span class="p">(</span><span class="n">num_rows_per_panel</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">num_cols_per_panel</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">polarization</span> <span class="o">=</span> <span class="s1">&#39;dual&#39;</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">polarization_type</span> <span class="o">=</span> <span class="s1">&#39;VH&#39;</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">antenna_pattern</span> <span class="o">=</span> <span class="s1">&#39;38.901&#39;</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">carrier_frequency</span> <span class="o">=</span> <span class="mf">3.5e9</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut_array</span> <span class="o">=</span> <span class="n">PanelArray</span><span class="p">(</span><span class="n">num_rows_per_panel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">num_cols_per_panel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">polarization</span> <span class="o">=</span> <span class="s1">&#39;single&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">polarization_type</span> <span class="o">=</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">antenna_pattern</span> <span class="o">=</span> <span class="s1">&#39;omni&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">carrier_frequency</span> <span class="o">=</span> <span class="mf">3.5e9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create channel model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel_model</span> <span class="o">=</span> <span class="n">UMi</span><span class="p">(</span><span class="n">carrier_frequency</span> <span class="o">=</span> <span class="mf">3.5e9</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">o2i_model</span> <span class="o">=</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">ut_array</span> <span class="o">=</span> <span class="n">ut_array</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">bs_array</span> <span class="o">=</span> <span class="n">bs_array</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;uplink&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate the topology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topology</span> <span class="o">=</span> <span class="n">gen_single_sector_topology</span><span class="p">(</span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
<span class="gp">... </span>                                      <span class="n">num_ut</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                                      <span class="n">scenario</span> <span class="o">=</span> <span class="s1">&#39;umi&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set the topology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut_loc</span><span class="p">,</span> <span class="n">bs_loc</span><span class="p">,</span> <span class="n">ut_orientations</span><span class="p">,</span> <span class="n">bs_orientations</span><span class="p">,</span> <span class="n">ut_velocities</span><span class="p">,</span> <span class="n">in_state</span> <span class="o">=</span> <span class="n">topology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel_model</span><span class="o">.</span><span class="n">set_topology</span><span class="p">(</span><span class="n">ut_loc</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">bs_loc</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">ut_orientations</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">bs_orientations</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">ut_velocities</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">in_state</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel_model</span><span class="o">.</span><span class="n">show_topology</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/drop_uts_in_sector_topology.png" src="../_images/drop_uts_in_sector_topology.png" />
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size</p></li>
<li><p><strong>num_ut</strong> (<em>int</em>) – Number of UTs to sample per batch example</p></li>
<li><p><strong>scenario</strong> (<em>str</em>) – System leven model scenario. Must be one of “rma”, “umi”, or “uma”.</p></li>
<li><p><strong>min_bs_ut_dist</strong> (<em>None or tf.float</em>) – Minimum BS-UT distance [m]</p></li>
<li><p><strong>isd</strong> (<em>None or tf.float</em>) – Inter-site distance [m]</p></li>
<li><p><strong>bs_height</strong> (<em>None or tf.float</em>) – BS elevation [m]</p></li>
<li><p><strong>min_ut_height</strong> (<em>None or tf.float</em>) – Minimum UT elevation [m]</p></li>
<li><p><strong>max_ut_height</strong> (<em>None or tf.float</em>) – Maximum UT elevation [m]</p></li>
<li><p><strong>indoor_probability</strong> (<em>None or tf.float</em>) – Probability of a UT to be indoor</p></li>
<li><p><strong>min_ut_velocity</strong> (<em>None or tf.float</em>) – Minimum UT velocity [m/s]</p></li>
<li><p><strong>max_ut_velocity</strong> (<em>None or tf.float</em>) – Maximim UT velocity [m/s]</p></li>
<li><p><strong>dtype</strong> (<em>tf.DType</em>) – Datatype to use for internal processing and output.
If a complex datatype is provided, the corresponding precision of
real components is used.
Defaults to <cite>tf.complex64</cite> (<cite>tf.float32</cite>).</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ut_loc</strong> (<em>[batch_size, num_ut, 3], tf.float</em>) – UTs locations</p></li>
<li><p><strong>bs_loc</strong> (<em>[batch_size, 1, 3], tf.float</em>) – BS location. Set to (0,0,0) for all batch examples.</p></li>
<li><p><strong>ut_orientations</strong> (<em>[batch_size, num_ut, 3], tf.float</em>) – UTs orientations [radian]</p></li>
<li><p><strong>bs_orientations</strong> (<em>[batch_size, 1, 3], tf.float</em>) – BS orientations [radian]. Oriented towards the center of the sector.</p></li>
<li><p><strong>ut_velocities</strong> (<em>[batch_size, num_ut, 3], tf.float</em>) – UTs velocities [m/s]</p></li>
<li><p><strong>in_state</strong> (<em>[batch_size, num_ut], tf.float</em>) – Indoor/outdoor state of UTs. <cite>True</cite> means indoor, <cite>False</cite> means
outdoor.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="gen-single-sector-topology-interferers">
<h3>gen_single_sector_topology_interferers<a class="headerlink" href="#gen-single-sector-topology-interferers" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="sionna.channel.gen_single_sector_topology_interferers">
<span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">gen_single_sector_topology_interferers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_interferer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scenario</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bs_ut_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_ut_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_ut_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indoor_probability</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_ut_velocity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_ut_velocity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/utils.html#gen_single_sector_topology_interferers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.gen_single_sector_topology_interferers" title="Permalink to this definition"></a></dt>
<dd><p>Generate a batch of topologies consisting of a single BS located at the
origin, <code class="docutils literal notranslate"><span class="pre">num_ut</span></code> UTs randomly and uniformly dropped in a cell sector, and
<code class="docutils literal notranslate"><span class="pre">num_interferer</span></code> interfering UTs randomly dropped in the adjacent cells.</p>
<p>The following picture shows how UTs are sampled</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/drop_uts_in_sector_interferers.png"><img alt="../_images/drop_uts_in_sector_interferers.png" src="../_images/drop_uts_in_sector_interferers.png" style="width: 383.4px; height: 383.09999999999997px;" /></a>
</div>
<p>UTs orientations are randomly and uniformly set, whereas the BS orientation
is set such that it is oriented towards the center of the sector it
serves.</p>
<p>The drop configuration can be controlled through the optional parameters.
Parameters set to <cite>None</cite> are set to valid values according to the chosen
<code class="docutils literal notranslate"><span class="pre">scenario</span></code> (see <a class="reference internal" href="#tr38901" id="id26"><span>[TR38901]</span></a>).</p>
<p>The returned batch of topologies can be used as-is with the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">set_topology()</span></code> method of the system level models, i.e.
<a class="reference internal" href="#sionna.channel.tr38901.UMi" title="sionna.channel.tr38901.UMi"><code class="xref py py-class docutils literal notranslate"><span class="pre">UMi</span></code></a>, <a class="reference internal" href="#sionna.channel.tr38901.UMa" title="sionna.channel.tr38901.UMa"><code class="xref py py-class docutils literal notranslate"><span class="pre">UMa</span></code></a>,
and <a class="reference internal" href="#sionna.channel.tr38901.RMa" title="sionna.channel.tr38901.RMa"><code class="xref py py-class docutils literal notranslate"><span class="pre">RMa</span></code></a>.</p>
<p>In the returned <code class="docutils literal notranslate"><span class="pre">ut_loc</span></code>, <code class="docutils literal notranslate"><span class="pre">ut_orientations</span></code>, <code class="docutils literal notranslate"><span class="pre">ut_velocities</span></code>, and
<code class="docutils literal notranslate"><span class="pre">in_state</span></code> tensors, the first <code class="docutils literal notranslate"><span class="pre">num_ut</span></code> items along the axis with index
1 correspond to the served UTs, whereas the remaining <code class="docutils literal notranslate"><span class="pre">num_interferer</span></code>
items correspond to the interfering UTs.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create antenna arrays</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bs_array</span> <span class="o">=</span> <span class="n">PanelArray</span><span class="p">(</span><span class="n">num_rows_per_panel</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">num_cols_per_panel</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">polarization</span> <span class="o">=</span> <span class="s1">&#39;dual&#39;</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">polarization_type</span> <span class="o">=</span> <span class="s1">&#39;VH&#39;</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">antenna_pattern</span> <span class="o">=</span> <span class="s1">&#39;38.901&#39;</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">carrier_frequency</span> <span class="o">=</span> <span class="mf">3.5e9</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut_array</span> <span class="o">=</span> <span class="n">PanelArray</span><span class="p">(</span><span class="n">num_rows_per_panel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">num_cols_per_panel</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">polarization</span> <span class="o">=</span> <span class="s1">&#39;single&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">polarization_type</span> <span class="o">=</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">antenna_pattern</span> <span class="o">=</span> <span class="s1">&#39;omni&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">carrier_frequency</span> <span class="o">=</span> <span class="mf">3.5e9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create channel model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel_model</span> <span class="o">=</span> <span class="n">UMi</span><span class="p">(</span><span class="n">carrier_frequency</span> <span class="o">=</span> <span class="mf">3.5e9</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">o2i_model</span> <span class="o">=</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">ut_array</span> <span class="o">=</span> <span class="n">ut_array</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">bs_array</span> <span class="o">=</span> <span class="n">bs_array</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;uplink&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate the topology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topology</span> <span class="o">=</span> <span class="n">gen_single_sector_topology_interferers</span><span class="p">(</span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
<span class="gp">... </span>                                                  <span class="n">num_ut</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                                                  <span class="n">num_interferer</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                                                  <span class="n">scenario</span> <span class="o">=</span> <span class="s1">&#39;umi&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set the topology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut_loc</span><span class="p">,</span> <span class="n">bs_loc</span><span class="p">,</span> <span class="n">ut_orientations</span><span class="p">,</span> <span class="n">bs_orientations</span><span class="p">,</span> <span class="n">ut_velocities</span><span class="p">,</span> <span class="n">in_state</span> <span class="o">=</span> <span class="n">topology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel_model</span><span class="o">.</span><span class="n">set_topology</span><span class="p">(</span><span class="n">ut_loc</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">bs_loc</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">ut_orientations</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">bs_orientations</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">ut_velocities</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">in_state</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel_model</span><span class="o">.</span><span class="n">show_topology</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/drop_uts_in_sector_topology_inter.png" src="../_images/drop_uts_in_sector_topology_inter.png" />
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size</p></li>
<li><p><strong>num_ut</strong> (<em>int</em>) – Number of UTs to sample per batch example</p></li>
<li><p><strong>num_interferer</strong> (<em>int</em>) – Number of interfeering UTs per batch example</p></li>
<li><p><strong>scenario</strong> (<em>str</em>) – System leven model scenario. Must be one of “rma”, “umi”, or “uma”.</p></li>
<li><p><strong>min_bs_ut_dist</strong> (<em>None or tf.float</em>) – Minimum BS-UT distance [m]</p></li>
<li><p><strong>isd</strong> (<em>None or tf.float</em>) – Inter-site distance [m]</p></li>
<li><p><strong>bs_height</strong> (<em>None or tf.float</em>) – BS elevation [m]</p></li>
<li><p><strong>min_ut_height</strong> (<em>None or tf.float</em>) – Minimum UT elevation [m]</p></li>
<li><p><strong>max_ut_height</strong> (<em>None or tf.float</em>) – Maximum UT elevation [m]</p></li>
<li><p><strong>indoor_probability</strong> (<em>None or tf.float</em>) – Probability of a UT to be indoor</p></li>
<li><p><strong>min_ut_velocity</strong> (<em>None or tf.float</em>) – Minimum UT velocity [m/s]</p></li>
<li><p><strong>max_ut_velocity</strong> (<em>None or tf.float</em>) – Maximim UT velocity [m/s]</p></li>
<li><p><strong>dtype</strong> (<em>tf.DType</em>) – Datatype to use for internal processing and output.
If a complex datatype is provided, the corresponding precision of
real components is used.
Defaults to <cite>tf.complex64</cite> (<cite>tf.float32</cite>).</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ut_loc</strong> (<em>[batch_size, num_ut, 3], tf.float</em>) – UTs locations. The first <code class="docutils literal notranslate"><span class="pre">num_ut</span></code> items along the axis with index
1 correspond to the served UTs, whereas the remaining
<code class="docutils literal notranslate"><span class="pre">num_interferer</span></code> items correspond to the interfeering UTs.</p></li>
<li><p><strong>bs_loc</strong> (<em>[batch_size, 1, 3], tf.float</em>) – BS location. Set to (0,0,0) for all batch examples.</p></li>
<li><p><strong>ut_orientations</strong> (<em>[batch_size, num_ut, 3], tf.float</em>) – UTs orientations [radian]. The first <code class="docutils literal notranslate"><span class="pre">num_ut</span></code> items along the
axis with index 1 correspond to the served UTs, whereas the
remaining <code class="docutils literal notranslate"><span class="pre">num_interferer</span></code> items correspond to the interfeering
UTs.</p></li>
<li><p><strong>bs_orientations</strong> (<em>[batch_size, 1, 3], tf.float</em>) – BS orientation [radian]. Oriented towards the center of the sector.</p></li>
<li><p><strong>ut_velocities</strong> (<em>[batch_size, num_ut, 3], tf.float</em>) – UTs velocities [m/s]. The first <code class="docutils literal notranslate"><span class="pre">num_ut</span></code> items along the axis
with index 1 correspond to the served UTs, whereas the remaining
<code class="docutils literal notranslate"><span class="pre">num_interferer</span></code> items correspond to the interfeering UTs.</p></li>
<li><p><strong>in_state</strong> (<em>[batch_size, num_ut], tf.float</em>) – Indoor/outdoor state of UTs. <cite>True</cite> means indoor, <cite>False</cite> means
outdoor. The first <code class="docutils literal notranslate"><span class="pre">num_ut</span></code> items along the axis with
index 1 correspond to the served UTs, whereas the remaining
<code class="docutils literal notranslate"><span class="pre">num_interferer</span></code> items correspond to the interfeering UTs.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="exp-corr-mat">
<h3>exp_corr_mat<a class="headerlink" href="#exp-corr-mat" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="sionna.channel.exp_corr_mat">
<span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">exp_corr_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/utils.html#exp_corr_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.exp_corr_mat" title="Permalink to this definition"></a></dt>
<dd><p>Generate exponential correlation matrices.</p>
<p>This function computes for every element <span class="math notranslate nohighlight">\(a\)</span> of a complex-valued
tensor <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> the corresponding <span class="math notranslate nohighlight">\(n\times n\)</span> exponential
correlation matrix <span class="math notranslate nohighlight">\(\mathbf{R}(a,n)\)</span>, defined as (Eq. 1, <a class="reference internal" href="#mal2018" id="id27"><span>[MAL2018]</span></a>):</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{R}(a,n)_{i,j} = \begin{cases}
            1 &amp; \text{if } i=j\\
            a^{i-j}  &amp; \text{if } i&gt;j\\
            (a^\star)^{j-i}  &amp; \text{if } j&lt;i, j=1,\dots,n\\
          \end{cases}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(|a|&lt;1\)</span> and <span class="math notranslate nohighlight">\(\mathbf{R}\in\mathbb{C}^{n\times n}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>[n_0, …, n_k], tf.complex</em>) – A tensor of arbitrary rank whose elements
have an absolute value smaller than one.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – Number of dimensions of the output correlation matrices.</p></li>
<li><p><strong>dtype</strong> (<em>tf.complex64, tf.complex128</em>) – The dtype of the output.</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p><strong>R</strong> (<em>[n_0, …, n_k, n, n], tf.complex</em>) – A tensor of the same dtype as the input tensor <span class="math notranslate nohighlight">\(\mathbf{a}\)</span>.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="one-ring-corr-mat">
<h3>one_ring_corr_mat<a class="headerlink" href="#one-ring-corr-mat" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="sionna.channel.one_ring_corr_mat">
<span class="sig-prename descclassname"><span class="pre">sionna.channel.</span></span><span class="sig-name descname"><span class="pre">one_ring_corr_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phi_deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_phi_deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/channel/utils.html#one_ring_corr_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.channel.one_ring_corr_mat" title="Permalink to this definition"></a></dt>
<dd><p>Generate covariance matrices from the one-ring model.</p>
<p>This function generates approximate covariance matrices for the
so-called <cite>one-ring</cite> model (Eq. 2.24) <a class="reference internal" href="mimo.html#bhs2017" id="id28"><span>[BHS2017]</span></a>. A uniform
linear array (ULA) with uniform antenna spacing is assumed. The elements
of the covariance matrices are computed as:</p>
<div class="math notranslate nohighlight">
\[\mathbf{R}_{\ell,m} =
      \exp\left( j2\pi d_\text{H} (\ell -m)\sin(\varphi) \right)
      \exp\left( -\frac{\sigma_\varphi^2}{2}
      \left( 2\pi d_\text{H}(\ell -m)\cos(\varphi) \right)^2 \right)\]</div>
<p>for <span class="math notranslate nohighlight">\(\ell,m = 1,\dots, M\)</span>, where <span class="math notranslate nohighlight">\(M\)</span> is the number of antennas,
<span class="math notranslate nohighlight">\(\varphi\)</span> is the angle of arrival, <span class="math notranslate nohighlight">\(d_\text{H}\)</span> is the antenna
spacing in multiples of the wavelength,
and <span class="math notranslate nohighlight">\(\sigma^2_\varphi\)</span> is the angular standard deviation.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi_deg</strong> (<em>[n_0, …, n_k], tf.float</em>) – A tensor of arbitrary rank containing azimuth angles (deg) of arrival.</p></li>
<li><p><strong>num_ant</strong> (<em>int</em>) – Number of antennas</p></li>
<li><p><strong>d_h</strong> (<em>float</em>) – Antenna spacing in multiples of the wavelength. Defaults to 0.5.</p></li>
<li><p><strong>sigma_phi_deg</strong> (<em>float</em>) – Angular standard deviation (deg). Defaults to 15 (deg). Values greater
than 15 should not be used as the approximation becomes invalid.</p></li>
<li><p><strong>dtype</strong> (<em>tf.complex64, tf.complex128</em>) – The dtype of the output.</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p><strong>R</strong> ([n_0, …, n_k, num_ant, nun_ant], <cite>dtype</cite>) – Tensor containing the covariance matrices of the desired dtype.</p>
</dd>
</dl>
</dd></dl>

<dl>
<dt>References:</dt><dd><dl class="citation">
<dt class="label" id="tr38901"><span class="brackets">TR38901</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id2">2</a>,<a href="#id4">3</a>,<a href="#id5">4</a>,<a href="#id6">5</a>,<a href="#id7">6</a>,<a href="#id8">7</a>,<a href="#id10">8</a>,<a href="#id11">9</a>,<a href="#id12">10</a>,<a href="#id13">11</a>,<a href="#id14">12</a>,<a href="#id15">13</a>,<a href="#id16">14</a>,<a href="#id17">15</a>,<a href="#id18">16</a>,<a href="#id19">17</a>,<a href="#id20">18</a>,<a href="#id24">19</a>,<a href="#id25">20</a>,<a href="#id26">21</a>)</span></dt>
<dd><p>3GPP TR 38.901,
“Study on channel model for frequencies from 0.5 to 100 GHz“, Release 16.1</p>
</dd>
<dt class="label" id="tse"><span class="brackets"><a class="fn-backref" href="#id3">Tse</a></span></dt>
<dd><p>D. Tse and P. Viswanath, “Fundamentals of wireless communication“,
Cambridge university press, 2005.</p>
</dd>
<dt class="label" id="sos"><span class="brackets"><a class="fn-backref" href="#id9">SoS</a></span></dt>
<dd><ol class="upperalpha simple" start="3">
<li><p>Xiao, Y. R. Zheng and N. C. Beaulieu, “Novel Sum-of-Sinusoids Simulation Models for Rayleigh and Rician Fading Channels,” in IEEE Transactions on Wireless Communications, vol. 5, no. 12, pp. 3667-3679, December 2006, doi: 10.1109/TWC.2006.256990.</p></li>
</ol>
</dd>
<dt class="label" id="mal2018"><span class="brackets"><a class="fn-backref" href="#id27">MAL2018</a></span></dt>
<dd><p>Ranjan K. Mallik,
“The exponential correlation matrix: Eigen-analysis and
applications”, IEEE Trans. Wireless Commun., vol. 17, no. 7,
pp. 4690-4705, Jul. 2018.</p>
</dd>
<dt class="label" id="bhs2017"><span class="brackets"><a class="fn-backref" href="#id28">BHS2017</a></span></dt>
<dd><p>Emil Björnson, Jakob Hoydis and Luca Sanguinetti (2017),
<a class="reference external" href="https://massivemimobook.com">“Massive MIMO Networks: Spectral, Energy, and Hardware Efficiency”</a>,
Foundations and Trends in Signal Processing:
Vol. 11, No. 3-4, pp 154–655.</p>
</dd>
</dl>
</dd>
</dl>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mapping.html" class="btn btn-neutral float-left" title="Mapping" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ofdm.html" class="btn btn-neutral float-right" title="Orthogonal Frequency-Division Multiplexing (OFDM)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2022 NVIDIA CORPORATION.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>