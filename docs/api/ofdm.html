<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Orthogonal Frequency-Division Multiplexing (OFDM) &mdash; Sionna 0.17.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/sionna.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Multiple-Input Multiple-Output (MIMO)" href="mimo.html" />
    <link rel="prev" title="Discrete" href="channel.discrete.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Sionna
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#installation-using-pip">Installation using pip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#docker-based-installation">Docker-based Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#installation-from-source">Installation from source</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/Hello_World.html">“Hello, world!”</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/Discover_Sionna.html">Discover Sionna</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/Discover_Sionna.html#Load-Required-Packages">Load Required Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/Discover_Sionna.html#Sionna-Data-flow-and-Design-Paradigms">Sionna Data-flow and Design Paradigms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/Discover_Sionna.html#Let’s-Get-Started---The-First-Layers-(Eager-Mode)">Let’s Get Started - The First Layers (<em>Eager Mode</em>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/Discover_Sionna.html#Batches-and-Multi-dimensional-Tensors">Batches and Multi-dimensional Tensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/Discover_Sionna.html#First-Link-level-Simulation">First Link-level Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/Discover_Sionna.html#Setting-up-the-End-to-end-Model">Setting up the End-to-end Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/Discover_Sionna.html#Run-some-Throughput-Tests-(Graph-Mode)">Run some Throughput Tests (Graph Mode)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/Discover_Sionna.html#Bit-Error-Rate-(BER)-Monte-Carlo-Simulations">Bit-Error Rate (BER) Monte-Carlo Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/Discover_Sionna.html#Conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#for-beginners">For Beginners</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/Sionna_tutorial_part1.html">Part 1: Getting Started with Sionna</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part1.html#Imports-&amp;-Basics">Imports &amp; Basics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part1.html#Sionna-Data-flow-and-Design-Paradigms">Sionna Data-flow and Design Paradigms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part1.html#Hello,-Sionna!">Hello, Sionna!</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part1.html#Communication-Systems-as-Keras-Models">Communication Systems as Keras Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part1.html#Forward-Error-Correction-(FEC)">Forward Error Correction (FEC)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part1.html#Eager-vs-Graph-Mode">Eager vs Graph Mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part1.html#Exercise">Exercise</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Sionna_tutorial_part2.html">Part 2: Differentiable Communication Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part2.html#Imports">Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part2.html#Gradient-Computation-Through-End-to-end-Systems">Gradient Computation Through End-to-end Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part2.html#Creating-Custom-Layers">Creating Custom Layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part2.html#Setting-up-Training-Loops">Setting up Training Loops</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Sionna_tutorial_part3.html">Part 3: Advanced Link-level Simulations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part3.html#Imports">Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part3.html#OFDM-Resource-Grid-and-Stream-Management">OFDM Resource Grid and Stream Management</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Sionna_tutorial_part3.html#Stream-Management">Stream Management</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Sionna_tutorial_part3.html#OFDM-Resource-Grid">OFDM Resource Grid</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part3.html#Antenna-Arrays">Antenna Arrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part3.html#Channel-Model">Channel Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part3.html#Uplink-Transmission-in-the-Frequency-Domain">Uplink Transmission in the Frequency Domain</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Sionna_tutorial_part4.html">Part 4: Toward Learned Receivers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part4.html#Imports">Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part4.html#Simulation-Parameters">Simulation Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part4.html#Implemention-of-an-Advanced-Neural-Receiver">Implemention of an Advanced Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part4.html#Training-the-Neural-Receiver">Training the Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part4.html#Benchmarking-the-Neural-Receiver">Benchmarking the Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part4.html#Conclusion">Conclusion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_tutorial_part4.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Simple_MIMO_Simulation.html">Basic MIMO Simulations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Simple_MIMO_Simulation.html#Table-of-Contents">Table of Contents</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Simple_MIMO_Simulation.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Simple_MIMO_Simulation.html#Simple-uncoded-transmission">Simple uncoded transmission</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Simple_MIMO_Simulation.html#Adding-spatial-correlation">Adding spatial correlation</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Simple_MIMO_Simulation.html#Extension-to-channel-coding">Extension to channel coding</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Simple_MIMO_Simulation.html#BER-simulations-using-a-Keras-model">BER simulations using a Keras model</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Pulse_shaping_basics.html">Pulse-shaping Basics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Pulse_shaping_basics.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Pulse_shaping_basics.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Pulse_shaping_basics.html#Pulse-shaping-of-a-sequence-of-QAM-symbols">Pulse-shaping of a sequence of QAM symbols</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Pulse_shaping_basics.html#Recovering-the-QAM-symbols-through-matched-filtering-and-downsampling">Recovering the QAM symbols through matched filtering and downsampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Pulse_shaping_basics.html#Investigating-the-ACLR">Investigating the ACLR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Pulse_shaping_basics.html#Windowing">Windowing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Optical_Lumped_Amplification_Channel.html">Optical Channel with Lumped Amplification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Optical_Lumped_Amplification_Channel.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Optical_Lumped_Amplification_Channel.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Optical_Lumped_Amplification_Channel.html#Impulse-Generation">Impulse Generation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Optical_Lumped_Amplification_Channel.html#Attenuation">Attenuation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Optical_Lumped_Amplification_Channel.html#Amplified-Spontaneous-Emission-Noise">Amplified Spontaneous Emission Noise</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Optical_Lumped_Amplification_Channel.html#Channel-Configuration">Channel Configuration</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Optical_Lumped_Amplification_Channel.html#Transmission">Transmission</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Optical_Lumped_Amplification_Channel.html#Chromatic-Dispersion">Chromatic Dispersion</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Optical_Lumped_Amplification_Channel.html#id1">Channel Configuration</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Optical_Lumped_Amplification_Channel.html#id2">Transmission</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Optical_Lumped_Amplification_Channel.html#Kerr-Nonlinearity">Kerr Nonlinearity</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Optical_Lumped_Amplification_Channel.html#Channel-configuration">Channel configuration</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Optical_Lumped_Amplification_Channel.html#id4">Transmission</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Optical_Lumped_Amplification_Channel.html#Split-Step-Fourier-Method">Split-Step Fourier Method</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Optical_Lumped_Amplification_Channel.html#id5">Channel Configuration</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Optical_Lumped_Amplification_Channel.html#id6">Transmission</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Optical_Lumped_Amplification_Channel.html#References">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#for-experts">For Experts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html">5G Channel Coding and Rate-Matching: Polar vs. LDPC Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#BER-Performance-of-5G-Coding-Schemes">BER Performance of 5G Coding Schemes</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#Performance-under-Optimal-Decoding">Performance under Optimal Decoding</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#Performance-of-Longer-LDPC-Codes">Performance of Longer LDPC Codes</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#A-Deeper-Look-into-the-Polar-Code-Module">A Deeper Look into the Polar Code Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#Rate-Matching-and-Rate-Recovery">Rate-Matching and Rate-Recovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#Throughput-and-Decoding-Complexity">Throughput and Decoding Complexity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_Channel_Coding_Polar_vs_LDPC_Codes.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/5G_NR_PUSCH.html">5G NR PUSCH Tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_NR_PUSCH.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_NR_PUSCH.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_NR_PUSCH.html#A-Hello-World-Example">A Hello World Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_NR_PUSCH.html#Carrier-Configuration">Carrier Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_NR_PUSCH.html#Understanding-the-DMRS-Configuration">Understanding the DMRS Configuration</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/5G_NR_PUSCH.html#Configuring-Multiple-Layers">Configuring Multiple Layers</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/5G_NR_PUSCH.html#Controlling-the-Number-of-DMRS-Symbols-in-a-Slot">Controlling the Number of DMRS Symbols in a Slot</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/5G_NR_PUSCH.html#How-to-control-the-number-of-available-DMRS-ports?">How to control the number of available DMRS ports?</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_NR_PUSCH.html#Transport-Blocks-and-MCS">Transport Blocks and MCS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_NR_PUSCH.html#Looking-into-the-PUSCHTransmitter">Looking into the PUSCHTransmitter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_NR_PUSCH.html#Components-of-the-PUSCHReceiver">Components of the PUSCHReceiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/5G_NR_PUSCH.html#End-to-end-PUSCH-Simulations">End-to-end PUSCH Simulations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html">Bit-Interleaved Coded Modulation (BICM)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#System-Block-Diagram">System Block Diagram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#A-Simple-BICM-System">A Simple BICM System</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#Constellations-and-Bit-Channels">Constellations and Bit-Channels</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#Simple-BER-Simulations">Simple BER Simulations</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#All-zero-Codeword-Simulations">All-zero Codeword Simulations</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#Remove-Encoder:-Simulate-QPSK-with-All-zero-Codeword-Transmission">Remove Encoder: Simulate QPSK with All-zero Codeword Transmission</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#Remove-(De-)Mapping:-Approximate-the-LLR-Distribution-of-the-All-zero-Codeword-(and-BPSK/QPSK)">Remove (De-)Mapping: Approximate the LLR Distribution of the All-zero Codeword (and BPSK/QPSK)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#The-Role-of-the-Scrambler">The Role of the Scrambler</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#EXIT-Charts">EXIT Charts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#Mismatched-Demapping-and-the-Advantages-of-Min-sum-Decoding">Mismatched Demapping and the Advantages of Min-sum Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Bit_Interleaved_Coded_Modulation.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html">MIMO OFDM Transmissions over the CDL Channel Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Table-of-Contents">Table of Contents</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#System-Setup">System Setup</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Stream-Management">Stream Management</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#OFDM-Resource-Grid-&amp;-Pilot-Pattern">OFDM Resource Grid &amp; Pilot Pattern</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Antenna-Arrays">Antenna Arrays</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#CDL-Channel-Model">CDL Channel Model</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Other-Physical-Layer-Components">Other Physical Layer Components</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Simulations">Simulations</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Uplink-Transmission-in-the-Frequency-Domain">Uplink Transmission in the Frequency Domain</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Uplink-Transmission-in-the-Time-Domain">Uplink Transmission in the Time Domain</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Downlink-Transmission-in-the-Frequency-Domain">Downlink Transmission in the Frequency Domain</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Understand-the-Difference-Between-the-CDL-Models">Understand the Difference Between the CDL Models</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Create-an-End-to-End-Keras-Model">Create an End-to-End Keras Model</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Compare-Uplink-Performance-Over-the-Different-CDL-Models">Compare Uplink Performance Over the Different CDL Models</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Compare-Downlink-Performance-Over-the-Different-CDL-Models">Compare Downlink Performance Over the Different CDL Models</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Evaluate-the-Impact-of-Mobility">Evaluate the Impact of Mobility</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/MIMO_OFDM_Transmissions_over_CDL.html#Evaluate-the-Impact-of-Insufficient-Cyclic-Prefix-Length">Evaluate the Impact of Insufficient Cyclic Prefix Length</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Neural_Receiver.html">Neural Receiver for OFDM SIMO Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Neural_Receiver.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Neural_Receiver.html#Simulation-Parameters">Simulation Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Neural_Receiver.html#Neural-Receiver">Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Neural_Receiver.html#End-to-end-System">End-to-end System</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Neural_Receiver.html#End-to-end-System-as-a-Keras-Model">End-to-end System as a Keras Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Neural_Receiver.html#Evaluation-of-the-Baselines">Evaluation of the Baselines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Neural_Receiver.html#Training-the-Neural-Receiver">Training the Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Neural_Receiver.html#Evaluation-of-the-Neural-Receiver">Evaluation of the Neural Receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Neural_Receiver.html#Pre-computed-Results">Pre-computed Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Neural_Receiver.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Realistic_Multiuser_MIMO_Simulations.html">Realistic Multiuser MIMO OFDM Simulations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Realistic_Multiuser_MIMO_Simulations.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Realistic_Multiuser_MIMO_Simulations.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Realistic_Multiuser_MIMO_Simulations.html#System-Setup">System Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Realistic_Multiuser_MIMO_Simulations.html#Uplink-Transmissions-in-the-Frequency-Domain">Uplink Transmissions in the Frequency Domain</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Realistic_Multiuser_MIMO_Simulations.html#Compare-Estimated-and-Actual-Frequency-Responses">Compare Estimated and Actual Frequency Responses</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Realistic_Multiuser_MIMO_Simulations.html#Understand-the-Difference-Between-the-Channel-Models">Understand the Difference Between the Channel Models</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Realistic_Multiuser_MIMO_Simulations.html#Setup-a-Keras-Model-for-BER-simulations">Setup a Keras Model for BER simulations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/OFDM_MIMO_Detection.html">OFDM MIMO Channel Estimation and Detection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/OFDM_MIMO_Detection.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/OFDM_MIMO_Detection.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/OFDM_MIMO_Detection.html#Simulation-parameters">Simulation parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/OFDM_MIMO_Detection.html#Estimation-of-the-channel-time,-frequency,-and-spatial-covariance-matrices">Estimation of the channel time, frequency, and spatial covariance matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/OFDM_MIMO_Detection.html#Loading-the-channel-covariance-matrices">Loading the channel covariance matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/OFDM_MIMO_Detection.html#Comparison-of-OFDM-estimators">Comparison of OFDM estimators</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/OFDM_MIMO_Detection.html#End-to-end-model">End-to-end model</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/OFDM_MIMO_Detection.html#Comparison-of-MIMO-detectors">Comparison of MIMO detectors</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/OFDM_MIMO_Detection.html#id1">End-to-end model</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Introduction_to_Iterative_Detection_and_Decoding.html">Introduction to Iterative Detection and Decoding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Introduction_to_Iterative_Detection_and_Decoding.html#Iterative-Detection-and-Decoding">Iterative Detection and Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Introduction_to_Iterative_Detection_and_Decoding.html#Table-of-contents">Table of contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Introduction_to_Iterative_Detection_and_Decoding.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Introduction_to_Iterative_Detection_and_Decoding.html#Simulation-Parameters">Simulation Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Introduction_to_Iterative_Detection_and_Decoding.html#Setting-up-the-Keras-Models">Setting-up the Keras Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Introduction_to_Iterative_Detection_and_Decoding.html#Non-IDD-versus-IDD-Benchmarks">Non-IDD versus IDD Benchmarks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Introduction_to_Iterative_Detection_and_Decoding.html#Discussion-Optimizing-IDD-with-Machine-Learning">Discussion-Optimizing IDD with Machine Learning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Introduction_to_Iterative_Detection_and_Decoding.html#Comments">Comments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Introduction_to_Iterative_Detection_and_Decoding.html#List-of-References">List of References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Autoencoder.html">End-to-end Learning with Autoencoders</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Autoencoder.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Autoencoder.html#Simulation-Parameters">Simulation Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Autoencoder.html#Neural-Demapper">Neural Demapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Autoencoder.html#Trainable-End-to-end-System:-Conventional-Training">Trainable End-to-end System: Conventional Training</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Autoencoder.html#Trainable-End-to-end-System:-RL-based-Training">Trainable End-to-end System: RL-based Training</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Autoencoder.html#Evaluation">Evaluation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Autoencoder.html#Visualizing-the-Learned-Constellations">Visualizing the Learned Constellations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Autoencoder.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html">Weighted Belief Propagation Decoding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html#Weighted-BP-for-BCH-Codes">Weighted BP for BCH Codes</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html#Weights-before-Training-and-Simulation-of-BER">Weights <em>before</em> Training and Simulation of BER</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html#Training">Training</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html#Results">Results</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html#Further-Experiments">Further Experiments</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html#Damped-BP">Damped BP</a></li>
<li class="toctree-l5"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html#Learning-the-5G-LDPC-Code">Learning the 5G LDPC Code</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Weighted_BP_Algorithm.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/CIR_Dataset.html">Channel Models from Datasets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/CIR_Dataset.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/CIR_Dataset.html#Simulation-Parameters">Simulation Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/CIR_Dataset.html#Creating-a-Simple-Dataset">Creating a Simple Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/CIR_Dataset.html#Generators">Generators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/CIR_Dataset.html#Use-the-Channel-Model-for-OFDM-Transmissions">Use the Channel Model for OFDM Transmissions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/DeepMIMO.html">Using the DeepMIMO Dataset with Sionna</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/DeepMIMO.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/DeepMIMO.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/DeepMIMO.html#Configuration-of-DeepMIMO">Configuration of DeepMIMO</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/DeepMIMO.html#Visualization-of-the-dataset">Visualization of the dataset</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/DeepMIMO.html#Using-DeepMIMO-with-Sionna">Using DeepMIMO with Sionna</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/DeepMIMO.html#Random-Sampling-of-Multi-User-Channels">Random Sampling of Multi-User Channels</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/DeepMIMO.html#Link-level-Simulations-using-Sionna-and-DeepMIMO">Link-level Simulations using Sionna and DeepMIMO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/DeepMIMO.html#DeepMIMO-License-and-Citation">DeepMIMO License and Citation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#ray-tracing">Ray Tracing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Introduction.html">Introduction to Sionna RT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Introduction.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Introduction.html#Background-Information">Background Information</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Introduction.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Introduction.html#Loading-Scenes">Loading Scenes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Introduction.html#Ray-Tracing-for-Radio-Propagation">Ray Tracing for Radio Propagation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Introduction.html#From-Paths-to-Channel-Impulse-Responses">From Paths to Channel Impulse Responses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Introduction.html#BER-Evaluation">BER Evaluation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Introduction.html#Runtime-vs-Depth">Runtime vs Depth</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Introduction.html#Coverage-Map">Coverage Map</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Introduction.html#Site-specifc-Link-Level-Simulations">Site-specifc Link-Level Simulations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Introduction.html#Conclusion-and-Outlook">Conclusion and Outlook</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Diffraction.html">Tutorial on Diffraction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Diffraction.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Diffraction.html#Background-Information">Background Information</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Diffraction.html#Wedge-vs-Edge">Wedge vs Edge</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Diffraction.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Diffraction.html#Experiments-with-a-Simple-Wedge">Experiments with a Simple Wedge</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Diffraction.html#Coverage-Maps-with-Diffraction">Coverage Maps with Diffraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Diffraction.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Scattering.html">Tutorial on Scattering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Scattering.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Scattering.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Scattering.html#Scattering-Basics">Scattering Basics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Scattering.html#Scattering-Patterns">Scattering Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Scattering.html#Validation-Against-the-“Far”-Wall-Approximation">Validation Against the “Far”-Wall Approximation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Scattering.html#Coverage-Maps-With-Scattering">Coverage Maps With Scattering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Scattering.html#Impact-on-Channel-Impulse-Response">Impact on Channel Impulse Response</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Scattering.html#Summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Scattering.html#References">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Mobility.html">Mobility in Sionna RT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Mobility.html#Table-of-Contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Mobility.html#Background-Information">Background Information</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Mobility.html#GPU-Configuration-and-Imports">GPU Configuration and Imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Mobility.html#Controlling-Position-and-Orientation-of-Scene-Objects">Controlling Position and Orientation of Scene Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Mobility.html#Time-Evolution-of-Channels-Via-Doppler-Shift">Time Evolution of Channels Via Doppler Shift</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Mobility.html#Example:-Delay-Doppler-Spectrum">Example: Delay-Doppler Spectrum</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Mobility.html#Comparison-of-Doppler--vs-Position-based-Time-Evolution">Comparison of Doppler- vs Position-based Time Evolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/Sionna_Ray_Tracing_Mobility.html#Summary">Summary</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../made_with_sionna.html">“Made with Sionna”</a></li>
<li class="toctree-l1"><a class="reference internal" href="../em_primer.html">Primer on Electromagnetics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../em_primer.html#coordinate-system-rotations-and-vector-fields">Coordinate system, rotations, and vector fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../em_primer.html#planar-time-harmonic-waves">Planar Time-Harmonic Waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../em_primer.html#far-field-of-a-transmitting-antenna">Far Field of a Transmitting Antenna</a></li>
<li class="toctree-l2"><a class="reference internal" href="../em_primer.html#modelling-of-a-receiving-antenna">Modelling of a Receiving Antenna</a></li>
<li class="toctree-l2"><a class="reference internal" href="../em_primer.html#general-propagation-path">General Propagation Path</a></li>
<li class="toctree-l2"><a class="reference internal" href="../em_primer.html#frequency-impulse-response">Frequency &amp; Impulse Response</a></li>
<li class="toctree-l2"><a class="reference internal" href="../em_primer.html#reflection-and-refraction">Reflection and Refraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../em_primer.html#diffraction">Diffraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../em_primer.html#scattering">Scattering</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="sionna.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="fec.html">Forward Error Correction (FEC)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="fec.linear.html">Linear Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fec.linear.html#encoder">Encoder</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.linear.html#linearencoder">LinearEncoder</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.linear.html#allzeroencoder">AllZeroEncoder</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="fec.linear.html#decoder">Decoder</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.linear.html#osdecoder">OSDecoder</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fec.ldpc.html">Low-Density Parity-Check (LDPC)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fec.ldpc.html#ldpc-encoder">LDPC Encoder</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.ldpc.html#ldpc5gencoder">LDPC5GEncoder</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="fec.ldpc.html#ldpc-decoder">LDPC Decoder</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.ldpc.html#ldpcbpdecoder">LDPCBPDecoder</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.ldpc.html#ldpc5gdecoder">LDPC5GDecoder</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fec.polar.html">Polar Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fec.polar.html#polar-encoding">Polar Encoding</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.polar.html#polar5gencoder">Polar5GEncoder</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.polar.html#polarencoder">PolarEncoder</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="fec.polar.html#polar-decoding">Polar Decoding</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.polar.html#polar5gdecoder">Polar5GDecoder</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.polar.html#polarscdecoder">PolarSCDecoder</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.polar.html#polarscldecoder">PolarSCLDecoder</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.polar.html#polarbpdecoder">PolarBPDecoder</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="fec.polar.html#polar-utility-functions">Polar Utility Functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.polar.html#generate-5g-ranking">generate_5g_ranking</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.polar.html#generate-polar-transform-mat">generate_polar_transform_mat</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.polar.html#generate-rm-code">generate_rm_code</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.polar.html#generate-dense-polar">generate_dense_polar</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fec.conv.html">Convolutional Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fec.conv.html#convolutional-encoding">Convolutional Encoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="fec.conv.html#viterbi-decoding">Viterbi Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="fec.conv.html#bcjr-decoding">BCJR Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="fec.conv.html#convolutional-code-utility-functions">Convolutional Code Utility Functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.conv.html#trellis">Trellis</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.conv.html#polynomial-selector">polynomial_selector</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fec.turbo.html">Turbo Codes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fec.turbo.html#turbo-encoding">Turbo Encoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="fec.turbo.html#turbo-decoding">Turbo Decoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="fec.turbo.html#turbo-utility-functions">Turbo Utility Functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.turbo.html#turbotermination">TurboTermination</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.turbo.html#polynomial-selector">polynomial_selector</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.turbo.html#puncture-pattern">puncture_pattern</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fec.crc.html">Cyclic Redundancy Check (CRC)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fec.crc.html#crcencoder">CRCEncoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="fec.crc.html#crcdecoder">CRCDecoder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fec.interleaving.html">Interleaving</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fec.interleaving.html#interleaver">Interleaver</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.interleaving.html#rowcolumninterleaver">RowColumnInterleaver</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.interleaving.html#randominterleaver">RandomInterleaver</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.interleaving.html#turbo3gppinterleaver">Turbo3GPPInterleaver</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="fec.interleaving.html#deinterleaver">Deinterleaver</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fec.scrambling.html">Scrambling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fec.scrambling.html#scrambler">Scrambler</a></li>
<li class="toctree-l4"><a class="reference internal" href="fec.scrambling.html#tb5gscrambler">TB5GScrambler</a></li>
<li class="toctree-l4"><a class="reference internal" href="fec.scrambling.html#descrambler">Descrambler</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fec.utils.html">Utility Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fec.utils.html#binary-linear-codes">(Binary) Linear Codes</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#load-parity-check-examples">load_parity_check_examples</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#alist2mat">alist2mat</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#load-alist">load_alist</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#generate-reg-ldpc">generate_reg_ldpc</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#make-systematic">make_systematic</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#gm2pcm">gm2pcm</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#pcm2gm">pcm2gm</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#verify-gm-pcm">verify_gm_pcm</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="fec.utils.html#exit-analysis">EXIT Analysis</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#plot-exit-chart">plot_exit_chart</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#get-exit-analytic">get_exit_analytic</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#plot-trajectory">plot_trajectory</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="fec.utils.html#miscellaneous">Miscellaneous</a><ul>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#gaussianpriorsource">GaussianPriorSource</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#bin2int">bin2int</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#int2bin">int2bin</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#bin2int-tf">bin2int_tf</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#int2bin-tf">int2bin_tf</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#int-mod-2">int_mod_2</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#llr2mi">llr2mi</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#j-fun">j_fun</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#j-fun-inv">j_fun_inv</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#j-fun-tf">j_fun_tf</a></li>
<li class="toctree-l5"><a class="reference internal" href="fec.utils.html#j-fun-inv-tf">j_fun_inv_tf</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mapping.html">Mapping</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mapping.html#constellations">Constellations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#constellation">Constellation</a></li>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#qam">qam</a></li>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#pam">pam</a></li>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#pam-gray">pam_gray</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mapping.html#mapper">Mapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="mapping.html#demapping">Demapping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#demapper">Demapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#demapperwithprior">DemapperWithPrior</a></li>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#symboldemapper">SymbolDemapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#symboldemapperwithprior">SymbolDemapperWithPrior</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mapping.html#utility-functions">Utility Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#symbollogits2llrs">SymbolLogits2LLRs</a></li>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#llrs2symbollogits">LLRs2SymbolLogits</a></li>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#symbollogits2llrswithprior">SymbolLogits2LLRsWithPrior</a></li>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#symbollogits2moments">SymbolLogits2Moments</a></li>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#symbolinds2bits">SymbolInds2Bits</a></li>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#pam2qam">PAM2QAM</a></li>
<li class="toctree-l4"><a class="reference internal" href="mapping.html#qam2pam">QAM2PAM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="channel.html">Channel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="channel.wireless.html">Wireless</a><ul>
<li class="toctree-l4"><a class="reference internal" href="channel.wireless.html#awgn">AWGN</a></li>
<li class="toctree-l4"><a class="reference internal" href="channel.wireless.html#flat-fading-channel">Flat-fading channel</a><ul>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#flatfadingchannel">FlatFadingChannel</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#generateflatfadingchannel">GenerateFlatFadingChannel</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#applyflatfadingchannel">ApplyFlatFadingChannel</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#spatialcorrelation">SpatialCorrelation</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#kroneckermodel">KroneckerModel</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#percolumnmodel">PerColumnModel</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="channel.wireless.html#channel-model-interface">Channel model interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="channel.wireless.html#time-domain-channel">Time domain channel</a><ul>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#timechannel">TimeChannel</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#generatetimechannel">GenerateTimeChannel</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#applytimechannel">ApplyTimeChannel</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#cir-to-time-channel">cir_to_time_channel</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#time-to-ofdm-channel">time_to_ofdm_channel</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="channel.wireless.html#channel-with-ofdm-waveform">Channel with OFDM waveform</a><ul>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#ofdmchannel">OFDMChannel</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#generateofdmchannel">GenerateOFDMChannel</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#applyofdmchannel">ApplyOFDMChannel</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#cir-to-ofdm-channel">cir_to_ofdm_channel</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="channel.wireless.html#rayleigh-block-fading">Rayleigh block fading</a></li>
<li class="toctree-l4"><a class="reference internal" href="channel.wireless.html#gpp-38-901-channel-models">3GPP 38.901 channel models</a><ul>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#panelarray">PanelArray</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#antenna">Antenna</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#antennaarray">AntennaArray</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#tapped-delay-line-tdl">Tapped delay line (TDL)</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#clustered-delay-line-cdl">Clustered delay line (CDL)</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#urban-microcell-umi">Urban microcell (UMi)</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#urban-macrocell-uma">Urban macrocell (UMa)</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#rural-macrocell-rma">Rural macrocell (RMa)</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="channel.wireless.html#external-datasets">External datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="channel.wireless.html#utility-functions">Utility functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#subcarrier-frequencies">subcarrier_frequencies</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#time-lag-discrete-time-channel">time_lag_discrete_time_channel</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#deg-2-rad">deg_2_rad</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#rad-2-deg">rad_2_deg</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#wrap-angle-0-360">wrap_angle_0_360</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#drop-uts-in-sector">drop_uts_in_sector</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#relocate-uts">relocate_uts</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#set-3gpp-scenario-parameters">set_3gpp_scenario_parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#gen-single-sector-topology">gen_single_sector_topology</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#gen-single-sector-topology-interferers">gen_single_sector_topology_interferers</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#exp-corr-mat">exp_corr_mat</a></li>
<li class="toctree-l5"><a class="reference internal" href="channel.wireless.html#one-ring-corr-mat">one_ring_corr_mat</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="channel.optical.html">Optical</a><ul>
<li class="toctree-l4"><a class="reference internal" href="channel.optical.html#split-step-fourier-method">Split-step Fourier method</a></li>
<li class="toctree-l4"><a class="reference internal" href="channel.optical.html#erbium-doped-fiber-amplifier">Erbium-doped fiber amplifier</a></li>
<li class="toctree-l4"><a class="reference internal" href="channel.optical.html#utility-functions">Utility functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="channel.optical.html#time-frequency-vector">time_frequency_vector</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="channel.discrete.html">Discrete</a><ul>
<li class="toctree-l4"><a class="reference internal" href="channel.discrete.html#binarymemorylesschannel">BinaryMemorylessChannel</a></li>
<li class="toctree-l4"><a class="reference internal" href="channel.discrete.html#binarysymmetricchannel">BinarySymmetricChannel</a></li>
<li class="toctree-l4"><a class="reference internal" href="channel.discrete.html#binaryerasurechannel">BinaryErasureChannel</a></li>
<li class="toctree-l4"><a class="reference internal" href="channel.discrete.html#binaryzchannel">BinaryZChannel</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Orthogonal Frequency-Division Multiplexing (OFDM)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#resource-grid">Resource Grid</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#resourcegrid">ResourceGrid</a></li>
<li class="toctree-l4"><a class="reference internal" href="#resourcegridmapper">ResourceGridMapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="#resourcegriddemapper">ResourceGridDemapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="#removenulledsubcarriers">RemoveNulledSubcarriers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#modulation-demodulation">Modulation &amp; Demodulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ofdmmodulator">OFDMModulator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ofdmdemodulator">OFDMDemodulator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pilot-pattern">Pilot Pattern</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pilotpattern">PilotPattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="#emptypilotpattern">EmptyPilotPattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="#kroneckerpilotpattern">KroneckerPilotPattern</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#channel-estimation">Channel Estimation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#basechannelestimator">BaseChannelEstimator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#basechannelinterpolator">BaseChannelInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lschannelestimator">LSChannelEstimator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#linearinterpolator">LinearInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lmmseinterpolator">LMMSEInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nearestneighborinterpolator">NearestNeighborInterpolator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tdl-time-cov-mat">tdl_time_cov_mat</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tdl-freq-cov-mat">tdl_freq_cov_mat</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#precoding">Precoding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#zfprecoder">ZFPrecoder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#equalization">Equalization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ofdmequalizer">OFDMEqualizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lmmseequalizer">LMMSEEqualizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mfequalizer">MFEqualizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#zfequalizer">ZFEqualizer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#detection">Detection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ofdmdetector">OFDMDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ofdmdetectorwithprior">OFDMDetectorWithPrior</a></li>
<li class="toctree-l4"><a class="reference internal" href="#epdetector">EPDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="#kbestdetector">KBestDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lineardetector">LinearDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="#maximumlikelihooddetector">MaximumLikelihoodDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="#maximumlikelihooddetectorwithprior">MaximumLikelihoodDetectorWithPrior</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mmsepicdetector">MMSEPICDetector</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mimo.html">Multiple-Input Multiple-Output (MIMO)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mimo.html#stream-management">Stream Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="mimo.html#precoding">Precoding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#zero-forcing-precoder">zero_forcing_precoder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mimo.html#equalization">Equalization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#lmmse-equalizer">lmmse_equalizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#mf-equalizer">mf_equalizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#zf-equalizer">zf_equalizer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mimo.html#detection">Detection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#epdetector">EPDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#kbestdetector">KBestDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#lineardetector">LinearDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#maximumlikelihooddetector">MaximumLikelihoodDetector</a></li>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#maximumlikelihooddetectorwithprior">MaximumLikelihoodDetectorWithPrior</a></li>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#mmse-pic">MMSE-PIC</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mimo.html#utility-functions">Utility Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#list2llr">List2LLR</a></li>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#list2llrsimple">List2LLRSimple</a></li>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#complex2real-vector">complex2real_vector</a></li>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#real2complex-vector">real2complex_vector</a></li>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#complex2real-matrix">complex2real_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#real2complex-matrix">real2complex_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#complex2real-covariance">complex2real_covariance</a></li>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#real2complex-covariance">real2complex_covariance</a></li>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#complex2real-channel">complex2real_channel</a></li>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#real2complex-channel">real2complex_channel</a></li>
<li class="toctree-l4"><a class="reference internal" href="mimo.html#whiten-channel">whiten_channel</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="nr.html">5G NR</a><ul>
<li class="toctree-l3"><a class="reference internal" href="nr.html#carrier">Carrier</a><ul>
<li class="toctree-l4"><a class="reference internal" href="nr.html#carrierconfig">CarrierConfig</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="nr.html#layer-mapping">Layer Mapping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="nr.html#layermapper">LayerMapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="nr.html#layerdemapper">LayerDemapper</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="nr.html#pusch">PUSCH</a><ul>
<li class="toctree-l4"><a class="reference internal" href="nr.html#puschconfig">PUSCHConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="nr.html#puschdmrsconfig">PUSCHDMRSConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="nr.html#puschlschannelestimator">PUSCHLSChannelEstimator</a></li>
<li class="toctree-l4"><a class="reference internal" href="nr.html#puschpilotpattern">PUSCHPilotPattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="nr.html#puschprecoder">PUSCHPrecoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="nr.html#puschreceiver">PUSCHReceiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="nr.html#puschtransmitter">PUSCHTransmitter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="nr.html#transport-block">Transport Block</a><ul>
<li class="toctree-l4"><a class="reference internal" href="nr.html#tbconfig">TBConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="nr.html#tbencoder">TBEncoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="nr.html#tbdecoder">TBDecoder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="nr.html#utils">Utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="nr.html#calculate-tb-size">calculate_tb_size</a></li>
<li class="toctree-l4"><a class="reference internal" href="nr.html#generate-prng-seq">generate_prng_seq</a></li>
<li class="toctree-l4"><a class="reference internal" href="nr.html#select-mcs">select_mcs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rt.html">Ray Tracing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="rt.html#scene">Scene</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rt.html#id1">Scene</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#compute-paths">compute_paths</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#trace-paths">trace_paths</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#compute-fields">compute_fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#coverage-map">coverage_map</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#load-scene">load_scene</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#preview">preview</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#render">render</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#render-to-file">render_to_file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rt.html#example-scenes">Example Scenes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rt.html#floor-wall">floor_wall</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#simple-street-canyon">simple_street_canyon</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#simple-street-canyon-with-cars">simple_street_canyon_with_cars</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#etoile">etoile</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#munich">munich</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#simple-wedge">simple_wedge</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#simple-reflector">simple_reflector</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#double-reflector">double_reflector</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#triple-reflector">triple_reflector</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#box">Box</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rt.html#paths">Paths</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rt.html#id13">Paths</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rt.html#coverage-maps">Coverage Maps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rt.html#coveragemap">CoverageMap</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rt.html#cameras">Cameras</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rt.html#camera">Camera</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rt.html#scene-objects">Scene Objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rt.html#sceneobject">SceneObject</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rt.html#radio-materials">Radio Materials</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rt.html#radiomaterial">RadioMaterial</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#scatteringpattern">ScatteringPattern</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rt.html#radio-devices">Radio Devices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rt.html#transmitter">Transmitter</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#receiver">Receiver</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rt.html#antenna-arrays">Antenna Arrays</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rt.html#antennaarray">AntennaArray</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#planararray">PlanarArray</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rt.html#antennas">Antennas</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rt.html#antenna">Antenna</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#compute-gain">compute_gain</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#visualize">visualize</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#dipole-pattern">dipole_pattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#hw-dipole-pattern">hw_dipole_pattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#iso-pattern">iso_pattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#tr38901-pattern">tr38901_pattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#polarization-model-1">polarization_model_1</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#polarization-model-2">polarization_model_2</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rt.html#utility-functions">Utility Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rt.html#cross">cross</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#dot">dot</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#normalize">normalize</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#phi-hat">phi_hat</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#rotate">rotate</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#rotation-matrix">rotation_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#rot-mat-from-unit-vecs">rot_mat_from_unit_vecs</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#r-hat">r_hat</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#sample-points-on-hemisphere">sample_points_on_hemisphere</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#theta-hat">theta_hat</a></li>
<li class="toctree-l4"><a class="reference internal" href="rt.html#theta-phi-from-unit-vec">theta_phi_from_unit_vec</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="signal.html">Signal</a><ul>
<li class="toctree-l3"><a class="reference internal" href="signal.html#filters">Filters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="signal.html#sincfilter">SincFilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="signal.html#raisedcosinefilter">RaisedCosineFilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="signal.html#rootraisedcosinefilter">RootRaisedCosineFilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="signal.html#customfilter">CustomFilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="signal.html#id1">Filter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="signal.html#window-functions">Window functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="signal.html#hannwindow">HannWindow</a></li>
<li class="toctree-l4"><a class="reference internal" href="signal.html#hammingwindow">HammingWindow</a></li>
<li class="toctree-l4"><a class="reference internal" href="signal.html#blackmanwindow">BlackmanWindow</a></li>
<li class="toctree-l4"><a class="reference internal" href="signal.html#customwindow">CustomWindow</a></li>
<li class="toctree-l4"><a class="reference internal" href="signal.html#id2">Window</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="signal.html#utility-functions">Utility Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="signal.html#convolve">convolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="signal.html#fft">fft</a></li>
<li class="toctree-l4"><a class="reference internal" href="signal.html#ifft">ifft</a></li>
<li class="toctree-l4"><a class="reference internal" href="signal.html#upsampling">Upsampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="signal.html#downsampling">Downsampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="signal.html#empirical-psd">empirical_psd</a></li>
<li class="toctree-l4"><a class="reference internal" href="signal.html#empirical-aclr">empirical_aclr</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">Utility Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="utils.html#metrics">Metrics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="utils.html#biterrorrate">BitErrorRate</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#bitwisemutualinformation">BitwiseMutualInformation</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#compute-ber">compute_ber</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#compute-bler">compute_bler</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#compute-ser">compute_ser</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#count-errors">count_errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#count-block-errors">count_block_errors</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#tensors">Tensors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="utils.html#expand-to-rank">expand_to_rank</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#flatten-dims">flatten_dims</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#flatten-last-dims">flatten_last_dims</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#insert-dims">insert_dims</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#split-dims">split_dims</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#matrix-sqrt">matrix_sqrt</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#matrix-sqrt-inv">matrix_sqrt_inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#matrix-inv">matrix_inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#matrix-pinv">matrix_pinv</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#miscellaneous">Miscellaneous</a><ul>
<li class="toctree-l4"><a class="reference internal" href="utils.html#binarysource">BinarySource</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#symbolsource">SymbolSource</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#qamsource">QAMSource</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#pamsource">PAMSource</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#plotber">PlotBER</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#sim-ber">sim_ber</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#ebnodb2no">ebnodb2no</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#hard-decisions">hard_decisions</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#plot-ber">plot_ber</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#complex-normal">complex_normal</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#log2">log2</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.html#log10">log10</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="config.html">Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/NVlabs/sionna/discussions">Discussions</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/NVlabs/sionna/issues">Report an Issue</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Sionna</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="sionna.html">API Documentation</a> &raquo;</li>
      <li>Orthogonal Frequency-Division Multiplexing (OFDM)</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="orthogonal-frequency-division-multiplexing-ofdm">
<h1>Orthogonal Frequency-Division Multiplexing (OFDM)<a class="headerlink" href="#orthogonal-frequency-division-multiplexing-ofdm" title="Permalink to this headline"></a></h1>
<p>This module provides layers and functions to support
simulation of OFDM-based systems. The key component is the
<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a> that defines how data and pilot symbols
are mapped onto a sequence of OFDM symbols with a given FFT size. The resource
grid can also define guard and DC carriers which are nulled. In 4G/5G parlance,
a <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a> would be a slot.
Once a <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a> is defined, one can use the
<a class="reference internal" href="#sionna.ofdm.ResourceGridMapper" title="sionna.ofdm.ResourceGridMapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGridMapper</span></code></a> to map a tensor of complex-valued
data symbols onto the resource grid, prior to OFDM modulation using the
<a class="reference internal" href="#sionna.ofdm.OFDMModulator" title="sionna.ofdm.OFDMModulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">OFDMModulator</span></code></a> or further processing in the
frequency domain.</p>
<p>The <a class="reference internal" href="#sionna.ofdm.PilotPattern" title="sionna.ofdm.PilotPattern"><code class="xref py py-class docutils literal notranslate"><span class="pre">PilotPattern</span></code></a> allows for a fine-grained configuration
of how transmitters send pilots for each of their streams or antennas. As the
management of pilots in multi-cell MIMO setups can quickly become complicated,
the module provides the <a class="reference internal" href="#sionna.ofdm.KroneckerPilotPattern" title="sionna.ofdm.KroneckerPilotPattern"><code class="xref py py-class docutils literal notranslate"><span class="pre">KroneckerPilotPattern</span></code></a> class
that automatically generates orthogonal pilot transmissions for all transmitters
and streams.</p>
<p>Additionally, the module contains layers for channel estimation, precoding,
equalization, and detection,
such as the <a class="reference internal" href="#sionna.ofdm.LSChannelEstimator" title="sionna.ofdm.LSChannelEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">LSChannelEstimator</span></code></a>, the
<a class="reference internal" href="#sionna.ofdm.ZFPrecoder" title="sionna.ofdm.ZFPrecoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">ZFPrecoder</span></code></a>, and the <a class="reference internal" href="#sionna.ofdm.LMMSEEqualizer" title="sionna.ofdm.LMMSEEqualizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">LMMSEEqualizer</span></code></a> and
<a class="reference internal" href="#sionna.ofdm.LinearDetector" title="sionna.ofdm.LinearDetector"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearDetector</span></code></a>.
These are good starting points for the development of more advanced algorithms
and provide robust baselines for benchmarking.</p>
<div class="section" id="resource-grid">
<h2>Resource Grid<a class="headerlink" href="#resource-grid" title="Permalink to this headline"></a></h2>
<p>The following code snippet shows how to setup and visualize an instance of
<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">rg</span> <span class="o">=</span> <span class="n">ResourceGrid</span><span class="p">(</span><span class="n">num_ofdm_symbols</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
                  <span class="n">fft_size</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
                  <span class="n">subcarrier_spacing</span> <span class="o">=</span> <span class="mf">30e3</span><span class="p">,</span>
                  <span class="n">num_tx</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                  <span class="n">num_streams_per_tx</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                  <span class="n">num_guard_carriers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
                  <span class="n">dc_null</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                  <span class="n">pilot_pattern</span> <span class="o">=</span> <span class="s2">&quot;kronecker&quot;</span><span class="p">,</span>
                  <span class="n">pilot_ofdm_symbol_indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
<span class="n">rg</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
<img alt="../_images/resource_grid.png" src="../_images/resource_grid.png" />
<p>This code creates a resource grid consisting of 14 OFDM symbols with 64
subcarriers. The first five and last six subcarriers as well as the DC
subcarriers are nulled. The second and eleventh OFDM symbol are reserved
for pilot transmissions.</p>
<p>Subcarriers are numbered from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(N-1\)</span>, where <span class="math notranslate nohighlight">\(N\)</span>
is the FTT size. The index <span class="math notranslate nohighlight">\(0\)</span> corresponds to the lowest frequency,
which is <span class="math notranslate nohighlight">\(-\frac{N}{2}\Delta_f\)</span> (for <span class="math notranslate nohighlight">\(N\)</span> even) or
<span class="math notranslate nohighlight">\(-\frac{N-1}{2}\Delta_f\)</span> (for <span class="math notranslate nohighlight">\(N\)</span> odd), where <span class="math notranslate nohighlight">\(\Delta_f\)</span>
is the subcarrier spacing which is irrelevant for the resource grid.
The index <span class="math notranslate nohighlight">\(N-1\)</span> corresponds to the highest frequency,
which is <span class="math notranslate nohighlight">\((\frac{N}{2}-1)\Delta_f\)</span> (for <span class="math notranslate nohighlight">\(N\)</span> even) or
<span class="math notranslate nohighlight">\(\frac{N-1}{2}\Delta_f\)</span> (for <span class="math notranslate nohighlight">\(N\)</span> odd).</p>
<div class="section" id="resourcegrid">
<h3>ResourceGrid<a class="headerlink" href="#resourcegrid" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">ResourceGrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_ofdm_symbols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subcarrier_spacing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_tx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_streams_per_tx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cyclic_prefix_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_guard_carriers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc_null</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pilot_pattern</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pilot_ofdm_symbol_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/resource_grid.html#ResourceGrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.ResourceGrid" title="Permalink to this definition"></a></dt>
<dd><p>Defines a <cite>ResourceGrid</cite> spanning multiple OFDM symbols and subcarriers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_ofdm_symbols</strong> (<em>int</em>) – Number of OFDM symbols.</p></li>
<li><p><strong>fft_size</strong> (<em>int</em>) – FFT size (, i.e., the number of subcarriers).</p></li>
<li><p><strong>subcarrier_spacing</strong> (<em>float</em>) – The subcarrier spacing in Hz.</p></li>
<li><p><strong>num_tx</strong> (<em>int</em>) – Number of transmitters.</p></li>
<li><p><strong>num_streams_per_tx</strong> (<em>int</em>) – Number of streams per transmitter.</p></li>
<li><p><strong>cyclic_prefix_length</strong> (<em>int</em>) – Length of the cyclic prefix.</p></li>
<li><p><strong>num_guard_carriers</strong> (<em>int</em>) – List of two integers defining the number of guardcarriers at the
left and right side of the resource grid.</p></li>
<li><p><strong>dc_null</strong> (<em>bool</em>) – Indicates if the DC carrier is nulled or not.</p></li>
<li><p><strong>pilot_pattern</strong> (<em>One of</em><em> [</em><em>None</em><em>, </em><em>&quot;kronecker&quot;</em><em>, </em><em>&quot;empty&quot;</em><em>, </em><a class="reference internal" href="#sionna.ofdm.PilotPattern" title="sionna.ofdm.PilotPattern"><em>PilotPattern</em></a><em>]</em>) – An instance of <a class="reference internal" href="#sionna.ofdm.PilotPattern" title="sionna.ofdm.PilotPattern"><code class="xref py py-class docutils literal notranslate"><span class="pre">PilotPattern</span></code></a>, a string
shorthand for the <a class="reference internal" href="#sionna.ofdm.KroneckerPilotPattern" title="sionna.ofdm.KroneckerPilotPattern"><code class="xref py py-class docutils literal notranslate"><span class="pre">KroneckerPilotPattern</span></code></a>
or <a class="reference internal" href="#sionna.ofdm.EmptyPilotPattern" title="sionna.ofdm.EmptyPilotPattern"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmptyPilotPattern</span></code></a>, or <cite>None</cite>.
Defaults to <cite>None</cite> which is equivalent to <cite>“empty”</cite>.</p></li>
<li><p><strong>pilot_ofdm_symbol_indices</strong> (<em>List</em><em>, </em><em>int</em>) – List of indices of OFDM symbols reserved for pilot transmissions.
Only needed if <code class="docutils literal notranslate"><span class="pre">pilot_pattern=&quot;kronecker&quot;</span></code>. Defaults to <cite>None</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>tf.Dtype</em>) – Defines the datatype for internal calculations and the output
dtype. Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.bandwidth">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">bandwidth</span></span><a class="headerlink" href="#sionna.ofdm.ResourceGrid.bandwidth" title="Permalink to this definition"></a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">fft_size*subcarrier_spacing</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>The occupied bandwidth [Hz]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.build_type_grid">
<span class="sig-name descname"><span class="pre">build_type_grid</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/resource_grid.html#ResourceGrid.build_type_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.ResourceGrid.build_type_grid" title="Permalink to this definition"></a></dt>
<dd><p>Returns a tensor indicating the type of each resource element.</p>
<p>Resource elements can be one of</p>
<ul class="simple">
<li><p>0 : Data symbol</p></li>
<li><p>1 : Pilot symbol</p></li>
<li><p>2 : Guard carrier symbol</p></li>
<li><p>3 : DC carrier symbol</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Output</dt>
<dd class="field-odd"><p><em>[num_tx, num_streams_per_tx, num_ofdm_symbols, fft_size], tf.int32</em> – Tensor indicating for each transmitter and stream the type of
the resource elements of the corresponding resource grid.
The type can be one of [0,1,2,3] as explained above.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.cyclic_prefix_length">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">cyclic_prefix_length</span></span><a class="headerlink" href="#sionna.ofdm.ResourceGrid.cyclic_prefix_length" title="Permalink to this definition"></a></dt>
<dd><p>Length of the cyclic prefix.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.dc_ind">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">dc_ind</span></span><a class="headerlink" href="#sionna.ofdm.ResourceGrid.dc_ind" title="Permalink to this definition"></a></dt>
<dd><p>Index of the DC subcarrier.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">fft_size</span></code> is odd, the index is (<code class="docutils literal notranslate"><span class="pre">fft_size</span></code>-1)/2.
If <code class="docutils literal notranslate"><span class="pre">fft_size</span></code> is even, the index is <code class="docutils literal notranslate"><span class="pre">fft_size</span></code>/2.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.dc_null">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">dc_null</span></span><a class="headerlink" href="#sionna.ofdm.ResourceGrid.dc_null" title="Permalink to this definition"></a></dt>
<dd><p>Indicates if the DC carriers is nulled or not.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.effective_subcarrier_ind">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">effective_subcarrier_ind</span></span><a class="headerlink" href="#sionna.ofdm.ResourceGrid.effective_subcarrier_ind" title="Permalink to this definition"></a></dt>
<dd><p>Returns the indices of the effective subcarriers.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.fft_size">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">fft_size</span></span><a class="headerlink" href="#sionna.ofdm.ResourceGrid.fft_size" title="Permalink to this definition"></a></dt>
<dd><p>The FFT size.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.num_data_symbols">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_data_symbols</span></span><a class="headerlink" href="#sionna.ofdm.ResourceGrid.num_data_symbols" title="Permalink to this definition"></a></dt>
<dd><p>Number of resource elements used for data transmissions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.num_effective_subcarriers">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_effective_subcarriers</span></span><a class="headerlink" href="#sionna.ofdm.ResourceGrid.num_effective_subcarriers" title="Permalink to this definition"></a></dt>
<dd><p>Number of subcarriers used for data and pilot transmissions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.num_guard_carriers">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_guard_carriers</span></span><a class="headerlink" href="#sionna.ofdm.ResourceGrid.num_guard_carriers" title="Permalink to this definition"></a></dt>
<dd><p>Number of left and right guard carriers.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.num_ofdm_symbols">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_ofdm_symbols</span></span><a class="headerlink" href="#sionna.ofdm.ResourceGrid.num_ofdm_symbols" title="Permalink to this definition"></a></dt>
<dd><p>The number of OFDM symbols of the resource grid.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.num_pilot_symbols">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_pilot_symbols</span></span><a class="headerlink" href="#sionna.ofdm.ResourceGrid.num_pilot_symbols" title="Permalink to this definition"></a></dt>
<dd><p>Number of resource elements used for pilot symbols.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.num_resource_elements">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_resource_elements</span></span><a class="headerlink" href="#sionna.ofdm.ResourceGrid.num_resource_elements" title="Permalink to this definition"></a></dt>
<dd><p>Number of resource elements.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.num_streams_per_tx">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_streams_per_tx</span></span><a class="headerlink" href="#sionna.ofdm.ResourceGrid.num_streams_per_tx" title="Permalink to this definition"></a></dt>
<dd><p>Number of streams  per transmitter.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.num_time_samples">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_time_samples</span></span><a class="headerlink" href="#sionna.ofdm.ResourceGrid.num_time_samples" title="Permalink to this definition"></a></dt>
<dd><p>The number of time-domain samples occupied by the resource grid.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.num_tx">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_tx</span></span><a class="headerlink" href="#sionna.ofdm.ResourceGrid.num_tx" title="Permalink to this definition"></a></dt>
<dd><p>Number of transmitters.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.num_zero_symbols">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_zero_symbols</span></span><a class="headerlink" href="#sionna.ofdm.ResourceGrid.num_zero_symbols" title="Permalink to this definition"></a></dt>
<dd><p>Number of empty resource elements.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.ofdm_symbol_duration">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ofdm_symbol_duration</span></span><a class="headerlink" href="#sionna.ofdm.ResourceGrid.ofdm_symbol_duration" title="Permalink to this definition"></a></dt>
<dd><p>Duration of an OFDM symbol with cyclic prefix [s].</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.pilot_pattern">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">pilot_pattern</span></span><a class="headerlink" href="#sionna.ofdm.ResourceGrid.pilot_pattern" title="Permalink to this definition"></a></dt>
<dd><p>The used PilotPattern.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tx_ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tx_stream_ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/resource_grid.html#ResourceGrid.show"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.ResourceGrid.show" title="Permalink to this definition"></a></dt>
<dd><p>Visualizes the resource grid for a specific transmitter and stream.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx_ind</strong> (<em>int</em>) – Indicates the transmitter index.</p></li>
<li><p><strong>tx_stream_ind</strong> (<em>int</em>) – Indicates the index of the stream.</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p><cite>matplotlib.figure</cite> – A handle to a matplot figure object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGrid.subcarrier_spacing">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">subcarrier_spacing</span></span><a class="headerlink" href="#sionna.ofdm.ResourceGrid.subcarrier_spacing" title="Permalink to this definition"></a></dt>
<dd><p>The subcarrier spacing [Hz].</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="resourcegridmapper">
<h3>ResourceGridMapper<a class="headerlink" href="#resourcegridmapper" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGridMapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">ResourceGridMapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/resource_grid.html#ResourceGridMapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.ResourceGridMapper" title="Permalink to this definition"></a></dt>
<dd><p>Maps a tensor of modulated data symbols to a ResourceGrid.</p>
<p>This layer takes as input a tensor of modulated data symbols
and maps them together with pilot symbols onto an
OFDM <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>. The output can be
converted to a time-domain signal with the
<code class="xref py py-class docutils literal notranslate"><span class="pre">Modulator</span></code> or further processed in the
frequency domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resource_grid</strong> (<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><em>ResourceGrid</em></a>) – An instance of <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>.</p></li>
<li><p><strong>dtype</strong> (<em>tf.Dtype</em>) – Datatype for internal calculations and the output dtype.
Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><p><em>[batch_size, num_tx, num_streams_per_tx, num_data_symbols], tf.complex</em> – The modulated data symbols to be mapped onto the resource grid.</p>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><p><em>[batch_size, num_tx, num_streams_per_tx, num_ofdm_symbols, fft_size], tf.complex</em> – The full OFDM resource grid in the frequency domain.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="resourcegriddemapper">
<h3>ResourceGridDemapper<a class="headerlink" href="#resourcegriddemapper" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.ResourceGridDemapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">ResourceGridDemapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_management</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/resource_grid.html#ResourceGridDemapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.ResourceGridDemapper" title="Permalink to this definition"></a></dt>
<dd><p>Extracts data-carrying resource elements from a resource grid.</p>
<p>This layer takes as input an OFDM <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a> and
extracts the data-carrying resource elements. In other words, it implements
the reverse operation of <a class="reference internal" href="#sionna.ofdm.ResourceGridMapper" title="sionna.ofdm.ResourceGridMapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGridMapper</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resource_grid</strong> (<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><em>ResourceGrid</em></a>) – An instance of <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>.</p></li>
<li><p><strong>stream_management</strong> (<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><em>StreamManagement</em></a>) – An instance of <a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a>.</p></li>
<li><p><strong>dtype</strong> (<em>tf.Dtype</em>) – Datatype for internal calculations and the output dtype.
Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><p><em>[batch_size, num_rx, num_streams_per_rx, num_ofdm_symbols, fft_size, data_dim]</em> – The full OFDM resource grid in the frequency domain.
The last dimension <cite>data_dim</cite> is optional. If <cite>data_dim</cite>
is used, it refers to the dimensionality of the data that should be
demapped to individual streams. An example would be LLRs.</p>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><p><em>[batch_size, num_rx, num_streams_per_rx, num_data_symbols, data_dim]</em> – The data that were mapped into the resource grid.
The last dimension <cite>data_dim</cite> is only returned if it was used for the
input.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="removenulledsubcarriers">
<h3>RemoveNulledSubcarriers<a class="headerlink" href="#removenulledsubcarriers" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.RemoveNulledSubcarriers">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">RemoveNulledSubcarriers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/resource_grid.html#RemoveNulledSubcarriers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.RemoveNulledSubcarriers" title="Permalink to this definition"></a></dt>
<dd><p>Removes nulled guard and/or DC subcarriers from a resource grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>resource_grid</strong> (<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><em>ResourceGrid</em></a>) – An instance of <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>.</p>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><p><em>[batch_size, num_tx, num_streams_per_tx, num_ofdm_symbols, fft_size], tf.complex64</em> – Full resource grid.</p>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><p><em>[batch_size, num_tx, num_streams_per_tx, num_ofdm_symbols, num_effective_subcarriers], tf.complex64</em> – Resource grid without nulled subcarriers.</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="modulation-demodulation">
<h2>Modulation &amp; Demodulation<a class="headerlink" href="#modulation-demodulation" title="Permalink to this headline"></a></h2>
<div class="section" id="ofdmmodulator">
<h3>OFDMModulator<a class="headerlink" href="#ofdmmodulator" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.OFDMModulator">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">OFDMModulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cyclic_prefix_length</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/modulator.html#OFDMModulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.OFDMModulator" title="Permalink to this definition"></a></dt>
<dd><p>Computes the time-domain representation of an OFDM resource grid
with (optional) cyclic prefix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cyclic_prefix_length</strong> (<em>int</em>) – Integer indicating the length of the
cyclic prefix that it prepended to each OFDM symbol. It cannot
be longer than the FFT size.</p>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><p><em>[…,num_ofdm_symbols,fft_size], tf.complex</em> – A resource grid in the frequency domain.</p>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><p><em>[…,num_ofdm_symbols*(fft_size+cyclic_prefix_length)], tf.complex</em> – Time-domain OFDM signal.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="ofdmdemodulator">
<h3>OFDMDemodulator<a class="headerlink" href="#ofdmdemodulator" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.OFDMDemodulator">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">OFDMDemodulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fft_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cyclic_prefix_length</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/demodulator.html#OFDMDemodulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.OFDMDemodulator" title="Permalink to this definition"></a></dt>
<dd><p>Computes the frequency-domain representation of an OFDM waveform
with cyclic prefix removal.</p>
<p>The demodulator assumes that the input sequence is generated by the
<a class="reference internal" href="channel.wireless.html#sionna.channel.TimeChannel" title="sionna.channel.TimeChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeChannel</span></code></a>. For a single pair of antennas,
the received signal sequence is given as:</p>
<div class="math notranslate nohighlight">
\[y_b = \sum_{\ell =L_\text{min}}^{L_\text{max}} \bar{h}_\ell x_{b-\ell} + w_b, \quad b \in[L_\text{min}, N_B+L_\text{max}-1]\]</div>
<p>where <span class="math notranslate nohighlight">\(\bar{h}_\ell\)</span> are the discrete-time channel taps,
<span class="math notranslate nohighlight">\(x_{b}\)</span> is the the transmitted signal,
and <span class="math notranslate nohighlight">\(w_\ell\)</span> Gaussian noise.</p>
<p>Starting from the first symbol, the demodulator cuts the input
sequence into pieces of size <code class="docutils literal notranslate"><span class="pre">cyclic_prefix_length</span> <span class="pre">+</span> <span class="pre">fft_size</span></code>,
and throws away any trailing symbols. For each piece, the cyclic
prefix is removed and the <code class="docutils literal notranslate"><span class="pre">fft_size</span></code>-point discrete Fourier
transform is computed.</p>
<p>Since the input sequence starts at time <span class="math notranslate nohighlight">\(L_\text{min}\)</span>,
the FFT-window has a timing offset of <span class="math notranslate nohighlight">\(L_\text{min}\)</span> symbols,
which leads to a subcarrier-dependent phase shift of
<span class="math notranslate nohighlight">\(e^{\frac{j2\pi k L_\text{min}}{N}}\)</span>, where <span class="math notranslate nohighlight">\(k\)</span>
is the subcarrier index, <span class="math notranslate nohighlight">\(N\)</span> is the FFT size,
and <span class="math notranslate nohighlight">\(L_\text{min} \le 0\)</span> is the largest negative time lag of
the discrete-time channel impulse response. This phase shift
is removed in this layer, by explicitly multiplying
each subcarrier by  <span class="math notranslate nohighlight">\(e^{\frac{-j2\pi k L_\text{min}}{N}}\)</span>.
This is a very important step to enable channel estimation with
sparse pilot patterns that needs to interpolate the channel frequency
response accross subcarriers. It also ensures that the
channel frequency response <cite>seen</cite> by the time-domain channel
is close to the <a class="reference internal" href="channel.wireless.html#sionna.channel.OFDMChannel" title="sionna.channel.OFDMChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">OFDMChannel</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fft_size</strong> (<em>int</em>) – FFT size (, i.e., the number of subcarriers).</p></li>
<li><p><strong>l_min</strong> (<em>int</em>) – The largest negative time lag of the discrete-time channel
impulse response. It should be the same value as that used by the
<cite>cir_to_time_channel</cite> function.</p></li>
<li><p><strong>cyclic_prefix_length</strong> (<em>int</em>) – Integer indicating the length of the cyclic prefix that
is prepended to each OFDM symbol.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><p><em>[…,num_ofdm_symbols*(fft_size+cyclic_prefix_length)+n], tf.complex</em> – Tensor containing the time-domain signal along the last dimension.
<cite>n</cite> is a nonnegative integer.</p>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><p><em>[…,num_ofdm_symbols,fft_size], tf.complex</em> – Tensor containing the OFDM resource grid along the last
two dimension.</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="pilot-pattern">
<h2>Pilot Pattern<a class="headerlink" href="#pilot-pattern" title="Permalink to this headline"></a></h2>
<p>A <a class="reference internal" href="#sionna.ofdm.PilotPattern" title="sionna.ofdm.PilotPattern"><code class="xref py py-class docutils literal notranslate"><span class="pre">PilotPattern</span></code></a> defines how transmitters send pilot
sequences for each of their antennas or streams over an OFDM resource grid.
It consists of two components,
a <code class="docutils literal notranslate"><span class="pre">mask</span></code> and <code class="docutils literal notranslate"><span class="pre">pilots</span></code>. The <code class="docutils literal notranslate"><span class="pre">mask</span></code> indicates which resource elements are
reserved for pilot transmissions by each transmitter and its respective
streams. In some cases, the number of streams is equal to the number of
transmit antennas, but this does not need to be the case, e.g., for precoded
transmissions. The <code class="docutils literal notranslate"><span class="pre">pilots</span></code> contains the pilot symbols that are transmitted
at the positions indicated by the <code class="docutils literal notranslate"><span class="pre">mask</span></code>. Separating a pilot pattern into
<code class="docutils literal notranslate"><span class="pre">mask</span></code> and <code class="docutils literal notranslate"><span class="pre">pilots</span></code> enables the implementation of a wide range of pilot
configurations, including trainable pilot sequences.</p>
<p>The following code snippet shows how to define a simple custom
<a class="reference internal" href="#sionna.ofdm.PilotPattern" title="sionna.ofdm.PilotPattern"><code class="xref py py-class docutils literal notranslate"><span class="pre">PilotPattern</span></code></a> for single transmitter, sending two streams
Note that <code class="docutils literal notranslate"><span class="pre">num_effective_subcarriers</span></code> is the number of subcarriers that
can be used for data or pilot transmissions. Due to guard
carriers or a nulled DC carrier, this number can be smaller than the
<code class="docutils literal notranslate"><span class="pre">fft_size</span></code> of the <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">num_tx</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_streams_per_tx</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">num_ofdm_symbols</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">num_effective_subcarriers</span> <span class="o">=</span> <span class="mi">12</span>

<span class="c1"># Create a pilot mask</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">num_tx</span><span class="p">,</span>
                 <span class="n">num_streams_per_tx</span><span class="p">,</span>
                 <span class="n">num_ofdm_symbols</span><span class="p">,</span>
                 <span class="n">num_effective_subcarriers</span><span class="p">])</span>
<span class="n">mask</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">],</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_pilot_symbols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>

<span class="c1"># Define pilot sequences</span>
<span class="n">pilots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">num_tx</span><span class="p">,</span>
                   <span class="n">num_streams_per_tx</span><span class="p">,</span>
                   <span class="n">num_pilot_symbols</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
<span class="n">pilots</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">num_pilot_symbols</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pilots</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">num_pilot_symbols</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Create a PilotPattern instance</span>
<span class="n">pp</span> <span class="o">=</span> <span class="n">PilotPattern</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">pilots</span><span class="p">)</span>

<span class="c1"># Visualize non-zero elements of the pilot sequence</span>
<span class="n">pp</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">show_pilot_ind</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../_images/pilot_pattern.png" src="../_images/pilot_pattern.png" />
<img alt="../_images/pilot_pattern_2.png" src="../_images/pilot_pattern_2.png" />
<p>As shown in the figures above, the pilots are mapped onto the mask from
the smallest effective subcarrier and OFDM symbol index to the highest
effective subcarrier and OFDM symbol index. Here, boths stream have 24
pilot symbols, out of which only 12 are nonzero. It is important to keep
this order of mapping in mind when designing more complex pilot sequences.</p>
<div class="section" id="pilotpattern">
<h3>PilotPattern<a class="headerlink" href="#pilotpattern" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.PilotPattern">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">PilotPattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pilots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/pilot_pattern.html#PilotPattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.PilotPattern" title="Permalink to this definition"></a></dt>
<dd><p>Class defining a pilot pattern for an OFDM ResourceGrid.</p>
<p>This class defines a pilot pattern object that is used to configure
an OFDM <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask</strong> (<em>[</em><em>num_tx</em><em>, </em><em>num_streams_per_tx</em><em>, </em><em>num_ofdm_symbols</em><em>, </em><em>num_effective_subcarriers</em><em>]</em><em>, </em><em>bool</em>) – Tensor indicating resource elements that are reserved for pilot transmissions.</p></li>
<li><p><strong>pilots</strong> (<em>[</em><em>num_tx</em><em>, </em><em>num_streams_per_tx</em><em>, </em><em>num_pilots</em><em>]</em><em>, </em><em>tf.complex</em>) – The pilot symbols to be mapped onto the <code class="docutils literal notranslate"><span class="pre">mask</span></code>.</p></li>
<li><p><strong>trainable</strong> (<em>bool</em>) – Indicates if <code class="docutils literal notranslate"><span class="pre">pilots</span></code> is a trainable <cite>Variable</cite>.
Defaults to <cite>False</cite>.</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – Indicates if the <code class="docutils literal notranslate"><span class="pre">pilots</span></code> should be normalized to an average
energy of one across the last dimension. This can be useful to
ensure that trainable <code class="docutils literal notranslate"><span class="pre">pilots</span></code> have a finite energy.
Defaults to <cite>False</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>tf.Dtype</em>) – Defines the datatype for internal calculations and the output
dtype. Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.PilotPattern.mask">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">mask</span></span><a class="headerlink" href="#sionna.ofdm.PilotPattern.mask" title="Permalink to this definition"></a></dt>
<dd><p>Mask of the pilot pattern</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.PilotPattern.normalize">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">normalize</span></span><a class="headerlink" href="#sionna.ofdm.PilotPattern.normalize" title="Permalink to this definition"></a></dt>
<dd><p>Returns or sets the flag indicating if the pilots
are normalized or not</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.PilotPattern.num_data_symbols">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_data_symbols</span></span><a class="headerlink" href="#sionna.ofdm.PilotPattern.num_data_symbols" title="Permalink to this definition"></a></dt>
<dd><p>Number of data symbols per transmit stream.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.PilotPattern.num_effective_subcarriers">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_effective_subcarriers</span></span><a class="headerlink" href="#sionna.ofdm.PilotPattern.num_effective_subcarriers" title="Permalink to this definition"></a></dt>
<dd><p>Number of effectvie subcarriers</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.PilotPattern.num_ofdm_symbols">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_ofdm_symbols</span></span><a class="headerlink" href="#sionna.ofdm.PilotPattern.num_ofdm_symbols" title="Permalink to this definition"></a></dt>
<dd><p>Number of OFDM symbols</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.PilotPattern.num_pilot_symbols">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_pilot_symbols</span></span><a class="headerlink" href="#sionna.ofdm.PilotPattern.num_pilot_symbols" title="Permalink to this definition"></a></dt>
<dd><p>Number of pilot symbols per transmit stream.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.PilotPattern.num_streams_per_tx">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_streams_per_tx</span></span><a class="headerlink" href="#sionna.ofdm.PilotPattern.num_streams_per_tx" title="Permalink to this definition"></a></dt>
<dd><p>Number of streams per transmitter</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.PilotPattern.num_tx">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">num_tx</span></span><a class="headerlink" href="#sionna.ofdm.PilotPattern.num_tx" title="Permalink to this definition"></a></dt>
<dd><p>Number of transmitters</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.PilotPattern.pilots">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">pilots</span></span><a class="headerlink" href="#sionna.ofdm.PilotPattern.pilots" title="Permalink to this definition"></a></dt>
<dd><p>Returns or sets the possibly normalized tensor of pilot symbols.
If pilots are normalized, the normalization will be applied
after new values for pilots have been set. If this is
not the desired behavior, turn normalization off.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sionna.ofdm.PilotPattern.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tx_ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_pilot_ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/pilot_pattern.html#PilotPattern.show"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.PilotPattern.show" title="Permalink to this definition"></a></dt>
<dd><p>Visualizes the pilot patterns for some transmitters and streams.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx_ind</strong> (<em>list, int</em>) – Indicates the indices of transmitters to be included.
Defaults to <cite>None</cite>, i.e., all transmitters included.</p></li>
<li><p><strong>stream_ind</strong> (<em>list, int</em>) – Indicates the indices of streams to be included.
Defaults to <cite>None</cite>, i.e., all streams included.</p></li>
<li><p><strong>show_pilot_ind</strong> (<em>bool</em>) – Indicates if the indices of the pilot symbols should be shown.</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p><strong>list</strong> (<em>matplotlib.figure.Figure</em>) – List of matplot figure objects showing each the pilot pattern
from a specific transmitter and stream.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sionna.ofdm.PilotPattern.trainable">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">trainable</span></span><a class="headerlink" href="#sionna.ofdm.PilotPattern.trainable" title="Permalink to this definition"></a></dt>
<dd><p>Returns if pilots are trainable or not</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="emptypilotpattern">
<h3>EmptyPilotPattern<a class="headerlink" href="#emptypilotpattern" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.EmptyPilotPattern">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">EmptyPilotPattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_tx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_streams_per_tx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ofdm_symbols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_effective_subcarriers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/pilot_pattern.html#EmptyPilotPattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.EmptyPilotPattern" title="Permalink to this definition"></a></dt>
<dd><p>Creates an empty pilot pattern.</p>
<p>Generates a instance of <a class="reference internal" href="#sionna.ofdm.PilotPattern" title="sionna.ofdm.PilotPattern"><code class="xref py py-class docutils literal notranslate"><span class="pre">PilotPattern</span></code></a> with
an empty <code class="docutils literal notranslate"><span class="pre">mask</span></code> and <code class="docutils literal notranslate"><span class="pre">pilots</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_tx</strong> (<em>int</em>) – Number of transmitters.</p></li>
<li><p><strong>num_streams_per_tx</strong> (<em>int</em>) – Number of streams per transmitter.</p></li>
<li><p><strong>num_ofdm_symbols</strong> (<em>int</em>) – Number of OFDM symbols.</p></li>
<li><p><strong>num_effective_subcarriers</strong> (<em>int</em>) – Number of effective subcarriers
that are available for the transmission of data and pilots.
Note that this number is generally smaller than the <code class="docutils literal notranslate"><span class="pre">fft_size</span></code>
due to nulled subcarriers.</p></li>
<li><p><strong>dtype</strong> (<em>tf.Dtype</em>) – Defines the datatype for internal calculations and the output
dtype. Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="kroneckerpilotpattern">
<h3>KroneckerPilotPattern<a class="headerlink" href="#kroneckerpilotpattern" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.KroneckerPilotPattern">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">KroneckerPilotPattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pilot_ofdm_symbol_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/pilot_pattern.html#KroneckerPilotPattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.KroneckerPilotPattern" title="Permalink to this definition"></a></dt>
<dd><p>Simple orthogonal pilot pattern with Kronecker structure.</p>
<p>This function generates an instance of <a class="reference internal" href="#sionna.ofdm.PilotPattern" title="sionna.ofdm.PilotPattern"><code class="xref py py-class docutils literal notranslate"><span class="pre">PilotPattern</span></code></a>
that allocates non-overlapping pilot sequences for all transmitters and
streams on specified OFDM symbols. As the same pilot sequences are reused
across those OFDM symbols, the resulting pilot pattern has a frequency-time
Kronecker structure. This structure enables a very efficient implementation
of the LMMSE channel estimator. Each pilot sequence is constructed from
randomly drawn QPSK constellation points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resource_grid</strong> (<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><em>ResourceGrid</em></a>) – An instance of a <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>.</p></li>
<li><p><strong>pilot_ofdm_symbol_indices</strong> (<em>list</em><em>, </em><em>int</em>) – List of integers defining the OFDM symbol indices that are reserved
for pilots.</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – Indicates if the <code class="docutils literal notranslate"><span class="pre">pilots</span></code> should be normalized to an average
energy of one across the last dimension.
Defaults to <cite>True</cite>.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed for the generation of the pilot sequence. Different seed values
lead to different sequences. Defaults to 0.</p></li>
<li><p><strong>dtype</strong> (<em>tf.Dtype</em>) – Defines the datatype for internal calculations and the output
dtype. Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is required that the <code class="docutils literal notranslate"><span class="pre">resource_grid</span></code>’s property
<code class="docutils literal notranslate"><span class="pre">num_effective_subcarriers</span></code> is an
integer multiple of <code class="docutils literal notranslate"><span class="pre">num_tx</span> <span class="pre">*</span> <span class="pre">num_streams_per_tx</span></code>. This condition is
required to ensure that all transmitters and streams get
non-overlapping pilot sequences. For a large number of streams and/or
transmitters, the pilot pattern becomes very sparse in the frequency
domain.</p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rg</span> <span class="o">=</span> <span class="n">ResourceGrid</span><span class="p">(</span><span class="n">num_ofdm_symbols</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">fft_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">subcarrier_spacing</span> <span class="o">=</span> <span class="mf">30e3</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">num_tx</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">num_streams_per_tx</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">pilot_pattern</span> <span class="o">=</span> <span class="s2">&quot;kronecker&quot;</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">pilot_ofdm_symbol_indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rg</span><span class="o">.</span><span class="n">pilot_pattern</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
<img alt="../_images/kronecker_pilot_pattern.png" src="../_images/kronecker_pilot_pattern.png" />
</dd></dl>

</div>
</div>
<div class="section" id="channel-estimation">
<h2>Channel Estimation<a class="headerlink" href="#channel-estimation" title="Permalink to this headline"></a></h2>
<div class="section" id="basechannelestimator">
<h3>BaseChannelEstimator<a class="headerlink" href="#basechannelestimator" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.BaseChannelEstimator">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">BaseChannelEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/channel_estimation.html#BaseChannelEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.BaseChannelEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Abstract layer for implementing an OFDM channel estimator.</p>
<p>Any layer that implements an OFDM channel estimator must implement this
class and its
<a class="reference internal" href="#sionna.ofdm.BaseChannelEstimator.estimate_at_pilot_locations" title="sionna.ofdm.BaseChannelEstimator.estimate_at_pilot_locations"><code class="xref py py-meth docutils literal notranslate"><span class="pre">estimate_at_pilot_locations()</span></code></a>
abstract method.</p>
<p>This class extracts the pilots from the received resource grid <code class="docutils literal notranslate"><span class="pre">y</span></code>, calls
the <a class="reference internal" href="#sionna.ofdm.BaseChannelEstimator.estimate_at_pilot_locations" title="sionna.ofdm.BaseChannelEstimator.estimate_at_pilot_locations"><code class="xref py py-meth docutils literal notranslate"><span class="pre">estimate_at_pilot_locations()</span></code></a>
method to estimate the channel for the pilot-carrying resource elements,
and then interpolates the channel to compute channel estimates for the
data-carrying resouce elements using the interpolation method specified by
<code class="docutils literal notranslate"><span class="pre">interpolation_type</span></code> or the <code class="docutils literal notranslate"><span class="pre">interpolator</span></code> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resource_grid</strong> (<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><em>ResourceGrid</em></a>) – An instance of <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>.</p></li>
<li><p><strong>interpolation_type</strong> (<em>One of</em><em> [</em><em>&quot;nn&quot;</em><em>, </em><em>&quot;lin&quot;</em><em>, </em><em>&quot;lin_time_avg&quot;</em><em>]</em><em>, </em><em>string</em>) – The interpolation method to be used.
It is ignored if <code class="docutils literal notranslate"><span class="pre">interpolator</span></code> is not <cite>None</cite>.
Available options are <a class="reference internal" href="#sionna.ofdm.NearestNeighborInterpolator" title="sionna.ofdm.NearestNeighborInterpolator"><code class="xref py py-class docutils literal notranslate"><span class="pre">NearestNeighborInterpolator</span></code></a> (<cite>“nn</cite>”)
or <a class="reference internal" href="#sionna.ofdm.LinearInterpolator" title="sionna.ofdm.LinearInterpolator"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearInterpolator</span></code></a> without (<cite>“lin”</cite>) or with
averaging across OFDM symbols (<cite>“lin_time_avg”</cite>).
Defaults to “nn”.</p></li>
<li><p><strong>interpolator</strong> (<a class="reference internal" href="#sionna.ofdm.BaseChannelInterpolator" title="sionna.ofdm.BaseChannelInterpolator"><em>BaseChannelInterpolator</em></a>) – An instance of <a class="reference internal" href="#sionna.ofdm.BaseChannelInterpolator" title="sionna.ofdm.BaseChannelInterpolator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseChannelInterpolator</span></code></a>,
such as <a class="reference internal" href="#sionna.ofdm.LMMSEInterpolator" title="sionna.ofdm.LMMSEInterpolator"><code class="xref py py-class docutils literal notranslate"><span class="pre">LMMSEInterpolator</span></code></a>,
or <cite>None</cite>. In the latter case, the interpolator specfied
by <code class="docutils literal notranslate"><span class="pre">interpolation_type</span></code> is used.
Otherwise, the <code class="docutils literal notranslate"><span class="pre">interpolator</span></code> is used and <code class="docutils literal notranslate"><span class="pre">interpolation_type</span></code>
is ignored.
Defaults to <cite>None</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>tf.Dtype</em>) – Datatype for internal calculations and the output dtype.
Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(y, no)</strong> – Tuple:</p></li>
<li><p><strong>y</strong> (<em>[batch_size, num_rx, num_rx_ant, num_ofdm_symbols,fft_size], tf.complex</em>) – Observed resource grid</p></li>
<li><p><strong>no</strong> (<em>[batch_size, num_rx, num_rx_ant] or only the first n&gt;=0 dims, tf.float</em>) – Variance of the AWGN</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_ofdm_symbols,fft_size], tf.complex</em>) – Channel estimates accross the entire resource grid for all
transmitters and streams</p></li>
<li><p><strong>err_var</strong> (Same shape as <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>, tf.float) – Channel estimation error variance accross the entire resource grid
for all transmitters and streams</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sionna.ofdm.BaseChannelEstimator.estimate_at_pilot_locations">
<em class="property"><span class="pre">abstract</span> </em><span class="sig-name descname"><span class="pre">estimate_at_pilot_locations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pilots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/channel_estimation.html#BaseChannelEstimator.estimate_at_pilot_locations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.BaseChannelEstimator.estimate_at_pilot_locations" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the channel for the pilot-carrying resource elements.</p>
<p>This is an abstract method that must be implemented by a concrete
OFDM channel estimator that implement this class.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pilots</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams, num_pilot_symbols], tf.complex</em>) – Observed signals for the pilot-carrying resource elements</p></li>
<li><p><strong>no</strong> (<em>[batch_size, num_rx, num_rx_ant] or only the first n&gt;=0 dims, tf.float</em>) – Variance of the AWGN</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams, num_pilot_symbols], tf.complex</em>) – Channel estimates for the pilot-carrying resource elements</p></li>
<li><p><strong>err_var</strong> (Same shape as <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>, tf.float) – Channel estimation error variance for the pilot-carrying
resource elements</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="basechannelinterpolator">
<h3>BaseChannelInterpolator<a class="headerlink" href="#basechannelinterpolator" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.BaseChannelInterpolator">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">BaseChannelInterpolator</span></span><a class="reference internal" href="../_modules/sionna/ofdm/channel_estimation.html#BaseChannelInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.BaseChannelInterpolator" title="Permalink to this definition"></a></dt>
<dd><p>Abstract layer for implementing an OFDM channel interpolator.</p>
<p>Any layer that implements an OFDM channel interpolator must implement this
callable class.</p>
<p>A channel interpolator is used by an OFDM channel estimator
(<a class="reference internal" href="#sionna.ofdm.BaseChannelEstimator" title="sionna.ofdm.BaseChannelEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseChannelEstimator</span></code></a>) to compute channel estimates
for the data-carrying resource elements from the channel estimates for the
pilot-carrying resource elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_pilot_symbols], tf.complex</em>) – Channel estimates for the pilot-carrying resource elements</p></li>
<li><p><strong>err_var</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_pilot_symbols], tf.complex</em>) – Channel estimation error variances for the pilot-carrying resource elements</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_ofdm_symbols, fft_size], tf.complex</em>) – Channel estimates accross the entire resource grid for all
transmitters and streams</p></li>
<li><p><strong>err_var</strong> (Same shape as <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>, tf.float) – Channel estimation error variance accross the entire resource grid
for all transmitters and streams</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="lschannelestimator">
<h3>LSChannelEstimator<a class="headerlink" href="#lschannelestimator" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.LSChannelEstimator">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">LSChannelEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/channel_estimation.html#LSChannelEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.LSChannelEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Layer implementing least-squares (LS) channel estimation for OFDM MIMO systems.</p>
<p>After LS channel estimation at the pilot positions, the channel estimates
and error variances are interpolated accross the entire resource grid using
a specified interpolation function.</p>
<p>For simplicity, the underlying algorithm is described for a vectorized observation,
where we have a nonzero pilot for all elements to be estimated.
The actual implementation works on a full OFDM resource grid with sparse
pilot patterns. The following model is assumed:</p>
<div class="math notranslate nohighlight">
\[\mathbf{y} = \mathbf{h}\odot\mathbf{p} + \mathbf{n}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{y}\in\mathbb{C}^{M}\)</span> is the received signal vector,
<span class="math notranslate nohighlight">\(\mathbf{p}\in\mathbb{C}^M\)</span> is the vector of pilot symbols,
<span class="math notranslate nohighlight">\(\mathbf{h}\in\mathbb{C}^{M}\)</span> is the channel vector to be estimated,
and <span class="math notranslate nohighlight">\(\mathbf{n}\in\mathbb{C}^M\)</span> is a zero-mean noise vector whose
elements have variance <span class="math notranslate nohighlight">\(N_0\)</span>. The operator <span class="math notranslate nohighlight">\(\odot\)</span> denotes
element-wise multiplication.</p>
<p>The channel estimate <span class="math notranslate nohighlight">\(\hat{\mathbf{h}}\)</span> and error variances
<span class="math notranslate nohighlight">\(\sigma^2_i\)</span>, <span class="math notranslate nohighlight">\(i=0,\dots,M-1\)</span>, are computed as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\hat{\mathbf{h}} &amp;= \mathbf{y} \odot
                   \frac{\mathbf{p}^\star}{\left|\mathbf{p}\right|^2}
                 = \mathbf{h} + \tilde{\mathbf{h}}\\
     \sigma^2_i &amp;= \mathbb{E}\left[\tilde{h}_i \tilde{h}_i^\star \right]
                 = \frac{N_0}{\left|p_i\right|^2}.\end{split}\]</div>
<p>The channel estimates and error variances are then interpolated accross
the entire resource grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resource_grid</strong> (<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><em>ResourceGrid</em></a>) – An instance of <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>.</p></li>
<li><p><strong>interpolation_type</strong> (<em>One of</em><em> [</em><em>&quot;nn&quot;</em><em>, </em><em>&quot;lin&quot;</em><em>, </em><em>&quot;lin_time_avg&quot;</em><em>]</em><em>, </em><em>string</em>) – The interpolation method to be used.
It is ignored if <code class="docutils literal notranslate"><span class="pre">interpolator</span></code> is not <cite>None</cite>.
Available options are <a class="reference internal" href="#sionna.ofdm.NearestNeighborInterpolator" title="sionna.ofdm.NearestNeighborInterpolator"><code class="xref py py-class docutils literal notranslate"><span class="pre">NearestNeighborInterpolator</span></code></a> (<cite>“nn</cite>”)
or <a class="reference internal" href="#sionna.ofdm.LinearInterpolator" title="sionna.ofdm.LinearInterpolator"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearInterpolator</span></code></a> without (<cite>“lin”</cite>) or with
averaging across OFDM symbols (<cite>“lin_time_avg”</cite>).
Defaults to “nn”.</p></li>
<li><p><strong>interpolator</strong> (<a class="reference internal" href="#sionna.ofdm.BaseChannelInterpolator" title="sionna.ofdm.BaseChannelInterpolator"><em>BaseChannelInterpolator</em></a>) – An instance of <a class="reference internal" href="#sionna.ofdm.BaseChannelInterpolator" title="sionna.ofdm.BaseChannelInterpolator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseChannelInterpolator</span></code></a>,
such as <a class="reference internal" href="#sionna.ofdm.LMMSEInterpolator" title="sionna.ofdm.LMMSEInterpolator"><code class="xref py py-class docutils literal notranslate"><span class="pre">LMMSEInterpolator</span></code></a>,
or <cite>None</cite>. In the latter case, the interpolator specfied
by <code class="docutils literal notranslate"><span class="pre">interpolation_type</span></code> is used.
Otherwise, the <code class="docutils literal notranslate"><span class="pre">interpolator</span></code> is used and <code class="docutils literal notranslate"><span class="pre">interpolation_type</span></code>
is ignored.
Defaults to <cite>None</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>tf.Dtype</em>) – Datatype for internal calculations and the output dtype.
Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(y, no)</strong> – Tuple:</p></li>
<li><p><strong>y</strong> (<em>[batch_size, num_rx, num_rx_ant, num_ofdm_symbols,fft_size], tf.complex</em>) – Observed resource grid</p></li>
<li><p><strong>no</strong> (<em>[batch_size, num_rx, num_rx_ant] or only the first n&gt;=0 dims, tf.float</em>) – Variance of the AWGN</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h_ls</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_ofdm_symbols,fft_size], tf.complex</em>) – Channel estimates accross the entire resource grid for all
transmitters and streams</p></li>
<li><p><strong>err_var</strong> (Same shape as <code class="docutils literal notranslate"><span class="pre">h_ls</span></code>, tf.float) – Channel estimation error variance accross the entire resource grid
for all transmitters and streams</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="linearinterpolator">
<h3>LinearInterpolator<a class="headerlink" href="#linearinterpolator" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.LinearInterpolator">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">LinearInterpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pilot_pattern</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_avg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/channel_estimation.html#LinearInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.LinearInterpolator" title="Permalink to this definition"></a></dt>
<dd><p>Linear channel estimate interpolation on a resource grid.</p>
<p>This class computes for each element of an OFDM resource grid
a channel estimate based on <code class="docutils literal notranslate"><span class="pre">num_pilots</span></code> provided channel estimates and
error variances through linear interpolation.
It is assumed that the measurements were taken at the nonzero positions
of a <a class="reference internal" href="#sionna.ofdm.PilotPattern" title="sionna.ofdm.PilotPattern"><code class="xref py py-class docutils literal notranslate"><span class="pre">PilotPattern</span></code></a>.</p>
<p>The interpolation is done first across sub-carriers and then
across OFDM symbols.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pilot_pattern</strong> (<a class="reference internal" href="#sionna.ofdm.PilotPattern" title="sionna.ofdm.PilotPattern"><em>PilotPattern</em></a>) – An instance of <a class="reference internal" href="#sionna.ofdm.PilotPattern" title="sionna.ofdm.PilotPattern"><code class="xref py py-class docutils literal notranslate"><span class="pre">PilotPattern</span></code></a></p></li>
<li><p><strong>time_avg</strong> (<em>bool</em>) – If enabled, measurements will be averaged across OFDM symbols
(i.e., time). This is useful for channels that do not vary
substantially over the duration of an OFDM frame. Defaults to <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_pilot_symbols], tf.complex</em>) – Channel estimates for the pilot-carrying resource elements</p></li>
<li><p><strong>err_var</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_pilot_symbols], tf.complex</em>) – Channel estimation error variances for the pilot-carrying resource elements</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_ofdm_symbols, fft_size], tf.complex</em>) – Channel estimates accross the entire resource grid for all
transmitters and streams</p></li>
<li><p><strong>err_var</strong> (Same shape as <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>, tf.float) – Channel estimation error variances accross the entire resource grid
for all transmitters and streams</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="lmmseinterpolator">
<h3>LMMSEInterpolator<a class="headerlink" href="#lmmseinterpolator" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.LMMSEInterpolator">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">LMMSEInterpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pilot_pattern</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_mat_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_mat_freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_mat_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t-f'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/channel_estimation.html#LMMSEInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.LMMSEInterpolator" title="Permalink to this definition"></a></dt>
<dd><p>LMMSE interpolation on a resource grid with optional spatial smoothing.</p>
<p>This class computes for each element of an OFDM resource grid
a channel estimate and error variance
through linear minimum mean square error (LMMSE) interpolation/smoothing.
It is assumed that the measurements were taken at the nonzero positions
of a <a class="reference internal" href="#sionna.ofdm.PilotPattern" title="sionna.ofdm.PilotPattern"><code class="xref py py-class docutils literal notranslate"><span class="pre">PilotPattern</span></code></a>.</p>
<p>Depending on the value of <code class="docutils literal notranslate"><span class="pre">order</span></code>, the interpolation is carried out
accross time (t), i.e., OFDM symbols, frequency (f), i.e., subcarriers,
and optionally space (s), i.e., receive antennas, in any desired order.</p>
<p>For simplicity, we describe the underlying algorithm assuming that interpolation
across the sub-carriers is performed first, followed by interpolation across
OFDM symbols, and finally by spatial smoothing across receive
antennas.
The algorithm is similar if interpolation and/or smoothing are performed in
a different order.
For clarity, antenna indices are omitted when describing frequency and time
interpolation, as the same process is applied to all the antennas.</p>
<p>The input <code class="docutils literal notranslate"><span class="pre">h_hat</span></code> is first reshaped to a resource grid
<span class="math notranslate nohighlight">\(\hat{\mathbf{H}} \in \mathbb{C}^{N \times M}\)</span>, by scattering the channel
estimates at pilot locations according to the <code class="docutils literal notranslate"><span class="pre">pilot_pattern</span></code>. <span class="math notranslate nohighlight">\(N\)</span>
denotes the number of OFDM symbols and <span class="math notranslate nohighlight">\(M\)</span> the number of sub-carriers.</p>
<p>The first pass consists in interpolating across the sub-carriers:</p>
<div class="math notranslate nohighlight">
\[\hat{\mathbf{h}}_n^{(1)} = \mathbf{A}_n \hat{\mathbf{h}}_n\]</div>
<p>where <span class="math notranslate nohighlight">\(1 \leq n \leq N\)</span> is the OFDM symbol index and <span class="math notranslate nohighlight">\(\hat{\mathbf{h}}_n\)</span> is
the <span class="math notranslate nohighlight">\(n^{\text{th}}\)</span> (transposed) row of <span class="math notranslate nohighlight">\(\hat{\mathbf{H}}\)</span>.
<span class="math notranslate nohighlight">\(\mathbf{A}_n\)</span> is the <span class="math notranslate nohighlight">\(M \times M\)</span> matrix such that:</p>
<div class="math notranslate nohighlight">
\[\mathbf{A}_n = \bar{\mathbf{A}}_n \mathbf{\Pi}_n^\intercal\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\bar{\mathbf{A}}_n = \underset{\mathbf{Z} \in \mathbb{C}^{M \times K_n}}{\text{argmin}} \left\lVert \mathbf{Z}\left( \mathbf{\Pi}_n^\intercal \mathbf{R^{(f)}} \mathbf{\Pi}_n + \mathbf{\Sigma}_n \right) - \mathbf{R^{(f)}} \mathbf{\Pi}_n \right\rVert_{\text{F}}^2\]</div>
<p>and <span class="math notranslate nohighlight">\(\mathbf{R^{(f)}}\)</span> is the <span class="math notranslate nohighlight">\(M \times M\)</span> channel frequency covariance matrix,
<span class="math notranslate nohighlight">\(\mathbf{\Pi}_n\)</span> the <span class="math notranslate nohighlight">\(M \times K_n\)</span> matrix that spreads <span class="math notranslate nohighlight">\(K_n\)</span>
values to a vector of size <span class="math notranslate nohighlight">\(M\)</span> according to the <code class="docutils literal notranslate"><span class="pre">pilot_pattern</span></code> for the <span class="math notranslate nohighlight">\(n^{\text{th}}\)</span> OFDM symbol,
and <span class="math notranslate nohighlight">\(\mathbf{\Sigma}_n \in \mathbb{R}^{K_n \times K_n}\)</span> is the channel estimation error covariance built from
<code class="docutils literal notranslate"><span class="pre">err_var</span></code> and assumed to be diagonal.
Computation of <span class="math notranslate nohighlight">\(\bar{\mathbf{A}}_n\)</span> is done using an algorithm based on complete orthogonal decomposition.
This is done to avoid matrix inversion for badly conditioned covariance matrices.</p>
<p>The channel estimation error variances after the first interpolation pass are computed as</p>
<div class="math notranslate nohighlight">
\[\mathbf{\Sigma}^{(1)}_n = \text{diag} \left( \mathbf{R^{(f)}} - \mathbf{A}_n \mathbf{\Xi}_n \mathbf{R^{(f)}} \right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{\Xi}_n\)</span> is the diagonal matrix of size <span class="math notranslate nohighlight">\(M \times M\)</span> that zeros the
columns corresponding to sub-carriers not carrying any pilots.
Note that interpolation is not performed for OFDM symbols which do not carry pilots.</p>
<p><strong>Remark</strong>: The interpolation matrix differs across OFDM symbols as different
OFDM symbols may carry pilots on different sub-carriers and/or have different
estimation error variances.</p>
<p>Scaling of the estimates is then performed to ensure that their
variances match the ones expected by the next interpolation step, and the error variances are updated accordingly:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
    \left[\hat{\mathbf{h}}_n^{(2)}\right]_m &amp;= s_{n,m} \left[\hat{\mathbf{h}}_n^{(1)}\right]_m\\
    \left[\mathbf{\Sigma}^{(2)}_n\right]_{m,m}  &amp;= s_{n,m}\left( s_{n,m}-1 \right) \left[\hat{\mathbf{\Sigma}}^{(1)}_n\right]_{m,m} + \left( 1 - s_{n,m} \right) \left[\mathbf{R^{(f)}}\right]_{m,m} + s_{n,m} \left[\mathbf{\Sigma}^{(1)}_n\right]_{m,m}
\end{align}\end{split}\]</div>
<p>where the scaling factor <span class="math notranslate nohighlight">\(s_{n,m}\)</span> is such that:</p>
<div class="math notranslate nohighlight">
\[\mathbb{E} \left\{ \left\lvert s_{n,m} \left[\hat{\mathbf{h}}_n^{(1)}\right]_m \right\rvert^2 \right\} = \left[\mathbf{R^{(f)}}\right]_{m,m} +  \mathbb{E} \left\{ \left\lvert s_{n,m} \left[\hat{\mathbf{h}}^{(1)}_n\right]_m - \left[\mathbf{h}_n\right]_m \right\rvert^2 \right\}\]</div>
<p>which leads to:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
    s_{n,m} &amp;= \frac{2 \left[\mathbf{R^{(f)}}\right]_{m,m}}{\left[\mathbf{R^{(f)}}\right]_{m,m} - \left[\mathbf{\Sigma}^{(1)}_n\right]_{m,m} + \left[\hat{\mathbf{\Sigma}}^{(1)}_n\right]_{m,m}}\\
    \hat{\mathbf{\Sigma}}^{(1)}_n &amp;= \mathbf{A}_n \mathbf{R^{(f)}} \mathbf{A}_n^{\mathrm{H}}.
\end{align}\end{split}\]</div>
<p>The second pass consists in interpolating across the OFDM symbols:</p>
<div class="math notranslate nohighlight">
\[\hat{\mathbf{h}}_m^{(3)} = \mathbf{B}_m \tilde{\mathbf{h}}^{(2)}_m\]</div>
<p>where <span class="math notranslate nohighlight">\(1 \leq m \leq M\)</span> is the sub-carrier index and <span class="math notranslate nohighlight">\(\tilde{\mathbf{h}}^{(2)}_m\)</span> is
the <span class="math notranslate nohighlight">\(m^{\text{th}}\)</span> column of</p>
<div class="math notranslate nohighlight">
\[\begin{split}\hat{\mathbf{H}}^{(2)} = \begin{bmatrix}
                            {\hat{\mathbf{h}}_1^{(2)}}^\intercal\\
                            \vdots\\
                            {\hat{\mathbf{h}}_N^{(2)}}^\intercal
                         \end{bmatrix}\end{split}\]</div>
<p>and <span class="math notranslate nohighlight">\(\mathbf{B}_m\)</span> is the <span class="math notranslate nohighlight">\(N \times N\)</span> interpolation LMMSE matrix:</p>
<div class="math notranslate nohighlight">
\[\mathbf{B}_m = \bar{\mathbf{B}}_m \tilde{\mathbf{\Pi}}_m^\intercal\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\bar{\mathbf{B}}_m = \underset{\mathbf{Z} \in \mathbb{C}^{N \times L_m}}{\text{argmin}} \left\lVert \mathbf{Z} \left( \tilde{\mathbf{\Pi}}_m^\intercal \mathbf{R^{(t)}}\tilde{\mathbf{\Pi}}_m + \tilde{\mathbf{\Sigma}}^{(2)}_m \right) -  \mathbf{R^{(t)}}\tilde{\mathbf{\Pi}}_m \right\rVert_{\text{F}}^2\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{R^{(t)}}\)</span> is the <span class="math notranslate nohighlight">\(N \times N\)</span> channel time covariance matrix,
<span class="math notranslate nohighlight">\(\tilde{\mathbf{\Pi}}_m\)</span> the <span class="math notranslate nohighlight">\(N \times L_m\)</span> matrix that spreads <span class="math notranslate nohighlight">\(L_m\)</span>
values to a vector of size <span class="math notranslate nohighlight">\(N\)</span> according to the <code class="docutils literal notranslate"><span class="pre">pilot_pattern</span></code> for the <span class="math notranslate nohighlight">\(m^{\text{th}}\)</span> sub-carrier,
and <span class="math notranslate nohighlight">\(\tilde{\mathbf{\Sigma}}^{(2)}_m \in \mathbb{R}^{L_m \times L_m}\)</span> is the diagonal matrix of channel estimation error variances
built by gathering the error variances from (<span class="math notranslate nohighlight">\(\mathbf{\Sigma}^{(2)}_1,\dots,\mathbf{\Sigma}^{(2)}_N\)</span>) corresponding
to resource elements carried by the <span class="math notranslate nohighlight">\(m^{\text{th}}\)</span> sub-carrier.
Computation of <span class="math notranslate nohighlight">\(\bar{\mathbf{B}}_m\)</span> is done using an algorithm based on complete orthogonal decomposition.
This is done to avoid matrix inversion for badly conditioned covariance matrices.</p>
<p>The resulting channel estimate for the resource grid is</p>
<div class="math notranslate nohighlight">
\[\hat{\mathbf{H}}^{(3)} = \left[ \hat{\mathbf{h}}_1^{(3)} \dots \hat{\mathbf{h}}_M^{(3)} \right]\]</div>
<p>The resulting channel estimation error variances are the diagonal coefficients of the matrices</p>
<div class="math notranslate nohighlight">
\[\mathbf{\Sigma}^{(3)}_m = \mathbf{R^{(t)}} - \mathbf{B}_m \tilde{\mathbf{\Xi}}_m \mathbf{R^{(t)}}, 1 \leq m \leq M\]</div>
<p>where <span class="math notranslate nohighlight">\(\tilde{\mathbf{\Xi}}_m\)</span> is the diagonal matrix of size <span class="math notranslate nohighlight">\(N \times N\)</span> that zeros the
columns corresponding to OFDM symbols not carrying any pilots.</p>
<p><strong>Remark</strong>: The interpolation matrix differs across sub-carriers as different
sub-carriers may have different estimation error variances computed by the first
pass.
However, all sub-carriers carry at least one channel estimate as a result of
the first pass, ensuring that a channel estimate is computed for all the resource
elements after the second pass.</p>
<p><strong>Remark:</strong> LMMSE interpolation requires knowledge of the time and frequency
covariance matrices of the channel. The notebook <a class="reference internal" href="../examples/OFDM_MIMO_Detection.html"><span class="doc">OFDM MIMO Channel Estimation and Detection</span></a> shows how to estimate
such matrices for arbitrary channel models.
Moreover, the functions <a class="reference internal" href="#sionna.ofdm.tdl_time_cov_mat" title="sionna.ofdm.tdl_time_cov_mat"><code class="xref py py-func docutils literal notranslate"><span class="pre">tdl_time_cov_mat()</span></code></a>
and <a class="reference internal" href="#sionna.ofdm.tdl_freq_cov_mat" title="sionna.ofdm.tdl_freq_cov_mat"><code class="xref py py-func docutils literal notranslate"><span class="pre">tdl_freq_cov_mat()</span></code></a> compute the expected time and frequency
covariance matrices, respectively, for the <a class="reference internal" href="channel.wireless.html#sionna.channel.tr38901.TDL" title="sionna.channel.tr38901.TDL"><code class="xref py py-class docutils literal notranslate"><span class="pre">TDL</span></code></a> channel models.</p>
<p>Scaling of the estimates is then performed to ensure that their
variances match the ones expected by the next smoothing step, and the
error variances are updated accordingly:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
    \left[\hat{\mathbf{h}}_m^{(4)}\right]_n &amp;= \gamma_{m,n} \left[\hat{\mathbf{h}}_m^{(3)}\right]_n\\
    \left[\mathbf{\Sigma}^{(4)}_m\right]_{n,n}  &amp;= \gamma_{m,n}\left( \gamma_{m,n}-1 \right) \left[\hat{\mathbf{\Sigma}}^{(3)}_m\right]_{n,n} + \left( 1 - \gamma_{m,n} \right) \left[\mathbf{R^{(t)}}\right]_{n,n} + \gamma_{m,n} \left[\mathbf{\Sigma}^{(3)}_n\right]_{m,m}
\end{align}\end{split}\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
    \gamma_{m,n} &amp;= \frac{2 \left[\mathbf{R^{(t)}}\right]_{n,n}}{\left[\mathbf{R^{(t)}}\right]_{n,n} - \left[\mathbf{\Sigma}^{(3)}_m\right]_{n,n} + \left[\hat{\mathbf{\Sigma}}^{(3)}_n\right]_{m,m}}\\
    \hat{\mathbf{\Sigma}}^{(3)}_m &amp;= \mathbf{B}_m \mathbf{R^{(t)}} \mathbf{B}_m^{\mathrm{H}}
\end{align}\end{split}\]</div>
<p>Finally, a spatial smoothing step is applied to every resource element carrying
a channel estimate.
For clarity, we drop the resource element indexing <span class="math notranslate nohighlight">\((n,m)\)</span>.
We denote by <span class="math notranslate nohighlight">\(L\)</span> the number of receive antennas, and by
<span class="math notranslate nohighlight">\(\mathbf{R^{(s)}}\in\mathbb{C}^{L \times L}\)</span> the spatial covariance matrix.</p>
<p>LMMSE spatial smoothing consists in the following computations:</p>
<div class="math notranslate nohighlight">
\[\hat{\mathbf{h}}^{(5)} = \mathbf{C} \hat{\mathbf{h}}^{(4)}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\mathbf{C} = \mathbf{R^{(s)}} \left( \mathbf{R^{(s)}} + \mathbf{\Sigma}^{(4)} \right)^{-1}.\]</div>
<p>The estimation error variances are the digonal coefficients of</p>
<div class="math notranslate nohighlight">
\[\mathbf{\Sigma}^{(5)} = \mathbf{R^{(s)}} - \mathbf{C}\mathbf{R^{(s)}}\]</div>
<p>The smoothed channel estimate <span class="math notranslate nohighlight">\(\hat{\mathbf{h}}^{(5)}\)</span> and corresponding
error variances <span class="math notranslate nohighlight">\(\text{diag}\left( \mathbf{\Sigma}^{(5)} \right)\)</span> are
returned for every resource element <span class="math notranslate nohighlight">\((m,n)\)</span>.</p>
<p><strong>Remark:</strong> No scaling is performed after the last interpolation or smoothing
step.</p>
<p><strong>Remark:</strong> All passes assume that the estimation error covariance matrix
(<span class="math notranslate nohighlight">\(\mathbf{\Sigma}\)</span>, <span class="math notranslate nohighlight">\(\tilde{\mathbf{\Sigma}}^{(2)}\)</span>, or <span class="math notranslate nohighlight">\(\tilde{\mathbf{\Sigma}}^{(4)}\)</span>) is diagonal, which
may not be accurate. When this assumption does not hold, this interpolator is only
an approximation of LMMSE interpolation.</p>
<p><strong>Remark:</strong> The order in which frequency interpolation, temporal
interpolation, and, optionally, spatial smoothing are applied, is controlled using the
<code class="docutils literal notranslate"><span class="pre">order</span></code> parameter.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This layer does not support graph mode with XLA.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pilot_pattern</strong> (<a class="reference internal" href="#sionna.ofdm.PilotPattern" title="sionna.ofdm.PilotPattern"><em>PilotPattern</em></a>) – An instance of <a class="reference internal" href="#sionna.ofdm.PilotPattern" title="sionna.ofdm.PilotPattern"><code class="xref py py-class docutils literal notranslate"><span class="pre">PilotPattern</span></code></a></p></li>
<li><p><strong>cov_mat_time</strong> (<em>[</em><em>num_ofdm_symbols</em><em>, </em><em>num_ofdm_symbols</em><em>]</em><em>, </em><em>tf.complex</em>) – Time covariance matrix of the channel</p></li>
<li><p><strong>cov_mat_freq</strong> (<em>[</em><em>fft_size</em><em>, </em><em>fft_size</em><em>]</em><em>, </em><em>tf.complex</em>) – Frequency covariance matrix of the channel</p></li>
<li><p><strong>cov_time_space</strong> (<em>[</em><em>num_rx_ant</em><em>, </em><em>num_rx_ant</em><em>]</em><em>, </em><em>tf.complex</em>) – Spatial covariance matrix of the channel.
Defaults to <cite>None</cite>.
Only required if spatial smoothing is requested (see <code class="docutils literal notranslate"><span class="pre">order</span></code>).</p></li>
<li><p><strong>order</strong> (<em>str</em>) – Order in which to perform interpolation and optional smoothing.
For example, <code class="docutils literal notranslate"><span class="pre">&quot;t-f-s&quot;</span></code> means that interpolation across the OFDM symbols
is performed first (<code class="docutils literal notranslate"><span class="pre">&quot;t&quot;</span></code>: time), followed by interpolation across the
sub-carriers (<code class="docutils literal notranslate"><span class="pre">&quot;f&quot;</span></code>: frequency), and finally smoothing across the
receive antennas (<code class="docutils literal notranslate"><span class="pre">&quot;s&quot;</span></code>: space).
Similarly, <code class="docutils literal notranslate"><span class="pre">&quot;f-t&quot;</span></code> means interpolation across the sub-carriers followed
by interpolation across the OFDM symbols and no spatial smoothing.
The spatial covariance matrix (<code class="docutils literal notranslate"><span class="pre">cov_time_space</span></code>) is only required when
spatial smoothing is requested.
Time and frequency interpolation are not optional to ensure that a channel
estimate is computed for all resource elements.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_pilot_symbols], tf.complex</em>) – Channel estimates for the pilot-carrying resource elements</p></li>
<li><p><strong>err_var</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_pilot_symbols], tf.complex</em>) – Channel estimation error variances for the pilot-carrying resource elements</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_ofdm_symbols, fft_size], tf.complex</em>) – Channel estimates accross the entire resource grid for all
transmitters and streams</p></li>
<li><p><strong>err_var</strong> (Same shape as <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>, tf.float) – Channel estimation error variances accross the entire resource grid
for all transmitters and streams</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="nearestneighborinterpolator">
<h3>NearestNeighborInterpolator<a class="headerlink" href="#nearestneighborinterpolator" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.NearestNeighborInterpolator">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">NearestNeighborInterpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pilot_pattern</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/channel_estimation.html#NearestNeighborInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.NearestNeighborInterpolator" title="Permalink to this definition"></a></dt>
<dd><p>Nearest-neighbor channel estimate interpolation on a resource grid.</p>
<p>This class assigns to each element of an OFDM resource grid one of
<code class="docutils literal notranslate"><span class="pre">num_pilots</span></code> provided channel estimates and error
variances according to the nearest neighbor method. It is assumed
that the measurements were taken at the nonzero positions of a
<a class="reference internal" href="#sionna.ofdm.PilotPattern" title="sionna.ofdm.PilotPattern"><code class="xref py py-class docutils literal notranslate"><span class="pre">PilotPattern</span></code></a>.</p>
<p>The figure below shows how four channel estimates are interpolated
accross a resource grid. Grey fields indicate measurement positions
while the colored regions show which resource elements are assigned
to the same measurement value.</p>
<img alt="../_images/nearest_neighbor_interpolation.png" src="../_images/nearest_neighbor_interpolation.png" />
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pilot_pattern</strong> (<a class="reference internal" href="#sionna.ofdm.PilotPattern" title="sionna.ofdm.PilotPattern"><em>PilotPattern</em></a>) – An instance of <a class="reference internal" href="#sionna.ofdm.PilotPattern" title="sionna.ofdm.PilotPattern"><code class="xref py py-class docutils literal notranslate"><span class="pre">PilotPattern</span></code></a></p>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_pilot_symbols], tf.complex</em>) – Channel estimates for the pilot-carrying resource elements</p></li>
<li><p><strong>err_var</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_pilot_symbols], tf.complex</em>) – Channel estimation error variances for the pilot-carrying resource elements</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_ofdm_symbols, fft_size], tf.complex</em>) – Channel estimates accross the entire resource grid for all
transmitters and streams</p></li>
<li><p><strong>err_var</strong> (Same shape as <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>, tf.float) – Channel estimation error variances accross the entire resource grid
for all transmitters and streams</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="tdl-time-cov-mat">
<h3>tdl_time_cov_mat<a class="headerlink" href="#tdl-time-cov-mat" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="sionna.ofdm.tdl_time_cov_mat">
<span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">tdl_time_cov_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">carrier_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofdm_symbol_duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ofdm_symbols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">los_angle_of_arrival</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7853981633974483</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/channel_estimation.html#tdl_time_cov_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.tdl_time_cov_mat" title="Permalink to this definition"></a></dt>
<dd><p>Computes the time covariance matrix of a
<a class="reference internal" href="channel.wireless.html#sionna.channel.tr38901.TDL" title="sionna.channel.tr38901.TDL"><code class="xref py py-class docutils literal notranslate"><span class="pre">TDL</span></code></a> channel model.</p>
<p>For non-line-of-sight (NLoS) model, the channel time covariance matrix
<span class="math notranslate nohighlight">\(\mathbf{R^{(t)}}\)</span> of a TDL channel model is</p>
<div class="math notranslate nohighlight">
\[\mathbf{R^{(t)}}_{u,v} = J_0 \left( \nu \Delta_t \left( u-v \right) \right)\]</div>
<p>where <span class="math notranslate nohighlight">\(J_0\)</span> is the zero-order Bessel function of the first kind,
<span class="math notranslate nohighlight">\(\Delta_t\)</span> the duration of an OFDM symbol, and <span class="math notranslate nohighlight">\(\nu\)</span> the Doppler
spread defined by</p>
<div class="math notranslate nohighlight">
\[\nu = 2 \pi \frac{v}{c} f_c\]</div>
<p>where <span class="math notranslate nohighlight">\(v\)</span> is the movement speed, <span class="math notranslate nohighlight">\(c\)</span> the speed of light, and
<span class="math notranslate nohighlight">\(f_c\)</span> the carrier frequency.</p>
<p>For line-of-sight (LoS) channel models, the channel time covariance matrix
is</p>
<div class="math notranslate nohighlight">
\[\mathbf{R^{(t)}}_{u,v} = P_{\text{NLoS}} J_0 \left( \nu \Delta_t \left( u-v \right) \right) + P_{\text{LoS}}e^{j \nu \Delta_t \left( u-v \right) \cos{\alpha_{\text{LoS}}}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha_{\text{LoS}}\)</span> is the angle-of-arrival for the LoS path,
<span class="math notranslate nohighlight">\(P_{\text{NLoS}}\)</span> the total power of NLoS paths, and
<span class="math notranslate nohighlight">\(P_{\text{LoS}}\)</span> the power of the LoS path. The power delay profile
is assumed to have unit power, i.e., <span class="math notranslate nohighlight">\(P_{\text{NLoS}} + P_{\text{LoS}} = 1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>str</em>) – TDL model for which to return the covariance matrix.
Should be one of “A”, “B”, “C”, “D”, or “E”.</p></li>
<li><p><strong>speed</strong> (<em>float</em>) – Speed [m/s]</p></li>
<li><p><strong>carrier_frequency</strong> (<em>float</em>) – Carrier frequency [Hz]</p></li>
<li><p><strong>ofdm_symbol_duration</strong> (<em>float</em>) – Duration of an OFDM symbol [s]</p></li>
<li><p><strong>num_ofdm_symbols</strong> (<em>int</em>) – Number of OFDM symbols</p></li>
<li><p><strong>los_angle_of_arrival</strong> (<em>float</em>) – Angle-of-arrival for LoS path [radian]. Only used with LoS models.
Defaults to <span class="math notranslate nohighlight">\(\pi/4\)</span>.</p></li>
<li><p><strong>dtype</strong> (<em>tf.DType</em>) – Datatype to use for the output.
Should be one of <cite>tf.complex64</cite> or <cite>tf.complex128</cite>.
Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p><strong>cov_mat</strong> (<em>[num_ofdm_symbols, num_ofdm_symbols], tf.complex</em>) – Channel time covariance matrix</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="tdl-freq-cov-mat">
<h3>tdl_freq_cov_mat<a class="headerlink" href="#tdl-freq-cov-mat" title="Permalink to this headline"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="sionna.ofdm.tdl_freq_cov_mat">
<span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">tdl_freq_cov_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subcarrier_spacing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delay_spread</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/channel_estimation.html#tdl_freq_cov_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.tdl_freq_cov_mat" title="Permalink to this definition"></a></dt>
<dd><p>Computes the frequency covariance matrix of a
<a class="reference internal" href="channel.wireless.html#sionna.channel.tr38901.TDL" title="sionna.channel.tr38901.TDL"><code class="xref py py-class docutils literal notranslate"><span class="pre">TDL</span></code></a> channel model.</p>
<p>The channel frequency covariance matrix <span class="math notranslate nohighlight">\(\mathbf{R}^{(f)}\)</span> of a TDL channel model is</p>
<div class="math notranslate nohighlight">
\[\mathbf{R}^{(f)}_{u,v} = \sum_{\ell=1}^L P_\ell e^{-j 2 \pi \tau_\ell \Delta_f (u-v)}, 1 \leq u,v \leq M\]</div>
<p>where <span class="math notranslate nohighlight">\(M\)</span> is the FFT size, <span class="math notranslate nohighlight">\(L\)</span> is the number of paths for the selected TDL model,
<span class="math notranslate nohighlight">\(P_\ell\)</span> and <span class="math notranslate nohighlight">\(\tau_\ell\)</span> are the average power and delay for the
<span class="math notranslate nohighlight">\(\ell^{\text{th}}\)</span> path, respectively, and <span class="math notranslate nohighlight">\(\Delta_f\)</span> is the sub-carrier spacing.</p>
<dl class="field-list simple">
<dt class="field-odd">Input</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>str</em>) – TDL model for which to return the covariance matrix.
Should be one of “A”, “B”, “C”, “D”, or “E”.</p></li>
<li><p><strong>subcarrier_spacing</strong> (<em>float</em>) – Sub-carrier spacing [Hz]</p></li>
<li><p><strong>fft_size</strong> (<em>float</em>) – FFT size</p></li>
<li><p><strong>delay_spread</strong> (<em>float</em>) – Delay spread [s]</p></li>
<li><p><strong>dtype</strong> (<em>tf.DType</em>) – Datatype to use for the output.
Should be one of <cite>tf.complex64</cite> or <cite>tf.complex128</cite>.
Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p><strong>cov_mat</strong> (<em>[fft_size, fft_size], tf.complex</em>) – Channel frequency covariance matrix</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="precoding">
<h2>Precoding<a class="headerlink" href="#precoding" title="Permalink to this headline"></a></h2>
<div class="section" id="zfprecoder">
<h3>ZFPrecoder<a class="headerlink" href="#zfprecoder" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.ZFPrecoder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">ZFPrecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_management</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_effective_channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/precoding.html#ZFPrecoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.ZFPrecoder" title="Permalink to this definition"></a></dt>
<dd><p>Zero-forcing precoding for multi-antenna transmissions.</p>
<p>This layer precodes a tensor containing OFDM resource grids using
the <a class="reference internal" href="mimo.html#sionna.mimo.zero_forcing_precoder" title="sionna.mimo.zero_forcing_precoder"><code class="xref py py-meth docutils literal notranslate"><span class="pre">zero_forcing_precoder()</span></code></a>. For every
transmitter, the channels to all intended receivers are gathered
into a channel matrix, based on the which the precoding matrix
is computed and the input tensor is precoded. The layer also outputs
optionally the effective channel after precoding for each stream.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resource_grid</strong> (<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><em>ResourceGrid</em></a>) – An instance of <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>.</p></li>
<li><p><strong>stream_management</strong> (<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><em>StreamManagement</em></a>) – An instance of <a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a>.</p></li>
<li><p><strong>return_effective_channel</strong> (<em>bool</em>) – Indicates if the effective channel after precoding should be returned.</p></li>
<li><p><strong>dtype</strong> (<em>tf.Dtype</em>) – Datatype for internal calculations and the output dtype.
Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(x, h)</strong> – Tuple:</p></li>
<li><p><strong>x</strong> (<em>[batch_size, num_tx, num_streams_per_tx, num_ofdm_symbols, fft_size], tf.complex</em>) – Tensor containing the resource grid to be precoded.</p></li>
<li><p><strong>h</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_tx_ant, num_ofdm, fft_size], tf.complex</em>) – Tensor containing the channel knowledge based on which the precoding
is computed.</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_precoded</strong> (<em>[batch_size, num_tx, num_tx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – The precoded resource grids.</p></li>
<li><p><strong>h_eff</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_ofdm, num_effective_subcarriers], tf.complex</em>) – Only returned if <code class="docutils literal notranslate"><span class="pre">return_effective_channel=True</span></code>.
The effectice channels for all streams after precoding. Can be used to
simulate perfect channel state information (CSI) at the receivers.
Nulled subcarriers are automatically removed to be compliant with the
behavior of a channel estimator.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to use this layer in Graph mode with XLA, i.e., within
a function that is decorated with <code class="docutils literal notranslate"><span class="pre">&#64;tf.function(jit_compile=True)</span></code>,
you must set <code class="docutils literal notranslate"><span class="pre">sionna.Config.xla_compat=true</span></code>.
See <a class="reference internal" href="config.html#sionna.Config.xla_compat" title="sionna.Config.xla_compat"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xla_compat</span></code></a>.</p>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="equalization">
<h2>Equalization<a class="headerlink" href="#equalization" title="Permalink to this headline"></a></h2>
<div class="section" id="ofdmequalizer">
<h3>OFDMEqualizer<a class="headerlink" href="#ofdmequalizer" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.OFDMEqualizer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">OFDMEqualizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equalizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_management</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/equalization.html#OFDMEqualizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.OFDMEqualizer" title="Permalink to this definition"></a></dt>
<dd><p>Layer that wraps a MIMO equalizer for use with the OFDM waveform.</p>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">equalizer</span></code> is a callable (e.g., a function) that
implements a MIMO equalization algorithm for arbitrary batch dimensions.</p>
<p>This class pre-processes the received resource grid <code class="docutils literal notranslate"><span class="pre">y</span></code> and channel
estimate <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>, and computes for each receiver the
noise-plus-interference covariance matrix according to the OFDM and stream
configuration provided by the <code class="docutils literal notranslate"><span class="pre">resource_grid</span></code> and
<code class="docutils literal notranslate"><span class="pre">stream_management</span></code>, which also accounts for the channel
estimation error variance <code class="docutils literal notranslate"><span class="pre">err_var</span></code>. These quantities serve as input
to the equalization algorithm that is implemented by the callable <code class="docutils literal notranslate"><span class="pre">equalizer</span></code>.
This layer computes soft-symbol estimates together with effective noise
variances for all streams which can, e.g., be used by a
<a class="reference internal" href="mapping.html#sionna.mapping.Demapper" title="sionna.mapping.Demapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Demapper</span></code></a> to obtain LLRs.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The callable <code class="docutils literal notranslate"><span class="pre">equalizer</span></code> must take three inputs:</p>
<ul class="simple">
<li><p><strong>y</strong> ([…,num_rx_ant], tf.complex) – 1+D tensor containing the received signals.</p></li>
<li><p><strong>h</strong> ([…,num_rx_ant,num_streams_per_rx], tf.complex) – 2+D tensor containing the channel matrices.</p></li>
<li><p><strong>s</strong> ([…,num_rx_ant,num_rx_ant], tf.complex) – 2+D tensor containing the noise-plus-interference covariance matrices.</p></li>
</ul>
<p>It must generate two outputs:</p>
<ul class="simple">
<li><p><strong>x_hat</strong> ([…,num_streams_per_rx], tf.complex) – 1+D tensor representing the estimated symbol vectors.</p></li>
<li><p><strong>no_eff</strong> (tf.float) – Tensor of the same shape as <code class="docutils literal notranslate"><span class="pre">x_hat</span></code> containing the effective noise variance estimates.</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equalizer</strong> (<em>Callable</em>) – Callable object (e.g., a function) that implements a MIMO equalization
algorithm for arbitrary batch dimensions</p></li>
<li><p><strong>resource_grid</strong> (<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><em>ResourceGrid</em></a>) – Instance of <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a></p></li>
<li><p><strong>stream_management</strong> (<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><em>StreamManagement</em></a>) – Instance of <a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a></p></li>
<li><p><strong>dtype</strong> (<em>tf.Dtype</em>) – Datatype for internal calculations and the output dtype.
Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(y, h_hat, err_var, no)</strong> – Tuple:</p></li>
<li><p><strong>y</strong> (<em>[batch_size, num_rx, num_rx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – Received OFDM resource grid after cyclic prefix removal and FFT</p></li>
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_ofdm_symbols, num_effective_subcarriers], tf.complex</em>) – Channel estimates for all streams from all transmitters</p></li>
<li><p><strong>err_var</strong> ([Broadcastable to shape of <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>], tf.float) – Variance of the channel estimation error</p></li>
<li><p><strong>no</strong> (<em>[batch_size, num_rx, num_rx_ant] (or only the first n dims), tf.float</em>) – Variance of the AWGN</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_hat</strong> (<em>[batch_size, num_tx, num_streams, num_data_symbols], tf.complex</em>) – Estimated symbols</p></li>
<li><p><strong>no_eff</strong> (<em>[batch_size, num_tx, num_streams, num_data_symbols], tf.float</em>) – Effective noise variance for each estimated symbol</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="lmmseequalizer">
<h3>LMMSEEqualizer<a class="headerlink" href="#lmmseequalizer" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.LMMSEEqualizer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">LMMSEEqualizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_management</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whiten_interference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/equalization.html#LMMSEEqualizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.LMMSEEqualizer" title="Permalink to this definition"></a></dt>
<dd><p>LMMSE equalization for OFDM MIMO transmissions.</p>
<p>This layer computes linear minimum mean squared error (LMMSE) equalization
for OFDM MIMO transmissions. The OFDM and stream configuration are provided
by a <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a> and
<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a> instance, respectively. The
detection algorithm is the <a class="reference internal" href="mimo.html#sionna.mimo.lmmse_equalizer" title="sionna.mimo.lmmse_equalizer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lmmse_equalizer()</span></code></a>. The layer
computes soft-symbol estimates together with effective noise variances
for all streams which can, e.g., be used by a
<a class="reference internal" href="mapping.html#sionna.mapping.Demapper" title="sionna.mapping.Demapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Demapper</span></code></a> to obtain LLRs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resource_grid</strong> (<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><em>ResourceGrid</em></a>) – Instance of <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a></p></li>
<li><p><strong>stream_management</strong> (<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><em>StreamManagement</em></a>) – Instance of <a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a></p></li>
<li><p><strong>whiten_interference</strong> (<em>bool</em>) – If <cite>True</cite> (default), the interference is first whitened before equalization.
In this case, an alternative expression for the receive filter is used which
can be numerically more stable.</p></li>
<li><p><strong>dtype</strong> (<em>tf.Dtype</em>) – Datatype for internal calculations and the output dtype.
Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(y, h_hat, err_var, no)</strong> – Tuple:</p></li>
<li><p><strong>y</strong> (<em>[batch_size, num_rx, num_rx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – Received OFDM resource grid after cyclic prefix removal and FFT</p></li>
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_ofdm_symbols, num_effective_subcarriers], tf.complex</em>) – Channel estimates for all streams from all transmitters</p></li>
<li><p><strong>err_var</strong> ([Broadcastable to shape of <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>], tf.float) – Variance of the channel estimation error</p></li>
<li><p><strong>no</strong> (<em>[batch_size, num_rx, num_rx_ant] (or only the first n dims), tf.float</em>) – Variance of the AWGN</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_hat</strong> (<em>[batch_size, num_tx, num_streams, num_data_symbols], tf.complex</em>) – Estimated symbols</p></li>
<li><p><strong>no_eff</strong> (<em>[batch_size, num_tx, num_streams, num_data_symbols], tf.float</em>) – Effective noise variance for each estimated symbol</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to use this layer in Graph mode with XLA, i.e., within
a function that is decorated with <code class="docutils literal notranslate"><span class="pre">&#64;tf.function(jit_compile=True)</span></code>,
you must set <code class="docutils literal notranslate"><span class="pre">sionna.Config.xla_compat=true</span></code>.
See <a class="reference internal" href="config.html#sionna.Config.xla_compat" title="sionna.Config.xla_compat"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xla_compat</span></code></a>.</p>
</div>
</dd></dl>

</div>
<div class="section" id="mfequalizer">
<h3>MFEqualizer<a class="headerlink" href="#mfequalizer" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.MFEqualizer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">MFEqualizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_management</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/equalization.html#MFEqualizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.MFEqualizer" title="Permalink to this definition"></a></dt>
<dd><p>MF equalization for OFDM MIMO transmissions.</p>
<p>This layer computes matched filter (MF) equalization
for OFDM MIMO transmissions. The OFDM and stream configuration are provided
by a <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a> and
<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a> instance, respectively. The
detection algorithm is the <a class="reference internal" href="mimo.html#sionna.mimo.mf_equalizer" title="sionna.mimo.mf_equalizer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mf_equalizer()</span></code></a>. The layer
computes soft-symbol estimates together with effective noise variances
for all streams which can, e.g., be used by a
<a class="reference internal" href="mapping.html#sionna.mapping.Demapper" title="sionna.mapping.Demapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Demapper</span></code></a> to obtain LLRs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resource_grid</strong> (<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><em>ResourceGrid</em></a>) – An instance of <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>.</p></li>
<li><p><strong>stream_management</strong> (<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><em>StreamManagement</em></a>) – An instance of <a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a>.</p></li>
<li><p><strong>dtype</strong> (<em>tf.Dtype</em>) – Datatype for internal calculations and the output dtype.
Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(y, h_hat, err_var, no)</strong> – Tuple:</p></li>
<li><p><strong>y</strong> (<em>[batch_size, num_rx, num_rx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – Received OFDM resource grid after cyclic prefix removal and FFT</p></li>
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_ofdm_symbols, num_effective_subcarriers], tf.complex</em>) – Channel estimates for all streams from all transmitters</p></li>
<li><p><strong>err_var</strong> ([Broadcastable to shape of <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>], tf.float) – Variance of the channel estimation error</p></li>
<li><p><strong>no</strong> (<em>[batch_size, num_rx, num_rx_ant] (or only the first n dims), tf.float</em>) – Variance of the AWGN</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_hat</strong> (<em>[batch_size, num_tx, num_streams, num_data_symbols], tf.complex</em>) – Estimated symbols</p></li>
<li><p><strong>no_eff</strong> (<em>[batch_size, num_tx, num_streams, num_data_symbols], tf.float</em>) – Effective noise variance for each estimated symbol</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to use this layer in Graph mode with XLA, i.e., within
a function that is decorated with <code class="docutils literal notranslate"><span class="pre">&#64;tf.function(jit_compile=True)</span></code>,
you must set <code class="docutils literal notranslate"><span class="pre">sionna.Config.xla_compat=true</span></code>.
See <a class="reference internal" href="config.html#sionna.Config.xla_compat" title="sionna.Config.xla_compat"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xla_compat</span></code></a>.</p>
</div>
</dd></dl>

</div>
<div class="section" id="zfequalizer">
<h3>ZFEqualizer<a class="headerlink" href="#zfequalizer" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.ZFEqualizer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">ZFEqualizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_management</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/equalization.html#ZFEqualizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.ZFEqualizer" title="Permalink to this definition"></a></dt>
<dd><p>ZF equalization for OFDM MIMO transmissions.</p>
<p>This layer computes zero-forcing (ZF) equalization
for OFDM MIMO transmissions. The OFDM and stream configuration are provided
by a <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a> and
<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a> instance, respectively. The
detection algorithm is the <a class="reference internal" href="mimo.html#sionna.mimo.zf_equalizer" title="sionna.mimo.zf_equalizer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">zf_equalizer()</span></code></a>. The layer
computes soft-symbol estimates together with effective noise variances
for all streams which can, e.g., be used by a
<a class="reference internal" href="mapping.html#sionna.mapping.Demapper" title="sionna.mapping.Demapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Demapper</span></code></a> to obtain LLRs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resource_grid</strong> (<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><em>ResourceGrid</em></a>) – An instance of <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a>.</p></li>
<li><p><strong>stream_management</strong> (<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><em>StreamManagement</em></a>) – An instance of <a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a>.</p></li>
<li><p><strong>dtype</strong> (<em>tf.Dtype</em>) – Datatype for internal calculations and the output dtype.
Defaults to <cite>tf.complex64</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(y, h_hat, err_var, no)</strong> – Tuple:</p></li>
<li><p><strong>y</strong> (<em>[batch_size, num_rx, num_rx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – Received OFDM resource grid after cyclic prefix removal and FFT</p></li>
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_ofdm_symbols, num_effective_subcarriers], tf.complex</em>) – Channel estimates for all streams from all transmitters</p></li>
<li><p><strong>err_var</strong> ([Broadcastable to shape of <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>], tf.float) – Variance of the channel estimation error</p></li>
<li><p><strong>no</strong> (<em>[batch_size, num_rx, num_rx_ant] (or only the first n dims), tf.float</em>) – Variance of the AWGN</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_hat</strong> (<em>[batch_size, num_tx, num_streams, num_data_symbols], tf.complex</em>) – Estimated symbols</p></li>
<li><p><strong>no_eff</strong> (<em>[batch_size, num_tx, num_streams, num_data_symbols], tf.float</em>) – Effective noise variance for each estimated symbol</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to use this layer in Graph mode with XLA, i.e., within
a function that is decorated with <code class="docutils literal notranslate"><span class="pre">&#64;tf.function(jit_compile=True)</span></code>,
you must set <code class="docutils literal notranslate"><span class="pre">sionna.Config.xla_compat=true</span></code>.
See <a class="reference internal" href="config.html#sionna.Config.xla_compat" title="sionna.Config.xla_compat"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xla_compat</span></code></a>.</p>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="detection">
<h2>Detection<a class="headerlink" href="#detection" title="Permalink to this headline"></a></h2>
<div class="section" id="ofdmdetector">
<h3>OFDMDetector<a class="headerlink" href="#ofdmdetector" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.OFDMDetector">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">OFDMDetector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">detector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_management</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/detection.html#OFDMDetector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.OFDMDetector" title="Permalink to this definition"></a></dt>
<dd><p>Layer that wraps a MIMO detector for use with the OFDM waveform.</p>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">detector</span></code> is a callable (e.g., a function) that
implements a MIMO detection algorithm for arbitrary batch dimensions.</p>
<p>This class pre-processes the received resource grid <code class="docutils literal notranslate"><span class="pre">y</span></code> and channel
estimate <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>, and computes for each receiver the
noise-plus-interference covariance matrix according to the OFDM and stream
configuration provided by the <code class="docutils literal notranslate"><span class="pre">resource_grid</span></code> and
<code class="docutils literal notranslate"><span class="pre">stream_management</span></code>, which also accounts for the channel
estimation error variance <code class="docutils literal notranslate"><span class="pre">err_var</span></code>. These quantities serve as input to the detection
algorithm that is implemented by <code class="docutils literal notranslate"><span class="pre">detector</span></code>.
Both detection of symbols or bits with either soft- or hard-decisions are supported.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The callable <code class="docutils literal notranslate"><span class="pre">detector</span></code> must take as input a tuple <span class="math notranslate nohighlight">\((\mathbf{y}, \mathbf{h}, \mathbf{s})\)</span> such that:</p>
<ul class="simple">
<li><p><strong>y</strong> ([…,num_rx_ant], tf.complex) – 1+D tensor containing the received signals.</p></li>
<li><p><strong>h</strong> ([…,num_rx_ant,num_streams_per_rx], tf.complex) – 2+D tensor containing the channel matrices.</p></li>
<li><p><strong>s</strong> ([…,num_rx_ant,num_rx_ant], tf.complex) – 2+D tensor containing the noise-plus-interference covariance matrices.</p></li>
</ul>
<p>It must generate one of following outputs depending on the value of <code class="docutils literal notranslate"><span class="pre">output</span></code>:</p>
<ul class="simple">
<li><p><strong>b_hat</strong> ([…, num_streams_per_rx, num_bits_per_symbol], tf.float) – LLRs or hard-decisions for every bit of every stream, if <code class="docutils literal notranslate"><span class="pre">output</span></code> equals <cite>“bit”</cite>.</p></li>
<li><p><strong>x_hat</strong> ([…, num_streams_per_rx, num_points], tf.float) or ([…, num_streams_per_rx], tf.int) – Logits or hard-decisions for constellation symbols for every stream, if <code class="docutils literal notranslate"><span class="pre">output</span></code> equals <cite>“symbol”</cite>. Hard-decisions correspond to the symbol indices.</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>detector</strong> (<em>Callable</em>) – Callable object (e.g., a function) that implements a MIMO detection
algorithm for arbitrary batch dimensions. Either one of the existing detectors, e.g.,
<a class="reference internal" href="mimo.html#sionna.mimo.LinearDetector" title="sionna.mimo.LinearDetector"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearDetector</span></code></a>, <a class="reference internal" href="mimo.html#sionna.mimo.MaximumLikelihoodDetector" title="sionna.mimo.MaximumLikelihoodDetector"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaximumLikelihoodDetector</span></code></a>, or
<a class="reference internal" href="mimo.html#sionna.mimo.KBestDetector" title="sionna.mimo.KBestDetector"><code class="xref py py-class docutils literal notranslate"><span class="pre">KBestDetector</span></code></a> can be used, or a custom detector
callable provided that has the same input/output specification.</p></li>
<li><p><strong>output</strong> (<em>One of</em><em> [</em><em>&quot;bit&quot;</em><em>, </em><em>&quot;symbol&quot;</em><em>]</em><em>, </em><em>str</em>) – Type of output, either bits or symbols</p></li>
<li><p><strong>resource_grid</strong> (<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><em>ResourceGrid</em></a>) – Instance of <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a></p></li>
<li><p><strong>stream_management</strong> (<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><em>StreamManagement</em></a>) – Instance of <a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a></p></li>
<li><p><strong>dtype</strong> (<em>One of</em><em> [</em><em>tf.complex64</em><em>, </em><em>tf.complex128</em><em>] </em><em>tf.DType</em><em> (</em><em>dtype</em><em>)</em>) – The dtype of <cite>y</cite>. Defaults to tf.complex64.
The output dtype is the corresponding real dtype (tf.float32 or tf.float64).</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(y, h_hat, err_var, no)</strong> – Tuple:</p></li>
<li><p><strong>y</strong> (<em>[batch_size, num_rx, num_rx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – Received OFDM resource grid after cyclic prefix removal and FFT</p></li>
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_ofdm_symbols, num_effective_subcarriers], tf.complex</em>) – Channel estimates for all streams from all transmitters</p></li>
<li><p><strong>err_var</strong> ([Broadcastable to shape of <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>], tf.float) – Variance of the channel estimation error</p></li>
<li><p><strong>no</strong> (<em>[batch_size, num_rx, num_rx_ant] (or only the first n dims), tf.float</em>) – Variance of the AWGN</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>One of</strong></p></li>
<li><p><em>[batch_size, num_tx, num_streams, num_data_symbols*num_bits_per_symbol], tf.float</em> – LLRs or hard-decisions for every bit of every stream, if <code class="docutils literal notranslate"><span class="pre">output</span></code> equals <cite>“bit”</cite></p></li>
<li><p><em>[batch_size, num_tx, num_streams, num_data_symbols, num_points], tf.float or [batch_size, num_tx, num_streams, num_data_symbols], tf.int</em> – Logits or hard-decisions for constellation symbols for every stream, if <code class="docutils literal notranslate"><span class="pre">output</span></code> equals <cite>“symbol”</cite>.
Hard-decisions correspond to the symbol indices.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="ofdmdetectorwithprior">
<h3>OFDMDetectorWithPrior<a class="headerlink" href="#ofdmdetectorwithprior" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.OFDMDetectorWithPrior">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">OFDMDetectorWithPrior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">detector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_management</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constellation_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bits_per_symbol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constellation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/detection.html#OFDMDetectorWithPrior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.OFDMDetectorWithPrior" title="Permalink to this definition"></a></dt>
<dd><p>Layer that wraps a MIMO detector that assumes prior knowledge of the bits or
constellation points is available, for use with the OFDM waveform.</p>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">detector</span></code> is a callable (e.g., a function) that
implements a MIMO detection algorithm with prior for arbitrary batch
dimensions.</p>
<p>This class pre-processes the received resource grid <code class="docutils literal notranslate"><span class="pre">y</span></code>, channel
estimate <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>, and the prior information <code class="docutils literal notranslate"><span class="pre">prior</span></code>, and computes for each receiver the
noise-plus-interference covariance matrix according to the OFDM and stream
configuration provided by the <code class="docutils literal notranslate"><span class="pre">resource_grid</span></code> and
<code class="docutils literal notranslate"><span class="pre">stream_management</span></code>, which also accounts for the channel
estimation error variance <code class="docutils literal notranslate"><span class="pre">err_var</span></code>. These quantities serve as input to the detection
algorithm that is implemented by <code class="docutils literal notranslate"><span class="pre">detector</span></code>.
Both detection of symbols or bits with either soft- or hard-decisions are supported.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The callable <code class="docutils literal notranslate"><span class="pre">detector</span></code> must take as input a tuple <span class="math notranslate nohighlight">\((\mathbf{y}, \mathbf{h}, \mathbf{prior}, \mathbf{s})\)</span> such that:</p>
<ul class="simple">
<li><p><strong>y</strong> ([…,num_rx_ant], tf.complex) – 1+D tensor containing the received signals.</p></li>
<li><p><strong>h</strong> ([…,num_rx_ant,num_streams_per_rx], tf.complex) – 2+D tensor containing the channel matrices.</p></li>
<li><p><strong>prior</strong> ([…,num_streams_per_rx,num_bits_per_symbol] or […,num_streams_per_rx,num_points], tf.float) – Prior for the transmitted signals. If <code class="docutils literal notranslate"><span class="pre">output</span></code> equals “bit”, then LLRs for the transmitted bits are expected. If <code class="docutils literal notranslate"><span class="pre">output</span></code> equals “symbol”, then logits for the transmitted constellation points are expected.</p></li>
<li><p><strong>s</strong> ([…,num_rx_ant,num_rx_ant], tf.complex) – 2+D tensor containing the noise-plus-interference covariance matrices.</p></li>
</ul>
<p>It must generate one of the following outputs depending on the value of <code class="docutils literal notranslate"><span class="pre">output</span></code>:</p>
<ul class="simple">
<li><p><strong>b_hat</strong> ([…, num_streams_per_rx, num_bits_per_symbol], tf.float) – LLRs or hard-decisions for every bit of every stream, if <code class="docutils literal notranslate"><span class="pre">output</span></code> equals <cite>“bit”</cite>.</p></li>
<li><p><strong>x_hat</strong> ([…, num_streams_per_rx, num_points], tf.float) or ([…, num_streams_per_rx], tf.int) – Logits or hard-decisions for constellation symbols for every stream, if <code class="docutils literal notranslate"><span class="pre">output</span></code> equals <cite>“symbol”</cite>. Hard-decisions correspond to the symbol indices.</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>detector</strong> (<em>Callable</em>) – Callable object (e.g., a function) that implements a MIMO detection
algorithm with prior for arbitrary batch dimensions. Either the existing detector
<a class="reference internal" href="mimo.html#sionna.mimo.MaximumLikelihoodDetectorWithPrior" title="sionna.mimo.MaximumLikelihoodDetectorWithPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaximumLikelihoodDetectorWithPrior</span></code></a> can be used, or a custom detector
callable provided that has the same input/output specification.</p></li>
<li><p><strong>output</strong> (<em>One of</em><em> [</em><em>&quot;bit&quot;</em><em>, </em><em>&quot;symbol&quot;</em><em>]</em><em>, </em><em>str</em>) – Type of output, either bits or symbols</p></li>
<li><p><strong>resource_grid</strong> (<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><em>ResourceGrid</em></a>) – Instance of <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a></p></li>
<li><p><strong>stream_management</strong> (<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><em>StreamManagement</em></a>) – Instance of <a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a></p></li>
<li><p><strong>constellation_type</strong> (<em>One of</em><em> [</em><em>&quot;qam&quot;</em><em>, </em><em>&quot;pam&quot;</em><em>, </em><em>&quot;custom&quot;</em><em>]</em><em>, </em><em>str</em>) – For “custom”, an instance of <a class="reference internal" href="mapping.html#sionna.mapping.Constellation" title="sionna.mapping.Constellation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constellation</span></code></a>
must be provided.</p></li>
<li><p><strong>num_bits_per_symbol</strong> (<em>int</em>) – Number of bits per constellation symbol, e.g., 4 for QAM16.
Only required for <code class="docutils literal notranslate"><span class="pre">constellation_type</span></code> in [“qam”, “pam”].</p></li>
<li><p><strong>constellation</strong> (<a class="reference internal" href="mapping.html#sionna.mapping.Constellation" title="sionna.mapping.Constellation"><em>Constellation</em></a>) – Instance of <a class="reference internal" href="mapping.html#sionna.mapping.Constellation" title="sionna.mapping.Constellation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constellation</span></code></a> or <cite>None</cite>.
In the latter case, <code class="docutils literal notranslate"><span class="pre">constellation_type</span></code>
and <code class="docutils literal notranslate"><span class="pre">num_bits_per_symbol</span></code> must be provided.</p></li>
<li><p><strong>dtype</strong> (<em>One of</em><em> [</em><em>tf.complex64</em><em>, </em><em>tf.complex128</em><em>] </em><em>tf.DType</em><em> (</em><em>dtype</em><em>)</em>) – The dtype of <cite>y</cite>. Defaults to tf.complex64.
The output dtype is the corresponding real dtype (tf.float32 or tf.float64).</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(y, h_hat, prior, err_var, no)</strong> – Tuple:</p></li>
<li><p><strong>y</strong> (<em>[batch_size, num_rx, num_rx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – Received OFDM resource grid after cyclic prefix removal and FFT</p></li>
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_ofdm_symbols, num_effective_subcarriers], tf.complex</em>) – Channel estimates for all streams from all transmitters</p></li>
<li><p><strong>prior</strong> (<em>[batch_size, num_tx, num_streams, num_data_symbols x num_bits_per_symbol] or [batch_size, num_tx, num_streams, num_data_symbols, num_points], tf.float</em>) – Prior of the transmitted signals.
If <code class="docutils literal notranslate"><span class="pre">output</span></code> equals “bit”, LLRs of the transmitted bits are expected.
If <code class="docutils literal notranslate"><span class="pre">output</span></code> equals “symbol”, logits of the transmitted constellation points are expected.</p></li>
<li><p><strong>err_var</strong> ([Broadcastable to shape of <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>], tf.float) – Variance of the channel estimation error</p></li>
<li><p><strong>no</strong> (<em>[batch_size, num_rx, num_rx_ant] (or only the first n dims), tf.float</em>) – Variance of the AWGN</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>One of</strong></p></li>
<li><p><em>[batch_size, num_tx, num_streams, num_data_symbols*num_bits_per_symbol], tf.float</em> – LLRs or hard-decisions for every bit of every stream, if <code class="docutils literal notranslate"><span class="pre">output</span></code> equals <cite>“bit”</cite>.</p></li>
<li><p><em>[batch_size, num_tx, num_streams, num_data_symbols, num_points], tf.float or [batch_size, num_tx, num_streams, num_data_symbols], tf.int</em> – Logits or hard-decisions for constellation symbols for every stream, if <code class="docutils literal notranslate"><span class="pre">output</span></code> equals <cite>“symbol”</cite>.
Hard-decisions correspond to the symbol indices.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="epdetector">
<h3>EPDetector<a class="headerlink" href="#epdetector" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.EPDetector">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">EPDetector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_management</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bits_per_symbol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hard_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/detection.html#EPDetector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.EPDetector" title="Permalink to this definition"></a></dt>
<dd><p>This layer wraps the MIMO EP detector for use with the OFDM waveform.</p>
<p>Both detection of symbols or bits with either
soft- or hard-decisions are supported. The OFDM and stream configuration are provided
by a <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a> and
<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a> instance, respectively. The
actual detector is an instance of <a class="reference internal" href="mimo.html#sionna.mimo.EPDetector" title="sionna.mimo.EPDetector"><code class="xref py py-class docutils literal notranslate"><span class="pre">EPDetector</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output</strong> (<em>One of</em><em> [</em><em>&quot;bit&quot;</em><em>, </em><em>&quot;symbol&quot;</em><em>]</em><em>, </em><em>str</em>) – Type of output, either bits or symbols. Whether soft- or
hard-decisions are returned can be configured with the
<code class="docutils literal notranslate"><span class="pre">hard_out</span></code> flag.</p></li>
<li><p><strong>resource_grid</strong> (<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><em>ResourceGrid</em></a>) – Instance of <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a></p></li>
<li><p><strong>stream_management</strong> (<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><em>StreamManagement</em></a>) – Instance of <a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a></p></li>
<li><p><strong>num_bits_per_symbol</strong> (<em>int</em>) – Number of bits per constellation symbol, e.g., 4 for QAM16.
Only required for <code class="docutils literal notranslate"><span class="pre">constellation_type</span></code> in [“qam”, “pam”].</p></li>
<li><p><strong>hard_out</strong> (<em>bool</em>) – If <cite>True</cite>, the detector computes hard-decided bit values or
constellation point indices instead of soft-values.
Defaults to <cite>False</cite>.</p></li>
<li><p><strong>l</strong> (<em>int</em>) – Number of iterations. Defaults to 10.</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – Parameter <span class="math notranslate nohighlight">\(\beta\in[0,1]\)</span> for update smoothing.
Defaults to 0.9.</p></li>
<li><p><strong>dtype</strong> (<em>One of</em><em> [</em><em>tf.complex64</em><em>, </em><em>tf.complex128</em><em>] </em><em>tf.DType</em><em> (</em><em>dtype</em><em>)</em>) – Precision used for internal computations. Defaults to <code class="docutils literal notranslate"><span class="pre">tf.complex64</span></code>.
Especially for large MIMO setups, the precision can make a significant
performance difference.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(y, h_hat, err_var, no)</strong> – Tuple:</p></li>
<li><p><strong>y</strong> (<em>[batch_size, num_rx, num_rx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – Received OFDM resource grid after cyclic prefix removal and FFT</p></li>
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_ofdm_symbols, num_effective_subcarriers], tf.complex</em>) – Channel estimates for all streams from all transmitters</p></li>
<li><p><strong>err_var</strong> ([Broadcastable to shape of <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>], tf.float) – Variance of the channel estimation error</p></li>
<li><p><strong>no</strong> (<em>[batch_size, num_rx, num_rx_ant] (or only the first n dims), tf.float</em>) – Variance of the AWGN</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>One of</strong></p></li>
<li><p><em>[batch_size, num_tx, num_streams, num_data_symbols*num_bits_per_symbol], tf.float</em> – LLRs or hard-decisions for every bit of every stream, if <code class="docutils literal notranslate"><span class="pre">output</span></code> equals <cite>“bit”</cite>.</p></li>
<li><p><em>[batch_size, num_tx, num_streams, num_data_symbols, num_points], tf.float or [batch_size, num_tx, num_streams, num_data_symbols], tf.int</em> – Logits or hard-decisions for constellation symbols for every stream, if <code class="docutils literal notranslate"><span class="pre">output</span></code> equals <cite>“symbol”</cite>.
Hard-decisions correspond to the symbol indices.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For numerical stability, we do not recommend to use this function in Graph
mode with XLA, i.e., within a function that is decorated with
<code class="docutils literal notranslate"><span class="pre">&#64;tf.function(jit_compile=True)</span></code>.
However, it is possible to do so by setting
<code class="docutils literal notranslate"><span class="pre">sionna.Config.xla_compat=true</span></code>.
See <a class="reference internal" href="config.html#sionna.Config.xla_compat" title="sionna.Config.xla_compat"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xla_compat</span></code></a>.</p>
</div>
</dd></dl>

</div>
<div class="section" id="kbestdetector">
<h3>KBestDetector<a class="headerlink" href="#kbestdetector" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.KBestDetector">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">KBestDetector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_streams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_management</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constellation_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bits_per_symbol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constellation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hard_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_real_rep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list2llr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/detection.html#KBestDetector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.KBestDetector" title="Permalink to this definition"></a></dt>
<dd><p>This layer wraps the MIMO K-Best detector for use with the OFDM waveform.</p>
<p>Both detection of symbols or bits with either
soft- or hard-decisions are supported. The OFDM and stream configuration are provided
by a <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a> and
<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a> instance, respectively. The
actual detector is an instance of <a class="reference internal" href="mimo.html#sionna.mimo.KBestDetector" title="sionna.mimo.KBestDetector"><code class="xref py py-class docutils literal notranslate"><span class="pre">KBestDetector</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output</strong> (<em>One of</em><em> [</em><em>&quot;bit&quot;</em><em>, </em><em>&quot;symbol&quot;</em><em>]</em><em>, </em><em>str</em>) – Type of output, either bits or symbols. Whether soft- or
hard-decisions are returned can be configured with the
<code class="docutils literal notranslate"><span class="pre">hard_out</span></code> flag.</p></li>
<li><p><strong>num_streams</strong> (<em>tf.int</em>) – Number of transmitted streams</p></li>
<li><p><strong>k</strong> (<em>tf.int</em>) – Number of paths to keep. Cannot be larger than the
number of constellation points to the power of the number of
streams.</p></li>
<li><p><strong>resource_grid</strong> (<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><em>ResourceGrid</em></a>) – Instance of <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a></p></li>
<li><p><strong>stream_management</strong> (<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><em>StreamManagement</em></a>) – Instance of <a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a></p></li>
<li><p><strong>constellation_type</strong> (<em>One of</em><em> [</em><em>&quot;qam&quot;</em><em>, </em><em>&quot;pam&quot;</em><em>, </em><em>&quot;custom&quot;</em><em>]</em><em>, </em><em>str</em>) – For “custom”, an instance of <a class="reference internal" href="mapping.html#sionna.mapping.Constellation" title="sionna.mapping.Constellation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constellation</span></code></a>
must be provided.</p></li>
<li><p><strong>num_bits_per_symbol</strong> (<em>int</em>) – Number of bits per constellation symbol, e.g., 4 for QAM16.
Only required for <code class="docutils literal notranslate"><span class="pre">constellation_type</span></code> in [“qam”, “pam”].</p></li>
<li><p><strong>constellation</strong> (<a class="reference internal" href="mapping.html#sionna.mapping.Constellation" title="sionna.mapping.Constellation"><em>Constellation</em></a>) – Instance of <a class="reference internal" href="mapping.html#sionna.mapping.Constellation" title="sionna.mapping.Constellation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constellation</span></code></a> or <cite>None</cite>.
In the latter case, <code class="docutils literal notranslate"><span class="pre">constellation_type</span></code>
and <code class="docutils literal notranslate"><span class="pre">num_bits_per_symbol</span></code> must be provided.</p></li>
<li><p><strong>hard_out</strong> (<em>bool</em>) – If <cite>True</cite>, the detector computes hard-decided bit values or
constellation point indices instead of soft-values.
Defaults to <cite>False</cite>.</p></li>
<li><p><strong>use_real_rep</strong> (<em>bool</em>) – If <cite>True</cite>, the detector use the real-valued equivalent representation
of the channel. Note that this only works with a QAM constellation.
Defaults to <cite>False</cite>.</p></li>
<li><p><strong>list2llr</strong> (<cite>None</cite> or instance of <a class="reference internal" href="mimo.html#sionna.mimo.List2LLR" title="sionna.mimo.List2LLR"><code class="xref py py-class docutils literal notranslate"><span class="pre">List2LLR</span></code></a>) – The function to be used to compute LLRs from a list of candidate solutions.
If <cite>None</cite>, the default solution <a class="reference internal" href="mimo.html#sionna.mimo.List2LLRSimple" title="sionna.mimo.List2LLRSimple"><code class="xref py py-class docutils literal notranslate"><span class="pre">List2LLRSimple</span></code></a>
is used.</p></li>
<li><p><strong>dtype</strong> (<em>One of</em><em> [</em><em>tf.complex64</em><em>, </em><em>tf.complex128</em><em>] </em><em>tf.DType</em><em> (</em><em>dtype</em><em>)</em>) – The dtype of <cite>y</cite>. Defaults to tf.complex64.
The output dtype is the corresponding real dtype (tf.float32 or tf.float64).</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(y, h_hat, err_var, no)</strong> – Tuple:</p></li>
<li><p><strong>y</strong> (<em>[batch_size, num_rx, num_rx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – Received OFDM resource grid after cyclic prefix removal and FFT</p></li>
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_ofdm_symbols, num_effective_subcarriers], tf.complex</em>) – Channel estimates for all streams from all transmitters</p></li>
<li><p><strong>err_var</strong> ([Broadcastable to shape of <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>], tf.float) – Variance of the channel estimation error</p></li>
<li><p><strong>no</strong> (<em>[batch_size, num_rx, num_rx_ant] (or only the first n dims), tf.float</em>) – Variance of the AWGN</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>One of</strong></p></li>
<li><p><em>[batch_size, num_tx, num_streams, num_data_symbols*num_bits_per_symbol], tf.float</em> – LLRs or hard-decisions for every bit of every stream, if <code class="docutils literal notranslate"><span class="pre">output</span></code> equals <cite>“bit”</cite>.</p></li>
<li><p><em>[batch_size, num_tx, num_streams, num_data_symbols, num_points], tf.float or [batch_size, num_tx, num_streams, num_data_symbols], tf.int</em> – Logits or hard-decisions for constellation symbols for every stream, if <code class="docutils literal notranslate"><span class="pre">output</span></code> equals <cite>“symbol”</cite>.
Hard-decisions correspond to the symbol indices.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to use this layer in Graph mode with XLA, i.e., within
a function that is decorated with <code class="docutils literal notranslate"><span class="pre">&#64;tf.function(jit_compile=True)</span></code>,
you must set <code class="docutils literal notranslate"><span class="pre">sionna.Config.xla_compat=true</span></code>.
See <a class="reference internal" href="config.html#sionna.Config.xla_compat" title="sionna.Config.xla_compat"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xla_compat</span></code></a>.</p>
</div>
</dd></dl>

</div>
<div class="section" id="lineardetector">
<h3>LinearDetector<a class="headerlink" href="#lineardetector" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.LinearDetector">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">LinearDetector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equalizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">demapping_method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_management</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constellation_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bits_per_symbol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constellation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hard_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/detection.html#LinearDetector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.LinearDetector" title="Permalink to this definition"></a></dt>
<dd><p>This layer wraps a MIMO linear equalizer and a <a class="reference internal" href="mapping.html#sionna.mapping.Demapper" title="sionna.mapping.Demapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Demapper</span></code></a>
for use with the OFDM waveform.</p>
<p>Both detection of symbols or bits with either
soft- or hard-decisions are supported. The OFDM and stream configuration are provided
by a <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a> and
<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a> instance, respectively. The
actual detector is an instance of <a class="reference internal" href="mimo.html#sionna.mimo.LinearDetector" title="sionna.mimo.LinearDetector"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearDetector</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equalizer</strong> (<em>str</em><em>, </em><em>one of</em><em> [</em><em>&quot;lmmse&quot;</em><em>, </em><em>&quot;zf&quot;</em><em>, </em><em>&quot;mf&quot;</em><em>]</em><em>, or </em><em>an equalizer function</em>) – Equalizer to be used. Either one of the existing equalizers, e.g.,
<a class="reference internal" href="mimo.html#sionna.mimo.lmmse_equalizer" title="sionna.mimo.lmmse_equalizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">lmmse_equalizer()</span></code></a>, <a class="reference internal" href="mimo.html#sionna.mimo.zf_equalizer" title="sionna.mimo.zf_equalizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">zf_equalizer()</span></code></a>, or
<a class="reference internal" href="mimo.html#sionna.mimo.mf_equalizer" title="sionna.mimo.mf_equalizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">mf_equalizer()</span></code></a> can be used, or a custom equalizer
function provided that has the same input/output specification.</p></li>
<li><p><strong>output</strong> (<em>One of</em><em> [</em><em>&quot;bit&quot;</em><em>, </em><em>&quot;symbol&quot;</em><em>]</em><em>, </em><em>str</em>) – Type of output, either bits or symbols. Whether soft- or
hard-decisions are returned can be configured with the
<code class="docutils literal notranslate"><span class="pre">hard_out</span></code> flag.</p></li>
<li><p><strong>demapping_method</strong> (<em>One of</em><em> [</em><em>&quot;app&quot;</em><em>, </em><em>&quot;maxlog&quot;</em><em>]</em><em>, </em><em>str</em>) – Demapping method used</p></li>
<li><p><strong>resource_grid</strong> (<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><em>ResourceGrid</em></a>) – Instance of <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a></p></li>
<li><p><strong>stream_management</strong> (<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><em>StreamManagement</em></a>) – Instance of <a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a></p></li>
<li><p><strong>constellation_type</strong> (<em>One of</em><em> [</em><em>&quot;qam&quot;</em><em>, </em><em>&quot;pam&quot;</em><em>, </em><em>&quot;custom&quot;</em><em>]</em><em>, </em><em>str</em>) – For “custom”, an instance of <a class="reference internal" href="mapping.html#sionna.mapping.Constellation" title="sionna.mapping.Constellation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constellation</span></code></a>
must be provided.</p></li>
<li><p><strong>num_bits_per_symbol</strong> (<em>int</em>) – Number of bits per constellation symbol, e.g., 4 for QAM16.
Only required for <code class="docutils literal notranslate"><span class="pre">constellation_type</span></code> in [“qam”, “pam”].</p></li>
<li><p><strong>constellation</strong> (<a class="reference internal" href="mapping.html#sionna.mapping.Constellation" title="sionna.mapping.Constellation"><em>Constellation</em></a>) – Instance of <a class="reference internal" href="mapping.html#sionna.mapping.Constellation" title="sionna.mapping.Constellation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constellation</span></code></a> or <cite>None</cite>.
In the latter case, <code class="docutils literal notranslate"><span class="pre">constellation_type</span></code>
and <code class="docutils literal notranslate"><span class="pre">num_bits_per_symbol</span></code> must be provided.</p></li>
<li><p><strong>hard_out</strong> (<em>bool</em>) – If <cite>True</cite>, the detector computes hard-decided bit values or
constellation point indices instead of soft-values.
Defaults to <cite>False</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>One of</em><em> [</em><em>tf.complex64</em><em>, </em><em>tf.complex128</em><em>] </em><em>tf.DType</em><em> (</em><em>dtype</em><em>)</em>) – The dtype of <cite>y</cite>. Defaults to tf.complex64.
The output dtype is the corresponding real dtype (tf.float32 or tf.float64).</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(y, h_hat, err_var, no)</strong> – Tuple:</p></li>
<li><p><strong>y</strong> (<em>[batch_size, num_rx, num_rx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – Received OFDM resource grid after cyclic prefix removal and FFT</p></li>
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_ofdm_symbols, num_effective_subcarriers], tf.complex</em>) – Channel estimates for all streams from all transmitters</p></li>
<li><p><strong>err_var</strong> ([Broadcastable to shape of <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>], tf.float) – Variance of the channel estimation error</p></li>
<li><p><strong>no</strong> (<em>[batch_size, num_rx, num_rx_ant] (or only the first n dims), tf.float</em>) – Variance of the AWGN</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>One of</strong></p></li>
<li><p><em>[batch_size, num_tx, num_streams, num_data_symbols*num_bits_per_symbol], tf.float</em> – LLRs or hard-decisions for every bit of every stream, if <code class="docutils literal notranslate"><span class="pre">output</span></code> equals <cite>“bit”</cite>.</p></li>
<li><p><em>[batch_size, num_tx, num_streams, num_data_symbols, num_points], tf.float or [batch_size, num_tx, num_streams, num_data_symbols], tf.int</em> – Logits or hard-decisions for constellation symbols for every stream, if <code class="docutils literal notranslate"><span class="pre">output</span></code> equals <cite>“symbol”</cite>.
Hard-decisions correspond to the symbol indices.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to use this layer in Graph mode with XLA, i.e., within
a function that is decorated with <code class="docutils literal notranslate"><span class="pre">&#64;tf.function(jit_compile=True)</span></code>,
you must set <code class="docutils literal notranslate"><span class="pre">sionna.Config.xla_compat=true</span></code>.
See <a class="reference internal" href="config.html#sionna.Config.xla_compat" title="sionna.Config.xla_compat"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xla_compat</span></code></a>.</p>
</div>
</dd></dl>

</div>
<div class="section" id="maximumlikelihooddetector">
<h3>MaximumLikelihoodDetector<a class="headerlink" href="#maximumlikelihooddetector" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.MaximumLikelihoodDetector">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">MaximumLikelihoodDetector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">demapping_method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_management</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constellation_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bits_per_symbol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constellation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hard_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/detection.html#MaximumLikelihoodDetector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.MaximumLikelihoodDetector" title="Permalink to this definition"></a></dt>
<dd><p>Maximum-likelihood (ML) detection for OFDM MIMO transmissions.</p>
<p>This layer implements maximum-likelihood (ML) detection
for OFDM MIMO transmissions. Both ML detection of symbols or bits with either
soft- or hard-decisions are supported. The OFDM and stream configuration are provided
by a <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a> and
<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a> instance, respectively. The
actual detector is an instance of <a class="reference internal" href="mimo.html#sionna.mimo.MaximumLikelihoodDetector" title="sionna.mimo.MaximumLikelihoodDetector"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaximumLikelihoodDetector</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output</strong> (<em>One of</em><em> [</em><em>&quot;bit&quot;</em><em>, </em><em>&quot;symbol&quot;</em><em>]</em><em>, </em><em>str</em>) – Type of output, either bits or symbols. Whether soft- or
hard-decisions are returned can be configured with the
<code class="docutils literal notranslate"><span class="pre">hard_out</span></code> flag.</p></li>
<li><p><strong>demapping_method</strong> (<em>One of</em><em> [</em><em>&quot;app&quot;</em><em>, </em><em>&quot;maxlog&quot;</em><em>]</em><em>, </em><em>str</em>) – Demapping method used</p></li>
<li><p><strong>resource_grid</strong> (<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><em>ResourceGrid</em></a>) – Instance of <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a></p></li>
<li><p><strong>stream_management</strong> (<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><em>StreamManagement</em></a>) – Instance of <a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a></p></li>
<li><p><strong>constellation_type</strong> (<em>One of</em><em> [</em><em>&quot;qam&quot;</em><em>, </em><em>&quot;pam&quot;</em><em>, </em><em>&quot;custom&quot;</em><em>]</em><em>, </em><em>str</em>) – For “custom”, an instance of <a class="reference internal" href="mapping.html#sionna.mapping.Constellation" title="sionna.mapping.Constellation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constellation</span></code></a>
must be provided.</p></li>
<li><p><strong>num_bits_per_symbol</strong> (<em>int</em>) – Number of bits per constellation symbol, e.g., 4 for QAM16.
Only required for <code class="docutils literal notranslate"><span class="pre">constellation_type</span></code> in [“qam”, “pam”].</p></li>
<li><p><strong>constellation</strong> (<a class="reference internal" href="mapping.html#sionna.mapping.Constellation" title="sionna.mapping.Constellation"><em>Constellation</em></a>) – Instance of <a class="reference internal" href="mapping.html#sionna.mapping.Constellation" title="sionna.mapping.Constellation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constellation</span></code></a> or <cite>None</cite>.
In the latter case, <code class="docutils literal notranslate"><span class="pre">constellation_type</span></code>
and <code class="docutils literal notranslate"><span class="pre">num_bits_per_symbol</span></code> must be provided.</p></li>
<li><p><strong>hard_out</strong> (<em>bool</em>) – If <cite>True</cite>, the detector computes hard-decided bit values or
constellation point indices instead of soft-values.
Defaults to <cite>False</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>One of</em><em> [</em><em>tf.complex64</em><em>, </em><em>tf.complex128</em><em>] </em><em>tf.DType</em><em> (</em><em>dtype</em><em>)</em>) – The dtype of <cite>y</cite>. Defaults to tf.complex64.
The output dtype is the corresponding real dtype (tf.float32 or tf.float64).</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(y, h_hat, err_var, no)</strong> – Tuple:</p></li>
<li><p><strong>y</strong> (<em>[batch_size, num_rx, num_rx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – Received OFDM resource grid after cyclic prefix removal and FFT</p></li>
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_ofdm_symbols, num_effective_subcarriers], tf.complex</em>) – Channel estimates for all streams from all transmitters</p></li>
<li><p><strong>err_var</strong> ([Broadcastable to shape of <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>], tf.float) – Variance of the channel estimation error</p></li>
<li><p><strong>no</strong> (<em>[batch_size, num_rx, num_rx_ant] (or only the first n dims), tf.float</em>) – Variance of the AWGN noise</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>One of</strong></p></li>
<li><p><em>[batch_size, num_tx, num_streams, num_data_symbols*num_bits_per_symbol], tf.float</em> – LLRs or hard-decisions for every bit of every stream, if <code class="docutils literal notranslate"><span class="pre">output</span></code> equals <cite>“bit”</cite>.</p></li>
<li><p><em>[batch_size, num_tx, num_streams, num_data_symbols, num_points], tf.float or [batch_size, num_tx, num_streams, num_data_symbols], tf.int</em> – Logits or hard-decisions for constellation symbols for every stream, if <code class="docutils literal notranslate"><span class="pre">output</span></code> equals <cite>“symbol”</cite>.
Hard-decisions correspond to the symbol indices.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to use this layer in Graph mode with XLA, i.e., within
a function that is decorated with <code class="docutils literal notranslate"><span class="pre">&#64;tf.function(jit_compile=True)</span></code>,
you must set <code class="docutils literal notranslate"><span class="pre">sionna.Config.xla_compat=true</span></code>.
See <a class="reference internal" href="config.html#sionna.Config.xla_compat" title="sionna.Config.xla_compat"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xla_compat</span></code></a>.</p>
</div>
</dd></dl>

</div>
<div class="section" id="maximumlikelihooddetectorwithprior">
<h3>MaximumLikelihoodDetectorWithPrior<a class="headerlink" href="#maximumlikelihooddetectorwithprior" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.MaximumLikelihoodDetectorWithPrior">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">MaximumLikelihoodDetectorWithPrior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">demapping_method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_management</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constellation_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bits_per_symbol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constellation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hard_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/detection.html#MaximumLikelihoodDetectorWithPrior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.MaximumLikelihoodDetectorWithPrior" title="Permalink to this definition"></a></dt>
<dd><p>Maximum-likelihood (ML) detection for OFDM MIMO transmissions, assuming prior
knowledge of the bits or constellation points is available.</p>
<p>This layer implements maximum-likelihood (ML) detection
for OFDM MIMO transmissions assuming prior knowledge on the transmitted data is available.
Both ML detection of symbols or bits with either
soft- or hard-decisions are supported. The OFDM and stream configuration are provided
by a <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a> and
<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a> instance, respectively. The
actual detector is an instance of <a class="reference internal" href="mimo.html#sionna.mimo.MaximumLikelihoodDetectorWithPrior" title="sionna.mimo.MaximumLikelihoodDetectorWithPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaximumLikelihoodDetectorWithPrior</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output</strong> (<em>One of</em><em> [</em><em>&quot;bit&quot;</em><em>, </em><em>&quot;symbol&quot;</em><em>]</em><em>, </em><em>str</em>) – Type of output, either bits or symbols. Whether soft- or
hard-decisions are returned can be configured with the
<code class="docutils literal notranslate"><span class="pre">hard_out</span></code> flag.</p></li>
<li><p><strong>demapping_method</strong> (<em>One of</em><em> [</em><em>&quot;app&quot;</em><em>, </em><em>&quot;maxlog&quot;</em><em>]</em><em>, </em><em>str</em>) – Demapping method used</p></li>
<li><p><strong>resource_grid</strong> (<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><em>ResourceGrid</em></a>) – Instance of <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a></p></li>
<li><p><strong>stream_management</strong> (<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><em>StreamManagement</em></a>) – Instance of <a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a></p></li>
<li><p><strong>constellation_type</strong> (<em>One of</em><em> [</em><em>&quot;qam&quot;</em><em>, </em><em>&quot;pam&quot;</em><em>, </em><em>&quot;custom&quot;</em><em>]</em><em>, </em><em>str</em>) – For “custom”, an instance of <a class="reference internal" href="mapping.html#sionna.mapping.Constellation" title="sionna.mapping.Constellation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constellation</span></code></a>
must be provided.</p></li>
<li><p><strong>num_bits_per_symbol</strong> (<em>int</em>) – Number of bits per constellation symbol, e.g., 4 for QAM16.
Only required for <code class="docutils literal notranslate"><span class="pre">constellation_type</span></code> in [“qam”, “pam”].</p></li>
<li><p><strong>constellation</strong> (<a class="reference internal" href="mapping.html#sionna.mapping.Constellation" title="sionna.mapping.Constellation"><em>Constellation</em></a>) – Instance of <a class="reference internal" href="mapping.html#sionna.mapping.Constellation" title="sionna.mapping.Constellation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constellation</span></code></a> or <cite>None</cite>.
In the latter case, <code class="docutils literal notranslate"><span class="pre">constellation_type</span></code>
and <code class="docutils literal notranslate"><span class="pre">num_bits_per_symbol</span></code> must be provided.</p></li>
<li><p><strong>hard_out</strong> (<em>bool</em>) – If <cite>True</cite>, the detector computes hard-decided bit values or
constellation point indices instead of soft-values.
Defaults to <cite>False</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>One of</em><em> [</em><em>tf.complex64</em><em>, </em><em>tf.complex128</em><em>] </em><em>tf.DType</em><em> (</em><em>dtype</em><em>)</em>) – The dtype of <cite>y</cite>. Defaults to tf.complex64.
The output dtype is the corresponding real dtype (tf.float32 or tf.float64).</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(y, h_hat, prior, err_var, no)</strong> – Tuple:</p></li>
<li><p><strong>y</strong> (<em>[batch_size, num_rx, num_rx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – Received OFDM resource grid after cyclic prefix removal and FFT</p></li>
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_ofdm_symbols, num_effective_subcarriers], tf.complex</em>) – Channel estimates for all streams from all transmitters</p></li>
<li><p><strong>prior</strong> (<em>[batch_size, num_tx, num_streams, num_data_symbols x num_bits_per_symbol] or [batch_size, num_tx, num_streams, num_data_symbols, num_points], tf.float</em>) – Prior of the transmitted signals.
If <code class="docutils literal notranslate"><span class="pre">output</span></code> equals “bit”, LLRs of the transmitted bits are expected.
If <code class="docutils literal notranslate"><span class="pre">output</span></code> equals “symbol”, logits of the transmitted constellation points are expected.</p></li>
<li><p><strong>err_var</strong> ([Broadcastable to shape of <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>], tf.float) – Variance of the channel estimation error</p></li>
<li><p><strong>no</strong> (<em>[batch_size, num_rx, num_rx_ant] (or only the first n dims), tf.float</em>) – Variance of the AWGN noise</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>One of</strong></p></li>
<li><p><em>[batch_size, num_tx, num_streams, num_data_symbols*num_bits_per_symbol], tf.float</em> – LLRs or hard-decisions for every bit of every stream, if <code class="docutils literal notranslate"><span class="pre">output</span></code> equals <cite>“bit”</cite>.</p></li>
<li><p><em>[batch_size, num_tx, num_streams, num_data_symbols, num_points], tf.float or [batch_size, num_tx, num_streams, num_data_symbols], tf.int</em> – Logits or hard-decisions for constellation symbols for every stream, if <code class="docutils literal notranslate"><span class="pre">output</span></code> equals <cite>“symbol”</cite>.
Hard-decisions correspond to the symbol indices.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to use this layer in Graph mode with XLA, i.e., within
a function that is decorated with <code class="docutils literal notranslate"><span class="pre">&#64;tf.function(jit_compile=True)</span></code>,
you must set <code class="docutils literal notranslate"><span class="pre">sionna.Config.xla_compat=true</span></code>.
See <a class="reference internal" href="config.html#sionna.Config.xla_compat" title="sionna.Config.xla_compat"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xla_compat</span></code></a>.</p>
</div>
</dd></dl>

</div>
<div class="section" id="mmsepicdetector">
<h3>MMSEPICDetector<a class="headerlink" href="#mmsepicdetector" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="sionna.ofdm.MMSEPICDetector">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sionna.ofdm.</span></span><span class="sig-name descname"><span class="pre">MMSEPICDetector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resource_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_management</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">demapping_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'maxlog'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constellation_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bits_per_symbol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constellation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hard_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.complex64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sionna/ofdm/detection.html#MMSEPICDetector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sionna.ofdm.MMSEPICDetector" title="Permalink to this definition"></a></dt>
<dd><p>This layer wraps the MIMO MMSE PIC detector for use with the OFDM waveform.</p>
<p>Both detection of symbols or bits with either
soft- or hard-decisions are supported. The OFDM and stream configuration are provided
by a <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a> and
<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a> instance, respectively. The
actual detector is an instance of <a class="reference internal" href="mimo.html#sionna.mimo.MMSEPICDetector" title="sionna.mimo.MMSEPICDetector"><code class="xref py py-class docutils literal notranslate"><span class="pre">MMSEPICDetector</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output</strong> (<em>One of</em><em> [</em><em>&quot;bit&quot;</em><em>, </em><em>&quot;symbol&quot;</em><em>]</em><em>, </em><em>str</em>) – Type of output, either bits or symbols. Whether soft- or
hard-decisions are returned can be configured with the
<code class="docutils literal notranslate"><span class="pre">hard_out</span></code> flag.</p></li>
<li><p><strong>resource_grid</strong> (<a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><em>ResourceGrid</em></a>) – Instance of <a class="reference internal" href="#sionna.ofdm.ResourceGrid" title="sionna.ofdm.ResourceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceGrid</span></code></a></p></li>
<li><p><strong>stream_management</strong> (<a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><em>StreamManagement</em></a>) – Instance of <a class="reference internal" href="mimo.html#sionna.mimo.StreamManagement" title="sionna.mimo.StreamManagement"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamManagement</span></code></a></p></li>
<li><p><strong>demapping_method</strong> (<em>One of</em><em> [</em><em>&quot;app&quot;</em><em>, </em><em>&quot;maxlog&quot;</em><em>]</em><em>, </em><em>str</em>) – The demapping method used.
Defaults to “maxlog”.</p></li>
<li><p><strong>num_iter</strong> (<em>int</em>) – Number of MMSE PIC iterations.
Defaults to 1.</p></li>
<li><p><strong>constellation_type</strong> (<em>One of</em><em> [</em><em>&quot;qam&quot;</em><em>, </em><em>&quot;pam&quot;</em><em>, </em><em>&quot;custom&quot;</em><em>]</em><em>, </em><em>str</em>) – For “custom”, an instance of <a class="reference internal" href="mapping.html#sionna.mapping.Constellation" title="sionna.mapping.Constellation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constellation</span></code></a>
must be provided.</p></li>
<li><p><strong>num_bits_per_symbol</strong> (<em>int</em>) – The number of bits per constellation symbol, e.g., 4 for QAM16.
Only required for <code class="docutils literal notranslate"><span class="pre">constellation_type</span></code> in [“qam”, “pam”].</p></li>
<li><p><strong>constellation</strong> (<a class="reference internal" href="mapping.html#sionna.mapping.Constellation" title="sionna.mapping.Constellation"><em>Constellation</em></a>) – An instance of <a class="reference internal" href="mapping.html#sionna.mapping.Constellation" title="sionna.mapping.Constellation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constellation</span></code></a> or <cite>None</cite>.
In the latter case, <code class="docutils literal notranslate"><span class="pre">constellation_type</span></code>
and <code class="docutils literal notranslate"><span class="pre">num_bits_per_symbol</span></code> must be provided.</p></li>
<li><p><strong>hard_out</strong> (<em>bool</em>) – If <cite>True</cite>, the detector computes hard-decided bit values or
constellation point indices instead of soft-values.
Defaults to <cite>False</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>One of</em><em> [</em><em>tf.complex64</em><em>, </em><em>tf.complex128</em><em>] </em><em>tf.DType</em><em> (</em><em>dtype</em><em>)</em>) – Precision used for internal computations. Defaults to <code class="docutils literal notranslate"><span class="pre">tf.complex64</span></code>.
Especially for large MIMO setups, the precision can make a significant
performance difference.</p></li>
</ul>
</dd>
<dt class="field-even">Input</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>(y, h_hat, prior, err_var, no)</strong> – Tuple:</p></li>
<li><p><strong>y</strong> (<em>[batch_size, num_rx, num_rx_ant, num_ofdm_symbols, fft_size], tf.complex</em>) – Received OFDM resource grid after cyclic prefix removal and FFT</p></li>
<li><p><strong>h_hat</strong> (<em>[batch_size, num_rx, num_rx_ant, num_tx, num_streams_per_tx, num_ofdm_symbols, num_effective_subcarriers], tf.complex</em>) – Channel estimates for all streams from all transmitters</p></li>
<li><p><strong>prior</strong> (<em>[batch_size, num_tx, num_streams, num_data_symbols x num_bits_per_symbol] or [batch_size, num_tx, num_streams, num_data_symbols, num_points], tf.float</em>) – Prior of the transmitted signals.
If <code class="docutils literal notranslate"><span class="pre">output</span></code> equals “bit”, LLRs of the transmitted bits are expected.
If <code class="docutils literal notranslate"><span class="pre">output</span></code> equals “symbol”, logits of the transmitted constellation points are expected.</p></li>
<li><p><strong>err_var</strong> ([Broadcastable to shape of <code class="docutils literal notranslate"><span class="pre">h_hat</span></code>], tf.float) – Variance of the channel estimation error</p></li>
<li><p><strong>no</strong> (<em>[batch_size, num_rx, num_rx_ant] (or only the first n dims), tf.float</em>) – Variance of the AWGN</p></li>
</ul>
</dd>
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>One of</strong></p></li>
<li><p><em>[batch_size, num_tx, num_streams, num_data_symbols*num_bits_per_symbol], tf.float</em> – LLRs or hard-decisions for every bit of every stream, if <code class="docutils literal notranslate"><span class="pre">output</span></code> equals <cite>“bit”</cite>.</p></li>
<li><p><em>[batch_size, num_tx, num_streams, num_data_symbols, num_points], tf.float or [batch_size, num_tx, num_streams, num_data_symbols], tf.int</em> – Logits or hard-decisions for constellation symbols for every stream, if <code class="docutils literal notranslate"><span class="pre">output</span></code> equals <cite>“symbol”</cite>.
Hard-decisions correspond to the symbol indices.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For numerical stability, we do not recommend to use this function in Graph
mode with XLA, i.e., within a function that is decorated with
<code class="docutils literal notranslate"><span class="pre">&#64;tf.function(jit_compile=True)</span></code>.
However, it is possible to do so by setting
<code class="docutils literal notranslate"><span class="pre">sionna.Config.xla_compat=true</span></code>.
See <a class="reference internal" href="config.html#sionna.Config.xla_compat" title="sionna.Config.xla_compat"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xla_compat</span></code></a>.</p>
</div>
</dd></dl>

</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="channel.discrete.html" class="btn btn-neutral float-left" title="Discrete" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mimo.html" class="btn btn-neutral float-right" title="Multiple-Input Multiple-Output (MIMO)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2023 NVIDIA CORPORATION.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>